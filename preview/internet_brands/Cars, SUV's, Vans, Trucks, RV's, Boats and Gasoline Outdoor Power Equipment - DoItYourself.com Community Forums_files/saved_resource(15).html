
<!-- saved from url=(0102)http://www.doityourself.com/forum/cars-suvs-vans-trucks-rvs-boats-gasoline-outdoor-power-equipment-91/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>var inDapIF=true;</script><script src="./en"></script><script src="./en(1)"></script><script src="./en(2)"></script><style id="tyntShCSS" type="text/css">#tyntSh div,#tyntSh span,#tyntSh img,#tyntSh a,div#tyntSh{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline;line-height:1;background:0;text-align:left}#tyntSh img,#tyntSh span{display:inline}#tyntSh div,div#tyntSh{display:block}div#tyntSh{z-index:9999999;position:absolute;height:62px;margin:10px;overflow:visible;background:#FFF;border-radius:5px;text-align:center;box-shadow: 0 2px 6px rgba(0,0,0,0.5)}div#tyntShTr{margin:-11px auto 0 auto;width:0;height:0;border-left:10px solid transparent;border-right:10px solid transparent;border-bottom:11px solid #F1F1F1}img#tyntShTw,img#tyntShP,img#tyntShFb,img#tyntShLi,img#tyntShGp{cursor:pointer;height:28px;width:28px;margin:3px 3px 2px 3px;vertical-align:bottom}div#tyntShPTL,div#tyntShHFL{color:#888;text-decoration:none;margin:0 0 2px 0;background-color:#F1F1F1;padding:2px 4px;border-radius:5px 5px 0 0}div#tyntShHFL{text-align:right;border-radius:0 0 5px 5px;margin:2px 0 0 0}div#tyntShHFL,span#tyntShHFLs,div#tyntShPTL{font:normal 8px Arial}span#tyntShHFLs{cursor:pointer;}span#tyntShHFLs:hover{color:#555;text-decoration:underline}div#tyntShCB{position:absolute;cursor:pointer;width:14px;height:14px;top:0;right:0;background-position:0 -14px;background-repeat:no-repeat}div#tyntShCB:hover{background-position: 0 0}div.tyntShIh,.tyntShIh div,.tyntShIh span{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline;line-height:1;background:0;text-align:left}.tyntShIh img,.tyntShIh span{display:inline}.tyntShIh div,div.tyntShIh{display:block;outline:0}div.tyntShIh{position:absolute;cursor:default;background:transparent url(http://cdn.tynt.com/images/ss/pi.png) no-repeat;width:43px;height:21px;opacity:0;filter:alpha(opacity=0);z-index:9999999;-webkit-transition:opacity 0.5s;-moz-transition:opacity 0.5s}div.tyntIhHover{opacity:1;filter:alpha(opacity=100);cursor:pointer}</style></head><body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0"><script>(function(){var g=this,l=function(a,b){var c=a.split("."),d=g;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b},m=function(a,b,c){return a.call.apply(a.bind,arguments)},n=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}},p=function(a,b,c){p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?m:n;return p.apply(null,arguments)},q=Date.now||function(){return+new Date};var r=document,s=window;var t=function(a,b){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.call(null,a[c],c,a)},w=function(a,b){a.google_image_requests||(a.google_image_requests=[]);var c=a.document.createElement("img");c.src=b;a.google_image_requests.push(c)};var x=function(a){return{visible:1,hidden:2,prerender:3,preview:4}[a.webkitVisibilityState||a.mozVisibilityState||a.visibilityState||""]||0},y=function(a){var b;a.mozVisibilityState?b="mozvisibilitychange":a.webkitVisibilityState?b="webkitvisibilitychange":a.visibilityState&&(b="visibilitychange");return b};var C=function(){this.g=r;this.k=s;this.j=!1;this.i=null;this.h=[];this.o={};if(z)this.i=q();else if(3==x(this.g)){this.i=q();var a=p(this.q,this);A&&(a=A("di::vch",a));this.p=a;var b=this.g,c=y(this.g);b.addEventListener?b.addEventListener(c,a,!1):b.attachEvent&&b.attachEvent("on"+c,a)}else B(this)},A;C.m=function(){return C.n?C.n:C.n=new C};var D=/^([^:]+:\/\/[^/]+)/m,G=/^\d*,(.+)$/m,z=!1,B=function(a){if(!a.j){a.j=!0;for(var b=0;b<a.h.length;++b)a.l.apply(a,a.h[b]);a.h=[]}};C.prototype.s=function(a,b){var c=b.target.u();(c=G.exec(c))&&(this.o[a]=c[1])};C.prototype.l=function(a,b){this.k.rvdt=this.i?q()-this.i:0;var c;if(c=this.t)t:{try{var d=D.exec(this.k.location.href),e=D.exec(a);if(d&&e&&d[1]==e[1]&&b){var f=p(this.s,this,b);this.t(a,f);c=!0;break t}}catch(u){}c=!1}c||w(this.k,a)};C.prototype.q=function(){if(3!=x(this.g)){B(this);var a=this.g,b=y(this.g),c=this.p;a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c)}};var H=/^true$/.test("")?!0:!1;var I={},J=function(a){var b=a.toString();a.name&&-1==b.indexOf(a.name)&&(b+=": "+a.name);a.message&&-1==b.indexOf(a.message)&&(b+=": "+a.message);if(a.stack){a=a.stack;var c=b;try{-1==a.indexOf(c)&&(a=c+"\n"+a);for(var d;a!=d;)d=a,a=a.replace(/((https?:\/..*\/)[^\/:]*:\d+(?:.|\n)*)\2/,"$1");b=a.replace(/\n */g,"\n")}catch(e){b=c}}return b},M=function(a,b,c,d){var e=K,f,u=!0;try{f=b()}catch(h){try{var N=J(h);b="";h.fileName&&(b=h.fileName);var E=-1;h.lineNumber&&(E=h.lineNumber);var v;t:{try{v=c?c():"";break t}catch(S){}v=""}u=e(a,N,b,E,v)}catch(k){try{var O=J(k);a="";k.fileName&&(a=k.fileName);c=-1;k.lineNumber&&(c=k.lineNumber);K("pAR",O,a,c,void 0,void 0)}catch(F){L({context:"mRE",msg:F.toString()+"\n"+(F.stack||"")},void 0)}}if(!u)throw h;}finally{if(d)try{d()}catch(T){}}return f},K=function(a,b,c,d,e,f){a={context:a,msg:b.substring(0,512),eid:e&&e.substring(0,40),file:c,line:d.toString(),url:r.URL.substring(0,512),ref:r.referrer.substring(0,512)};P(a);L(a,f);return!0},L=function(a,b){try{if(Math.random()<(b||.01)){var c="/pagead/gen_204?id=jserror"+Q(a),d="http"+("https:"==s.location.protocol?"s":"")+"://pagead2.googlesyndication.com"+c,d=d.substring(0,2E3);w(s,d)}}catch(e){}},P=function(a){var b=a||{};t(I,function(a,d){b[d]=s[a]})},R=function(a,b,c,d,e){return function(){var f=arguments;return M(a,function(){return b.apply(c,f)},d,e)}},Q=function(a){var b="";t(a,function(a,d){if(0===a||a)b+="&"+d+"="+("function"==typeof encodeURIComponent?encodeURIComponent(a):escape(a))});return b};A=function(a,b,c,d){return R(a,b,void 0,c,d)};z=H;l("vu",R("vu",function(a,b){var c=a.replace("&amp;","&"),d=/(google|doubleclick).*\/pagead\/adview/.test(c),e=C.m();if(d){d="&vis="+x(e.g);b&&(d+="&ve=1");var f=c.indexOf("&adurl"),c=-1==f?c+d:c.substring(0,f)+d+c.substring(f)}e.j?e.l(c,b):e.h.push([c,b])}));l("vv",R("vv",function(){z&&B(C.m())}));})();</script><script>vu("https://securepubads.g.doubleclick.net/pcs/view?xai\x3dAKAOjstbcl41_APFy7gatIfnzqjb4RGrwKe6bvfLBRPGOlC6uYsI-jpZGUMMdcXFiCtHe4jLEB6hlLWlPDV0GqBb8zX2LbXXEPgH3-tXtKS2zX9dMbp1W02UxG_vTOAk8J91XH-EN2Txyx3EHPUU5lssXOGoIqczxhOXu4drQR1ei5MpdP-qWF9QWPzfy9p5O72XkOp_iao0ocuKQls_cD2-n2MAlsPgJYBbIRub8fwFKC22vXFljh8KQrf1z2imlHjoYUm5Z-_m6S8\x26sig\x3dCg0ArKJSzCrDv5BoiAeWEAE\x26urlfix\x3d1\x26adurl\x3d")</script>




<title>JWPlayer</title>
<style>
@font-face{
  font-family: "autoplay-font";
  src: url('//synacor.autoplay-plugins.static-origin.syn-cdn.com/fonts/autoplay-font.eot');
  src: url('//synacor.autoplay-plugins.static-origin.syn-cdn.com/fonts/autoplay-font.woff') format('woff'),
       url('//synacor.autoplay-plugins.static-origin.syn-cdn.com/fonts/autoplay-font.ttf') format('truetype'),
       url('//synacor.autoplay-plugins.static-origin.syn-cdn.com/fonts/autoplay-font.svg#autoplay-font') format('svg'),
       url('//synacor.autoplay-plugins.static-origin.syn-cdn.com/fonts/autoplay-font.eot?#iefix') format('embedded-opentype');
  font-weight: normal;
  font-style: normal
}
html, body {
  font-family: HelveticaNeue, Arial, sans-serif;
  margin: 0;
  padding: 0;
  border: 0;
  overflow: hidden;
  background: white;
}
h1, h3 {
  font-weight: normal;
}
.icon {
  font-family: "autoplay-font", sans-serif;
  font-size: 17px;
  color: #999;
  width: 20px;
  height: 20px;
  display: inline-block;
  text-align: center;
  margin: 0 2px;
  cursor: pointer;
  vertical-align: middle;
}
.expanded .icon {
  margin-bottom: 5px;
}
.icon:active, .icon:hover, .icon:focus {
  border-radius: 2px;
  color: #009ede;
}
.iconPlay:after {
  content: "\25b6";
}
.iconPause:after {
  content: "\258C\258C";
  letter-spacing: -0.6em;
}
.iconPause {
  text-align: left;
  text-indent: -0.07em;
}
.iconMute:after {
  content: "\1F507";
}
.iconUnmute:after {
  content: "\1F50A";
}
.iconPrevious:after {
  content: "\27E8";
}
.iconNext:after {
  content: "\27E9";
}
.iconAssetIcon:after {
  content: "\27A2";
}
.iconClose:after {
  content: "\2A09";
}
.iconHD {
  font-size: 14px;
  width: 34px;
  margin-top: -6px;
  height: 16px;
  padding-top: 2px;
}
.iconHD.active {
  color: white;
  background-color: #aaa;
  border-radius: 2px;
}
.iconHD:active, .iconHD:hover, .iconHD:focus  {
  color: white;
  background-color: #009ede;
  border-radius: 2px;
}
.iconHD:after {
  content: "HD";
}
.counter {
  color: #999;
  font-size: 11px;
  display: none;
  vertical-align: super;
}
#nowPlayingBackground {
  background: white;
  opacity: 0.8;
  width: 100%;
  height: 32px;
  position: absolute;
  z-index: 2;
}
#nowPlayingContainer {
  position: absolute;
  color: black;
  font-size: 11px;
  text-align: left;
  visibility: hidden;
  overflow: hidden;
}
#nowPlayingContainer h1 {
  font-weight: bold;
  font-size: 11px;
  margin: 0;
  padding: 0 7px 0 0;
  display: inline;
  color: #009fdb;
  white-space: nowrap;
  font-style: normal;
  font-stretch: normal;
  line-height: 1.64em;
  letter-spacing: normal;
  vertical-align: middle;
}
#nowPlayingContainer.expanded .counter {
  display: inline;
}
#nowPlayingContainer.expanded #nowPlayingDiv span.title {
  font-size: 11px;
  display: block;
  clear: both;
}
#nowPlayingContainer #upNextDiv h1,
#nowPlayingContainer #upNextDiv span.title {
  line-height: 1.45em;
}

#upNextDiv {
  position: relative;
  z-index: 2;
  padding: 6px 11px 1px 11px;
  border-top: 1px solid #ddd;
  visibility: hidden;
}

#nowPlayingContainer span.title {
  line-height: 1.64em;
  padding-left: 4px;
  font-size: 11px;
  display: block;
  text-align: left;
  margin: 0;
  padding: 0;
  text-overflow: ellipsis;
  color: #555555;
  vertical-align: middle;
  white-space: nowrap;
  overflow: hidden;
}
#nowPlayingContainer #upNextDiv {
  display: none;
}
#nowPlayingContainer.expanded #upNextDiv {
  display: block;
}

#nowPlayingContainer h1 {
  float: left;
}

#nowPlayingControls {
  float: right;
  height: 14px;
  margin: 0 -6px 0 0;
  white-space: nowrap;
}
#nowPlayingDiv {
  padding: 6px 11px 6px 11px;
  overflow: hidden;
  position: relative;
  z-index: 2;
  line-height: 11px;
}
#comingUpPlaylist {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: white;
  color: black;
  padding: 0;
  text-align: center;
  z-index: 2;
  overflow: hidden;
  opacity: 0.98;
}
#comingUpPlaylist h1 {
  font-weigth: bold;
  font-size: .9em;
  color: #009fdb;
}
#comingUpPlaylist h3 {
  font-size: .8em;
  text-align: left;
  padding: .6em;
  margin: 2px;
  color: gray;
  border: 2px solid white;
}
#comingUpPlaylist h3.active {
  -moz-border-radius: 8px;
  border-radius: 8px;
  color: white;
  border: 2px solid white;
  background-color: #009fdb;
}
#comingUpPlaylist h3 span {
  display: table-cell;
  vertical-align: middle;
  padding: 0 10px;
}
.comingupThumbnail, .comingupThumbnailContainer {
  display: block;
  height: 3em;
  width: 5.34em;
}
.comingupThumbnailPlayIcon {
  font-family: "autoplay-font";
  text-align: center;
  position: absolute;
  top: 0;
  font-size: 2em;
  color: white;
  font-weight: normal;
  opacity: .7;
  width: 100%;
  height: 100%;
  line-height: 1.5em;
}
.comingupThumbnailContainer {
  position: relative;
  margin: 0 10px;
  display: table-cell;
  vertical-align: middle;
}
.comingupThumbnailCenter {
  position: relative;
}
.comingupThumbnailContainer img {
  background-color: #333;
  border: 1px solid #eee;
}
.active .comingupThumbnailContainer img {
  border: 1px solid #009fdb;
}
#assetPreview {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  color: white;
  padding: 0;
  text-align: left;
  z-index: 2;
  overflow: hidden;
  opacity: 0.98;
  background-size: cover;
  background-position: center;
}
#assetPreview .dimmer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.65);
  opacity: 0.98;
  z-index: 3;
}
#assetPreview .assetPreviewText {
  position: absolute;
  transform: translate(0, -50%);
  top: 50%;
}
#assetPreview h1 {
  font-size: 3.5vw;
  letter-spacing: 0.5px;
  padding: 0 21px;
}
#assetPreview h2 {
  font-size: 5.2vw;
  padding: 0 21px;
  font-weight: bold;
}
#assetPreview h3 {
  font-size: 3.8vw;
  margin-top: -0.5em;
  padding: 0 21px;
  font-weight: bold;
}
.watchNowIcon {
  font-family: "autoplay-font";
  font-size: 1.5em;
  padding-right: 10px;
  vertical-align: bottom;
}
#comingupGradient {
  height: 40px;
  bottom: 0;
  width: 100%;
  position: absolute;
  background: -webkit-linear-gradient(270deg, rgba(255,255,255,0), rgba(255,255,255,1)); /* For Safari 5.1 to 6.0 */
  background: -o-linear-gradient(270deg, rgba(255,255,255,0), rgba(255,255,255,1)); /* For Opera 11.1 to 12.0 */
  background: -moz-linear-gradient(270deg, rgba(255,255,255,0), rgba(255,255,255,1)); /* For Firefox 3.6 to 15 */
  background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,1)); /* Standard syntax */
}
#loadingCover {
  background-color: #EFEFEF;
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  z-index: 2;
  color: #aaa;
}
#staticAdModal {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 999;
  background-color: #EFEFEF;
  visibility: hidden;
  color: #aaa;
}
#loadingCover h1, #staticAdModal h1 {
  text-transform: uppercase;
  text-align: center;
  font-size: 1em;
  position: relative;
  top: 50%;
  margin: 0;
}
#playerContainer {
  position: relative;
  overflow: hidden;
}
.playerFrame {
  border: none;
  margin: 0;
  padding: 0;
  overflow: hidden;
  position: absolute;
  top: 0;
  left: 0;
}
</style>




<div id="playerContainer" style="margin-top: 0px; margin-left: 0.5px; height: 250px; width: 300px;">
<iframe class="playerFrame" width="300" height="250" style="width: 300px; height: 250px; z-index: 0; visibility: hidden;" src="./saved_resource(18).html"></iframe><iframe class="playerFrame" width="300" height="169" style="width: 300px; height: 169px; z-index: 0; border-bottom: 10000px solid white;" src="./saved_resource(19).html"></iframe><iframe class="playerFrame" width="300" height="250" style="width: 300px; height: 250px; z-index: 1;" src="./saved_resource(20).html"></iframe><div id="nowPlayingContainer" class="" style="width: 300px; visibility: visible; height: 29px; top: 221px;"><div id="nowPlayingBackground" style="height: 29px;"></div><div id="nowPlayingDiv"><div id="nowPlayingControls"><a id="unmuteVideo" class="icon iconMute"></a></div><h1>NEXT</h1><span class="title">Don't Miss! - 03/07 Preview</span></div><div id="upNextDiv"><h1>NEXT</h1><span class="title">Don't Miss! - 03/07</span></div></div><iframe class="playerFrame" width="300" height="250" style="width: 300px; height: 250px; z-index: 0;" src="./saved_resource(21).html"></iframe></div>

<!--
  code html build timestamp: 2017-03-02 12:11:34 EST
  code blob: $Id: 934088398b02324eb95a6cc2a283598cfb989a60 $

  html build timestamp: 2017-03-02 12:11:34 EST
  newest content timestamp: 2017-03-02 10:30:00 EST

  eaid: 189453932
  ecid: 56494666172
  blob: $Id: 934088398b02324eb95a6cc2a283598cfb989a60 $

  adtags: b=0;id=google_adex_syndication;t=15, b=15;id=google_adex_syndication_backfill;t=15
  large adtags: 
  prefix: a, db, a, d
  tail: a, b
  loop mode: forever
  audio mode: malamute
  log throttle: 0.005
  log url: garnet-static
  jwplayer version: 6.12
  stream source: edgecast
  timed ad break: 15s
  order mode: fs
  seen at end: off
  dynamic content: on
  bitrate on resize: on
  ad play max time: r+60s
  ad-free on click: on
  anti-refresh: off
  show now playing: on
  show nav buttons: on
  autoplay mode: always
  adload splash: 
  background ads: on
  background run restricted tags: off
  background only viewable: off
  inactive scroll seconds: off
  static ad source: contango__syndicationdfptemplate
  static ad size match: off
  static ad visible min: 5
  static ad rotation min: 30
  static ad in DCC: off
  ad scheduling: simultaneous
  replace dcc: off
  fill window: on
  log aceview: off
  content restrictions: 
-->

<script type="text/javascript">
// config
var cfg = {
   "ad_scheduling": "simultaneous",
   "ad_tags": [
      {
         "b": 0,
         "client": "googima",
         "id": "google_adex_syndication",
         "t": 15,
         "url": {
            "default": "//pubads.g.doubleclick.net/gampad/ads?sz=640x383&iu=/5284/syn.synacorsyndication/video_adex&ciu_szs=300x250&impl=s&gdfp_req=1&env=vp&output=xml_vast3&unviewed_position_start=1&url=__domain__&description_url=__page-url__&correlator=__timestamp__&cust_params=dfpcid%3D__dfpcid__%26dfpadunit%3D__dfpadunit__"
         }
      },
      {
         "b": 15,
         "client": "googima",
         "id": "google_adex_syndication_backfill",
         "t": 15,
         "url": {
            "default": "//pubads.g.doubleclick.net/gampad/ads?sz=640x383&iu=/5284/syn.synacorsyndication/video_adex_backfill&ciu_szs=300x250&impl=s&gdfp_req=1&env=vp&output=xml_vast3&unviewed_position_start=1&url=__domain__&description_url=__page-url__&correlator=__timestamp__&cust_params=dfpcid%3D__dfpcid__%26dfpadunit%3D__dfpadunit__"
         }
      }
   ],
   "ad_text": false,
   "adfree_interaction": true,
   "adload_splash": null,
   "adplaytimer_maxsecs": "r+60",
   "anti_refresh": false,
   "audio_mode": "malamute",
   "autoplay_mode": "always",
   "autoplay_mode_chaff": "0",
   "autoplay_mode_delay": "60",
   "background_ads": true,
   "background_only_viewable": false,
   "background_run_restricts": false,
   "dcc_again_after_close": false,
   "dcc_bitrate": "maintain",
   "dcc_immediate_inc": false,
   "dcc_rotations_gen2": "1",
   "dcc_rotations_gen4": "3",
   "dynamiccontent": true,
   "fill_window": true,
   "inactive_scroll_inview": "65",
   "inactive_scroll_return": false,
   "inactive_scroll_secs": 0,
   "jwpversion": "6.12",
   "large_ad_tags": [],
   "log_aceview": false,
   "logthrottle": 0.005,
   "logurl": "//static.garnet.synacor.com/small/blank.gif",
   "loop_mode": true,
   "minimum_bitrate": 100,
   "no_first_ad_chain": true,
   "no_first_ad_chain_inc0_only": true,
   "order_mode": "fs",
   "player_reload_attempts": "1",
   "playlists": {
      "b": [
         {
            "aspect": 1.77777777777778,
            "duration": 59,
            "id": "143061074",
            "image": "//image.vam.synacor.com.edgesuite.net/8a/de/8adecc5ba4f30a14f5f6a9647df561009607975d",
            "keywords": "AOL, B60, Buzz60, Emily Drooby, papa johns, pizza, suing",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/dc/65/buzz60/6979756591861294182_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/e6/8e/buzz60/6979756591861294182_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/33/b4/buzz60/6979756591861294182_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "The Shocking Reason a California Man is Suing Papa John's"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 62,
            "id": "142906669",
            "image": "//image.vam.synacor.com.edgesuite.net/15/1d/151de6f10e826901d64c58d323da87e03d9e7ea6",
            "keywords": "Buzz60, Facebook, Instagram, Luvable Dog Rescue, Pablo Picasso, Pablo Picasso painting, People are in Love With Dog That Looks Like a Picasso Painting, Picasso dog, adoption, animal adoption, animal news, animal rescue, animals, dog, funny face dog, social media",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/8a/de/buzz60/8887743272234556585_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/03/2c/buzz60/8887743272234556585_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/75/bf/buzz60/8887743272234556585_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "People are in Love With Dog That Looks Like a Picasso Painting"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 61,
            "id": "142898800",
            "image": "//image.vam.synacor.com.edgesuite.net/81/ae/81ae9fbd4d7d4f22564786911691241aead0dfe5",
            "keywords": "buzz60, keri lumm, mall of america, mall of america 25th anniversary, mall of america writer in residence, the mall of america writer, writer in residence, writing competition",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/03/24/buzz60/5721861757468993937_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/43/dd/buzz60/5721861757468993937_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/b5/81/buzz60/5721861757468993937_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Mall of America is Looking for a Writer-in-Residence"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 62,
            "id": "142890500",
            "image": "//image.vam.synacor.com.edgesuite.net/1c/aa/1caa9acc42afef6f4da84ef28af1fb570205178d",
            "keywords": "buzz60, keri lumm, zara, zara ad, zara ad curves, zara ad twitter, zara fashion, zara love your curves, zara marketing ",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/42/48/buzz60/6649995377717798992_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/af/75/buzz60/6649995377717798992_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/45/28/buzz60/6649995377717798992_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Zara Wants Girls to \"Love Your Curves\" Even If They Don't Have Them"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 64,
            "id": "142846752",
            "image": "//image.vam.synacor.com.edgesuite.net/a5/69/a569a46f6752e1d654d9408dc177d179ade992ca",
            "keywords": "Android, Arnold Schwarzenegger, Boston Dynamics, Boston Dynamics Handle, Buzz60, Google, Google Boston Dynamics, Google Handle robot, Google robot, Google's New Robot is Basically 'The Terminator' on Wheels, Google's new robot, Introducing Handle , Terminator 2, The Terminator, humanoid, news, robot takeover, robots, science, weird news",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/4e/ef/buzz60/1214912574513887465_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/1e/21/buzz60/1214912574513887465_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/4e/f2/buzz60/1214912574513887465_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Google's New Robot is Basically 'The Terminator' on Wheels"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 65,
            "id": "142724755",
            "image": "//image.vam.synacor.com.edgesuite.net/19/ed/19ed4bdfdfd029314c6cafcc3d5fcb093b39df2e",
            "keywords": "Buzz60, Scientists Can Crash the Mosquito Population by Manipulating Genes, Scientists Can Wipe Out Deadly Mosquitoes by Manipulating Genes, Scientists Can Wipe Out Deadly Mosquitoes with Common Bacteria, Seth Bordenstein, Vanderbilt University, Wolbachia, Yale University, Zika, dengue, malaria, mosquito, mosquitoes, news, weird news",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/28/cc/buzz60/5458638475915294324_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/9a/50/buzz60/5458638475915294324_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/47/e9/buzz60/5458638475915294324_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Scientists Can Wipe Out Deadly Mosquitoes with Common Bacteria"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 64,
            "id": "142719745",
            "image": "//image.vam.synacor.com.edgesuite.net/af/f6/aff6d832ca378ae766269018f457297870e72b22",
            "keywords": "air streams, airlines, airplane food, angeli kakade, buzz60, can turbulence cause crash, delta, is turbulence dangerous, turbulence, why is airplane bad",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/3d/b5/buzz60/6912882972145171215_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/59/76/buzz60/6912882972145171215_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/b3/45/buzz60/6912882972145171215_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Answers to Airplane Questions You've Always Wanted to Know"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 72,
            "id": "142715071",
            "image": "//image.vam.synacor.com.edgesuite.net/35/e4/35e496aa2bb2df4d5f3eaab5decf1985f22e0970",
            "keywords": "Cherry Blossom Peak Bloom Forecasts, angeli kakade, buzz60, cherry blossom, cherry blossom festival dc, free DC events, spring in DC, things to do in DC, when do cherry blossoms bloom",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/49/c6/buzz60/4494527215198164922_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/97/b4/buzz60/4494527215198164922_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/ad/7a/buzz60/4494527215198164922_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Why You Can Toss This Year's Cherry Tree Blossom Predictions"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 77,
            "id": "142707852",
            "image": "//image.vam.synacor.com.edgesuite.net/1d/11/1d110a86e626347186bf2eb870f3900ade4548db",
            "keywords": "Boeing, Buzz60, Concorde, Lockheed Martin, Mach 1, NASA, NASA Developing Quiet Supersonic Jet, NASA to Change Air Travel with Quiet Supersonic Jet, QueSST, QueSST X-plane, X-plane, air travel, science, space, speed, speed of sound, supersonic, supersonic jet, travel, travel news",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/ee/bb/buzz60/7338164415342838865_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/e5/5b/buzz60/7338164415342838865_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/ab/fd/buzz60/7338164415342838865_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "NASA to Change Air Travel with Quiet Supersonic Jet"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 61,
            "id": "142694710",
            "image": "//image.vam.synacor.com.edgesuite.net/3a/23/3a23cc2ef8bc611fb71d839eb70522eb4f626570",
            "keywords": "Buzz60, TC Newman, UAW, auto news, automotive, cars, electric cars, elon musk, freemont california, frozen yogurt, fun work environment, roller coaster, tesal, tesla factory, tesla work conditions, united auto workers union",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/d9/e0/buzz60/6795896164847384129_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/19/78/buzz60/6795896164847384129_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/42/4e/buzz60/6795896164847384129_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Elon Musk Promises Factory Workers A Roller Coaster And Free Frozen Yogurt"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 60,
            "id": "142678360",
            "image": "//image.vam.synacor.com.edgesuite.net/50/e2/50e261b42d672829ceb18ed5785c06160a96471e",
            "keywords": "Kellyanne conway, alternative, black, colleges, couch, donald trump, etiquette, forrest gump, imgur, internet, memes, news, oval office, pokemon go, politics, president, twitter, universities",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/4d/e7/buzz60/8612673711954391784_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/ea/1f/buzz60/8612673711954391784_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/5b/4f/buzz60/8612673711954391784_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Kellyanne Conway Chilling on the Oval Office Couch has Twitter on Fire"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 85,
            "id": "142517582",
            "image": "//image.vam.synacor.com.edgesuite.net/5d/8a/5d8ae47aaa0b2d50fc94e222977a62ce5b2f2210",
            "keywords": "Travel, boston, chicago, gothenburg, hostels, hostelworld, locals, new york, people, sociable, solo, stockholm, sweden, tips, trip, usa, warmth",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/d5/53/buzz60/2899324399518519389_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/74/ff/buzz60/2899324399518519389_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/12/96/buzz60/2899324399518519389_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "These Are the 5 Most Sociable Cities in the World"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 72,
            "id": "142499238",
            "image": "//image.vam.synacor.com.edgesuite.net/6e/8f/6e8f35a2b156575e92fb483a1aec73556bdc05d1",
            "keywords": "Bumblebees learn from each other, Buzz60, Queen Mary University of London, This Bumblebee is a Better Athlete Than You, Watch a Bumblebee Score a Goal, animals, bee, bee population, bee sting, bee sting pain, bees learn from other bees, bumblebee, insects, killer bee, lab test, news, science, test",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/5b/ce/buzz60/6257346196914768945_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/7d/34/buzz60/6257346196914768945_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/4a/62/buzz60/6257346196914768945_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Yes, This is Video of a Bumblebee Scoring a Goal with a Ball"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 59,
            "id": "142491667",
            "image": "//image.vam.synacor.com.edgesuite.net/bc/00/bc0098d422acb5714197aa42d98d304984791543",
            "keywords": "AOL, African tortoise, Arizona, B60, Buzz60, Dove Mountain resort, Emily Drooby, Marana, Ritz-Carlton, Ron Brink, adorable, animals, babies, baby, cute, desert cottontail rabbit, pets, rabbit, turtle",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/89/28/buzz60/8842835869376315384_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/95/d8/buzz60/8842835869376315384_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/72/56/buzz60/8842835869376315384_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "A Tortoise and a Baby Bunny Become Best Friends"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 51,
            "id": "142476893",
            "image": "//image.vam.synacor.com.edgesuite.net/9a/81/9a818ecbc0ef960a77b540f6d0e35645272895a5",
            "keywords": "AOL, B60, Buzz60, Emily Drooby, Mombetsu Land, adorable, animals, cute animal, pets, seal, toy seal, video, viral, zoo",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/80/f7/buzz60/1255375346693469919_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/99/8b/buzz60/1255375346693469919_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/51/62/buzz60/1255375346693469919_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Photos of a Seal Hugging a Toy Version of Itself is Cuteness Overload"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 56,
            "id": "142456423",
            "image": "//image.vam.synacor.com.edgesuite.net/b7/9f/b79f2cdd028af0069601b9ea955c0b4e7a014cd2",
            "keywords": "AOL, Cabot creamery, Emily Drooby, Florida Strawberry festival, McGill University , fruit, guinness world record, national strawberry day, smoothie, strawberry, veuer",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/f2/78/buzz60/5164931125394821127_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/25/8f/buzz60/5164931125394821127_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/f2/75/buzz60/5164931125394821127_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Festival Attempting to Make Worldâ  s Largest Strawberry Yogurt Smoothie"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 62,
            "id": "142124695",
            "image": "//image.vam.synacor.com.edgesuite.net/ae/ea/aeeace52205cec367cd09288331bcea508130a4f",
            "keywords": "amanda kabbabe, buzz60, grey squirrels, red squirrels, red squirrels endangered, red squirrels england, red squirrels extinction, red squirrels uk, red squirrels united, squirrelpox, the wildlife trusts",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/8c/62/buzz60/8229476524924184726_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/e3/2b/buzz60/8229476524924184726_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/f6/28/buzz60/8229476524924184726_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "An Army of Volunteers is Requested to Save the U.K.'s Red Squirrels"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 68,
            "id": "142112123",
            "image": "//image.vam.synacor.com.edgesuite.net/53/b3/53b325b47ef72652435421bd67f4459f3cc686ec",
            "keywords": "Buzz60, Jose Sepulveda, adventure, animal, baby, birth, calf, education, facebook, giraffe, gofundme, harpursville, jordan, live feed, live stream, nature, new york, nudity, owner, park, patch, sexual content, social media, youtube, zoo",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/b5/e9/buzz60/3396935485839341976_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/6e/a0/buzz60/3396935485839341976_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/74/7b/buzz60/3396935485839341976_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Live Giraffe Cam Taken Down Because of â  Sexual Contentâ  "
         },
         {
            "aspect": 1.77777777777778,
            "duration": 61,
            "id": "142095429",
            "image": "//image.vam.synacor.com.edgesuite.net/8c/4f/8c4ff10c94a0f10279a61fe437c277c4a0db3be5",
            "keywords": "Jose Sepulveda, Veuer, administration, bind, cast, crescent moon, donald, facebook, half moon, hex, new moon, president, republican, spell, town hall, trump, vex, waning, witch, womens march",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/92/a0/buzz60/4983587977274152194_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/a2/56/buzz60/4983587977274152194_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/ba/9d/buzz60/4983587977274152194_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Witches To Cast Binding Spells On President Trump"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 64,
            "id": "142085030",
            "image": "//image.vam.synacor.com.edgesuite.net/5b/22/5b228e3a7561444c9d5a6c32054d0f64d984cdc8",
            "keywords": "angeli kakade, buzz60 , celeb look a likes, first lady, melania trump nude, melania trump pictures, mira tzur, trump impersonator",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/ff/c4/buzz60/3131371624426727256_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/1b/3e/buzz60/3131371624426727256_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/77/8c/buzz60/3131371624426727256_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "A Melania Trump Look-alike is Making $3K An Event"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 72,
            "id": "142085037",
            "image": "//image.vam.synacor.com.edgesuite.net/8e/76/8e76e1c8c74f1fae6126eac8989bfba9932d6a2c",
            "keywords": "AOL, America, Emily Drooby, NASA, National UFO Reporting Centre, Sam Monfort, UFO, USA, alien, b60, buzz60, exoplanet, space, states",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/b9/c9/buzz60/6153586166359191522_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/5c/95/buzz60/6153586166359191522_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/f5/3b/buzz60/6153586166359191522_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "UFO Sightings At An All-Time High, Especially in America"
         },
         {
            "aspect": 1.77777777777778,
            "duration": 71,
            "id": "142059256",
            "image": "//image.vam.synacor.com.edgesuite.net/1b/bd/1bbd7e6df44b16885e0ecb98b30daeecd89e2edb",
            "keywords": "angeli kakade, best filter, buzz60, facebook, filter app free, how to upload album on instagram, instagram, instagram blog, instagram filters, instagram new features",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/5f/32/buzz60/8632747879865596964_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/0c/cb/buzz60/8632747879865596964_200k_32k_480x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 600,
                  "file": "//hdsvam-vh.akamaihd.net/z/a2/6e/buzz60/8632747879865596964_600k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Instagram's New Feature Is Worth 10 Photos"
         }
      ],
      "d": [
         {
            "aspect": 1.77777777777778,
            "duration": 98,
            "id": "142998006",
            "image": "//image.vam.synacor.com.edgesuite.net/af/88/af885fb8281ded5136735a95b83ac70bb0a6eaa5",
            "keywords": "Don't Miss",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/59/fa/dontmiss/8345262186538518595_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/f8/3c/dontmiss/8345262186538518595_200k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 500,
                  "file": "//hdsvam-vh.akamaihd.net/z/1f/17/dontmiss/8345262186538518595_500k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Don't Miss! - 03/02"
         }
      ],
      "db": [
         {
            "aspect": 1.77777777777778,
            "duration": 11,
            "id": "142998012",
            "image": "//image.vam.synacor.com.edgesuite.net/d7/38/d738c12260d06284f7956fd9c283ec0f6fe0d9de",
            "keywords": "Don't Miss",
            "media": [
               {
                  "bitrate": 100,
                  "file": "//hdsvam-vh.akamaihd.net/z/cc/f7/dontmiss/8265669167911189998_100k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 200,
                  "file": "//hdsvam-vh.akamaihd.net/z/b7/b8/dontmiss/8265669167911189998_200k_32k_302x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               },
               {
                  "bitrate": 500,
                  "file": "//hdsvam-vh.akamaihd.net/z/cd/bd/dontmiss/8265669167911189998_500k_96k_722x0.mp4/manifest.f4m",
                  "media_scheme": "mp4"
               }
            ],
            "title": "Don't Miss! - 03/02"
         }
      ]
   },
   "prefix": [
      "a",
      "db",
      "a",
      "d"
   ],
   "replace_dcc": false,
   "resize_bitrate": true,
   "restricted_content": {},
   "seen_at_end": false,
   "show_comingup": true,
   "show_navbuttons": true,
   "show_nowplaying": true,
   "static_ad_in_dcc": false,
   "static_ad_rotation_secs": "30",
   "static_ad_size_match": false,
   "static_ad_source": "contango__syndicationdfptemplate",
   "static_ad_tag": "<!-- BEGIN TECHNORATI MEDIA TAG FOR SynacorSyndication_RON_300x250, Ad Size: Medium Rectangle (300x250) -->\n<script type='text/javascript'>\n   document.write('<scri' + 'pt type=\"text/javascript\" src=\"'\n   + (document.location.protocol == 'https:' ? 'https://uat-secure.technoratimedia.com' : 'http://ad-cdn.technoratimedia.com')\n   + '/00/17/17/uat_61717.js?ad_size=300x250&pub_code=56494666172\"></scri' + 'pt>');\n</scr" + "ipt>\n<!-- END TECHNORATI MEDIA TAG FOR SynacorSyndication_RON_300x250, Ad Size: Medium Rectangle (300x250) -->\n",
   "static_ad_visible_secs": "5",
   "streamsource": "edgecast",
   "tail": [
      "a",
      "b"
   ],
   "timed_ad_break_secs": "15",
   "vamurls": {
      "b": "//syn.am4.syn-api.com/api/6/asset/list/client/showcase/vendor/Buzz60/expand/list/rows/25/language/en",
      "d": "//syn.am4.syn-api.com/api/6/asset/list/client/showcase/vendor/Don%27t%20Miss!/genres/entertainment/expand/list/rows/1/language/en",
      "db": "//syn.am4.syn-api.com/api/6/asset/list/client/showcase/vendor/Don%27t%20Miss!/genres/bumper/expand/list/rows/1/language/en"
   }
};

var bitrate_limit_kbps = 800;

// init
var audiomode_starts_muted = {muted:true, volume0:true, malamute:true, audible:false};
var ad_players = [];
var content_player = null;
var overlay_player = null;
var staticad_player = null;
var has_started = false;
var focus_wait = false;
var players_remaining = 0;
var is_inc0 = !location.search.substr(1).match(/(^|\&)inc\=/);
var autoplay_chaff = Math.random() < (cfg.autoplay_mode_chaff || 0) / 100;
var autoplay =
    cookie_get("synapm") === 'disable'    ? false
  : cfg.autoplay_mode    === 'always'     ? true
  : cfg.autoplay_mode    === 'inc0'       ? is_inc0
  : cfg.autoplay_mode    === 'onfocus'    ? (jwp_hasfocus() || autoplay_chaff)
  : cfg.autoplay_mode    === 'inviewport' ? (jwp_isinviewport(0.5) || autoplay_chaff)
  : false;
var ad_spots_remaining = 0;
var ad_loading_mutex = false, ad_playing_mutex = false;
var ad_playing_break_type = null;
var ads_start_time = null;
var ads_start_timeout = null;
var min_adslot_time_secs = 15; // how long min between starting each adslot (prevents spamming)
var adbreak_timer_timeout = null;
var background_ad = false;
var backgroundad_shown = false;
var should_adlog = Math.random() < cfg.logthrottle;
var load_time = timestamp();
var instance_id = String(load_time)+"-"+String(Math.random()).substr(2);
var jwp_inited = false;
var unmute_logged = !audiomode_starts_muted[cfg.audio_mode];
var user_interacted = false;
var disable_ads = false;
var vam_jsonp_failsafe = null;
var vam_jsonp_requests_pending = 0;
var tail_start = 0;
var pre_ads = [];
var playlist_spec = [];
var pread_num = 0;
var playlist = [];
var retry_timeouts = [];
var current_playlist_item = 0;
var loaded_playlist_item = 0;
var current_ad_chain = [];
var attempt_timeout = null;
var simultaneous_ad_loader_timeout = null;
var staticad_refresh_timeout = null;
var ads_start_retry_timeout = null;
var master_pause = false;
var unloaders = [];
var is_in_crossdomain_frame = false;
var crossdomain_url = null;
var show_static_ad = true;
var browser_type = browser_detect();
var topmost_window = window;
var dfp_adunit = "/5284/syn.internetbrands/diy".replace(/%{2}ADUNIT%{2}/, "");
var origin = null; try { origin = window.top.location.href; } catch(e) {
  is_in_crossdomain_frame = true;
  origin = "${REFERER_URL_ENC}".match(/^http/) ? decodeURIComponent("${REFERER_URL_ENC}") : null; // AppNexus macro
  if (origin === null) {
    var limit = 20;
    var cur_window = window;
    while (limit > 0 && cur_window !== window.top) {
      try {
        // traverse to the top-most iframe we can access to to pull correct referrer.
        origin = cur_window.document.referrer;
        crossdomain_url = cur_window.location.href;
        topmost_window = cur_window;
      } catch (e) {
        // Do nothing
      }
      cur_window = cur_window.parent;
      limit--;
    }
  }
  // Uses ancestorOrigins method as backup only since it doesn't report full page URL. 
  if (window.location.ancestorOrigins && window.location.ancestorOrigins.length) {
    var ancestorOrigin = window.location.ancestorOrigins[window.location.ancestorOrigins.length-1];
    if (origin === null || origin.substr(0,ancestorOrigin.length) !== ancestorOrigin) origin = ancestorOrigin;
  }
}
if (origin === null) {
  origin = protocol_get() + "//unknown/";
  track_throttled("unknownorigin");
}
if (is_in_crossdomain_frame) {
  track_throttled("crossdomain", {"url": crossdomain_url});
}
var domain = origin.match(/^https?:\/\/(?:[^\@\/]*\@)?([^\/\:]+)/)[1];
var thumbnailurl_strip_prefix = /^(https?:)?\/\/image\.vam\.synacor\.com\.edgesuite\.net\//;
var streamurl_strip_prefix = /^(https?:)?\/\/hdsvam\-vh\.akamaihd\.net\/z\//;
var streamurl_strip_suffix = /\/manifest\.f4m$/;
var first_onplay_of_asset = true;
var nowplaying_min_height = 57;
var skip_chaining = cfg.no_first_ad_chain && (!cfg.no_first_ad_chain_inc0_only || is_inc0); // Flag to support a separate initial ad load timeout and disable chaining on it too.
var state = null;
var state_time = null;
var log_aceview = false;
var blank_image_url = "//image.vam.synacor.com.edgesuite.net/e2/21/e2216a7e9b73f5cb0279351c78ce61c33475cea7"; //prevent jwplayer 6.8-6.12 bug which requests the current page several times if no image is given
var player_mode = null;

var debug = false;
var debug_stacktrace = false;

function blacklisted() {
  if (window.navigator.userAgent.match(/^Mozilla\/5\.0 \(Windows .*; rv:41\.0\) Gecko\/20100101 Firefox\/41\.0(?: |$)/)
   && window.navigator.buildID === "20150917150946") return true; // Firefox v41.0 Windows Flash crashing. Fixed in v41.0.1
  return false;
}

if (!blacklisted()) {
  track_throttled("init");
  state_set("init");
}

var dcc_mode = false;
var dcc_rotation_handler = function () {};
var saved_dcc_bitrate = null;
var dcc_handler_installed = false;

var playlist_order = {
  random: function (playlist) {
    playlist.sort(function(a,b){ return Math.random()-.5; });
  },

  fs: function (playlist) {
    playlist.sort(function(a,b){ return Math.random()-.5; });

    var duration_total = 0;
    for (var i=0; i<playlist.length; i++) {
      duration_total += playlist[i].duration || 0;
    }
    var average_duration = duration_total/playlist.length;
    var variance_total = 0;
    for (var i=0; i<playlist.length; i++) {
      variance_total += Math.pow((playlist[i].duration || 0) - average_duration, 2);
    }
    var variance = Math.sqrt(variance_total / playlist.length);

    if (variance > 5) playlist.sort(function(a,b) { return (Math.round(((a.duration || 0)/variance) + Math.random())) - (Math.round(((b.duration || 0)/variance) + Math.random())); });
  }
};

var streamurl_build = {
  akamai: function(canonical_url) {
      return "http" + "://hdsvam-vh.akamaihd.net/i/" + canonical_url + "/master.m3u8";
  },
  edgecast: function(canonical_url) {
      return protocol_get() + "//large.edgecast.syn-cdn.com/" + canonical_url + ".m3u8";
  },
  edgecast_mp4: function(canonical_url) {
      return "http" + "://wpc.f93a.edgecastcdn.net/80F93A/am4/video/" + canonical_url;
  }
};

var thumbnailurl_build = {
  akamai: function(canonical_url) {
      return "http" + "://image.vam.synacor.com.edgesuite.net/" + canonical_url;
  },
  edgecast: function(canonical_url) {
      return protocol_get() + "//small.edgecast.syn-cdn.com/" + canonical_url;
  }
};

var title_build = {
  d: function(old_title) {
    var date = old_title.match(/\d{1,2}\/\d{1,2}/);
    return "Don't Miss!" + (date !== null ? " - " + date : "");
  },
  db: function(old_title) {
    var date = old_title.match(/\d{1,2}\/\d{1,2}/);
    return "Don't Miss!" + (date !== null ? " - " + date : "") + " Preview";
  }
};

function browser_detect() {
  var result = {};
  result[
    "mozInnerScreenX" in window ? "firefox" :
    navigator.userAgent.match(/\bEdge\//) ? "edge" :
    navigator.userAgent.match(/\bTrident\/.*\brv\:11\./) ? "ie11" :
    navigator.userAgent.match(/\bMSIE 10\b/) ? "ie10" :
    navigator.userAgent.match(/\bMSIE 9\b/) ? "ie9" :
    navigator.userAgent.match(/\bMSIE 8\b/) ? "ie8" :
    navigator.userAgent.match(/\bMSIE 7\b/) ? "ie7" :
    navigator.userAgent.match(/\bMSIE 6\b/) ? "ie6" :
    navigator.userAgent.match(/\bChrome\//) ? "chrome" :
    navigator.userAgent.match(/\bFirefox\//) ? "firefox" :
    navigator.userAgent.match(/\bSafari\//) ? "safari" : "other"
  ] = true;
  result.ie = result.ie11 || result.ie10 || result.ie9 || result.ie8 || result.ie7 || result.ie6;
  return result;
}
function vam_jsonp_recv(vamid, data) {
  if (jwp_inited) return; //too late

  if (data.status === "OK" && data.results.length) {
    cfg.playlists[vamid] = [];

    for (var i=0; i<data.results.length; i++) {
      var asset = data.results[i];

      // Remove Buzz60 Entertainment category
      if (vamid === 'b' && asset.genres) {
        var exclude_me = false;
        for (var j=0; j<asset.genres.length; j++) {
          if (asset.genres[j].toLowerCase() === 'entertainment') {
            exclude_me = true;
            break;
          }
        }
        if (exclude_me) continue;
      }

      if (!asset.media || !asset.media.videos || !asset.media.videos.length) continue;

      var videos = asset.media.videos;
      var media = [];
      for (var j = videos.length-1; j>=0; j--) {
        if (!videos[j].content || !videos[j].content[0] || !videos[j].content[0].match(/^http\:\/\//)) continue;
        if ((videos[j].bitrate === null && videos.length !== 1) || videos[j].bitrate > bitrate_limit_kbps) continue;
        media.push({
          file: videos[j].content[0].replace(/^https?:/, ''),
          bitrate: videos[j].bitrate,
          media_scheme: videos[j].media_scheme
        });
      }
      media.sort(function (a,b) { return a.bitrate-b.bitrate; });

      var item = {
        id:    asset.id,
        media: media,
        title: asset.title,
        description: asset.description,
        keywords: asset.keywords,
        duration: asset.duration
      };

      if (asset.images && asset.images.length && asset.images[0].url) {
        item.image = asset.images[0].url.replace(/^https?:/, '');
        if (asset.images[0].height && asset.images[0].width) {
          item.aspect = asset.images[0].width / asset.images[0].height;
        }
      }

      cfg.playlists[vamid].push(item);
    }

    track_throttled("vamdata");
  }

  vam_jsonp_requests_pending--;
  if (!vam_jsonp_requests_pending) {
    if (vam_jsonp_failsafe) {
      clearTimeout(vam_jsonp_failsafe);
      vam_jsonp_failsafe = null;
    }
    jwp_init();
  }
}

var DisplayFrame;
(DisplayFrame = function DisplayFrame(width, height) {
  this.loaded = false;
  this.frame = null;
  this.visible = true;
  this.width  = width;
  this.height = height;
  this.content = "";
}).prototype = {
  constructor: DisplayFrame,
  setUp: function setUp(container) {
    debug_report("setUp: " + (this.id || "content") + " instance " + (this.instance || 0));
    this.frame = document.createElement("iframe");
    this.frame.className = "playerFrame";
    this.frame.width  = container_clientWidth();
    this.frame.height = container_clientHeight();
    this.frame.style.width  = (browser_type.edge || browser_type.chrome ? 0 : this.frame.width)  + "px";
    this.frame.style.height = (browser_type.edge || browser_type.chrome ? 0 : this.frame.height) + "px";
    this.hide();
    container.appendChild(this.frame);
    container = null;

    var that = this;

    var load_method = function load_method(){
      that.frameLoaded();
      listener_remove(that.frame, "load", load_method);
      load_method = that = null;
    }
    listener_attach(this.frame, "load", load_method);

    this.frame.contentWindow.document.open();
    this.frame.contentWindow.document.write(this.getContent());
    this.frame.contentWindow.document.close();

    var frame_window = this.frame.contentWindow;
    var closure_cleanup = function closure_cleanup() {
      iterate_selfandparents(window, function() {
        var window_to_clean = this;
        references_clean(window_to_clean, frame_window);
        references_clean(window_to_clean.document, frame_window);
        // remove all references to child frames of this window
        // TODO: really need to watch DOM for frame creation, then add
        // unload method that scrapes parents for their own stuff.
        // Otherwise a subframe could be removed before this parent
        // and leave behind garbage.
        iterate_childframes(frame_window, function() {
          references_clean(window_to_clean, this);
          references_clean(window_to_clean.document, this);
        });
      });
      listener_remove(frame_window, "unload", closure_cleanup);
      closure_cleanup = container = null;
    };
    listener_attach(frame_window, "unload", closure_cleanup);

    return this;
  },
  frameLoaded: function frameLoaded() {
    debug_report("frameLoaded: " + (this.id || "content") + " instance " + (this.instance || 0));

    this.loaded = true;
    frame_neuter(this.frame);
  },
  initJWP: function initJWP() {
    debug_report("initJWP: " + (this.id || "content") + " instance " + (this.instance || 0));
  },
  tearDown: function tearDown() {
    debug_report("tearDown: " + (this.id || "content") + " instance " + (this.instance || 0));
    this.loaded = false;
    this.hide();
    if (this.frame) this.frame.parentNode.removeChild(this.frame);
    this.frame = null;
  },
  reload: function reload() {
    debug_report("reload: " + (this.id || "content") + " instance " + (this.instance || 0));
    var container = this.frame.parentNode;
    this.tearDown();
    this.setUp(container);
  },
  hide: function hide() {
    this.visible = false;
    if (this.frame) this.frame.style.zIndex = 0;
  },
  show: function show() {
    this.visible = true;
    this.frame.style.zIndex = 1;
  },
  resize: function resize(width, height) {
    width = Math.max(0,width);
    height = Math.max(0,height);
    this.width  = width;
    this.height = height;
    if (this.frame) {
      this.frame.style.width  = width  + "px";
      this.frame.style.height = height + "px";
      this.frame.width  = width;
      this.frame.height = height;
    }
  },
  getHeight: function getHeight() {
    return this.height;
  },
  getWidth: function getWidth() {
    return this.width;
  },
  getContent: function getContent() {
    return this.content;
  },
  setContent: function setContent(content) {
    this.content = content;
    return this.content;
  }
};

var StaticAdFrame;
(StaticAdFrame = function StaticAdFrame(width, height) {
  DisplayFrame.prototype.constructor.call(this, width, height);
  this._loadedAt = null;
  this._shownAt = null;
  this._totalVisibleTime = 0;
}).prototype = new DisplayFrame(null, null);
StaticAdFrame.prototype.constructor = StaticAdFrame;
StaticAdFrame.prototype.frameLoaded = function frameLoaded() {
  DisplayFrame.prototype.frameLoaded.call(this);
  this._loadedAt = timestamp();
  this.resize(this.width, this.height);
  track_throttled("staticload");
  if (this.visible) this.show();
};
StaticAdFrame.prototype.tearDown = function tearDown() {
  DisplayFrame.prototype.tearDown.call(this);
  this._loadedAt = this._shownAt = null;
  this._totalVisibleTime = 0;
};
StaticAdFrame.prototype.show = function show() {
  DisplayFrame.prototype.show.call(this);
  if (this._shownAt === null) this._shownAt = timestamp();
  this.frame.style.zIndex = 1000;
  this.frame.style.visibility =  "visible";
};
StaticAdFrame.prototype.hide = function hide() {
  DisplayFrame.prototype.hide.call(this);
  if (this._shownAt !== null) {
    this._totalVisibleTime += timestamp() - this._shownAt;
    this._shownAt = null;
  }
  this.frame.style.visibility =  "hidden";
};
StaticAdFrame.prototype.getContent = function getContent() {
  var content =
    '<!DOCTYPE html>' +
    '<html>' +
    '  <head>' +
    '    <meta charset="UTF-8">' +
    '      <style>' +
    '        html, body { padding: 0; margin: 0;overflow: hidden; }' +
    '        #adFrame { padding: 0;margin: auto;position: absolute;top: 0;bottom: 0;left: 0;right: 0;width: 300px; height: 250px;}' +
    '      </style>' +
    '  </head>' +
    '  <body>' +
    '    <div id="adFrame">' +
    DisplayFrame.prototype.getContent.call(this) +
    '    </div>' +
    '  </body>' +
    '</html>';
  return content;
}
StaticAdFrame.prototype.getVisibleTime = function getVisibleTime() {
  return (this._shownAt !== null ? timestamp() - this._shownAt : 0) + this._totalVisibleTime;
};
StaticAdFrame.prototype.getRotationTime = function getRotationTime() {
  return this._loadedAt !== null ? timestamp() - this._loadedAt : 0;
};

var FramePlayer;
(FramePlayer = function FramePlayer(version, width, height, options, playerConfig) {
  DisplayFrame.prototype.constructor.call(this, width, height);
  this.ready = false;
  this.failed = false;
  this.audioMode = null;
  this.autoPlay = null;
  this._progressTimeout = null;
  this.playerMode = null;
  this._installedJWPCallbacks = {};
  this.version = version;
  this.audioMode = options.audioMode || 'malamute';
  this._muteState = options.muted;
  this.autoPlay = options.autoPlay || false;
  this.loop = options.loop || false;
  this.muteCallback = options.muteCallback || null;
  this.readyCallback = null;
  this.failureCallback = null;
  this.playerConfig = {
    primary: 'flash',
    displaytitle: false,
    androidhls: true,
    dash: true,
    hlshtml: true,
    preload: "none"
  };
  object_mergedeeply(this.playerConfig, playerConfig);
}).prototype = new DisplayFrame(null, null);
FramePlayer.prototype.constructor = FramePlayer;
FramePlayer.prototype.getContent = function getContent() {
  var content =
    '<!DOCTYPE html>' +
    '<html>' +
      '<head>' +
        '<meta charset="UTF-8">' +
        '<style>' +
        'html, body { margin: 0; padding: 0; overflow: hidden; }' +
        (version_compare(this.version, '7.0.0') >= 0 ? '.jw-skin-beelden .jw-controlbar { bottom: 30px !important; }' : '') + //NOTE: Not the official way to change skins in JWP v7.
        '</style>' +
        '<script type="text/javascript" src="' + jwp_location(this.version) + '"></scr'+'ipt>' +
      '</head>' +
      '<body>' +
        '<div id="playermaHiXX6A"></div>' +
      '</body>' +
    '</html>';
  return content;
};
FramePlayer.prototype.setUp = function setUp(container, readyCallback, failureCallback) {
  DisplayFrame.prototype.setUp.call(this, container);
  this.readyCallback = readyCallback || null;
  this.failureCallback = failureCallback || null;
};
FramePlayer.prototype.frameLoaded = function frameLoaded() {
  DisplayFrame.prototype.frameLoaded.call(this);

  var plugin_config = this.playerConfig.plugins || {};
  if (this.audioMode === "malamute") {
    plugin_config.malamute = plugin_config.malamute || {};
    plugin_config.malamute.mixmute = true;
  }
  this.playerConfig.width = this.width;
  this.playerConfig.height = this.height;
  this.playerConfig.plugins = plugin_config;
  this.playerConfig.mute = this._muteState;
  this.playerConfig.controls = this.playerConfig.controls || this.audioMode === "audible";
  this.playerConfig.autostart = this.playerConfig.autostart || this.autoPlay;
  this.playerConfig.repeat = this.loop;
  this.playerConfig.file = protocol_get() + "//synacor.autoplay-plugins.static-origin.syn-cdn.com/loading.m4v";
  this.playerConfig.type = "mp4";
};
FramePlayer.prototype.initJWP = function initJWP() {
  DisplayFrame.prototype.initJWP.call(this);
  var that = this;

  this.frame.contentWindow.jwplayer.key = version_compare(this.version, "7.0.0") < 0 ? "gTJ/ZYo7V/nNHrmCH2NpVMUsU2PSuQyiqn7Q9w==" : "dzQFPU7qBWptn2Rqf+VO9Vtf5EKYV8Klu/5GZw==";

  var wait_time = 25; // time to wait in seconds for player to be set up.

  var setuperrortimer_method = function(player) {
    if (player.failureCallback !== null) {
      player.failed = true;
      var e = {"message": "Player was not set up after " + wait_time + " seconds."};
      e['player_id'] = player.id || "content";
      player.failureCallback.apply(player, ["setuperrortimer", e]);
      player.failureCallback = null;
    }
  };
  var error_timer = window.setTimeout(function() {
    // JWP6 only
    if (browser_type.chrome && !jwp_hasfocus()) {
      track_throttled("focuswait", {player_id: that.id || "content"});
      var focuswait_method;
      focuswait_method = function () {
        track_throttled("focusgain", {player_id: that.id || "content"});
        listener_remove(that.frame.contentWindow.document, "visibilitychange", focuswait_method);
        error_timer = window.setTimeout(function() {setuperrortimer_method(that)}, wait_time * 1000);
      }
      listener_attach(that.frame.contentWindow.document, "visibilitychange", focuswait_method);
    } else {
      return setuperrortimer_method(that);
    }
  }, wait_time * 1000);
  var saved_window = this.frame.contentWindow;
  var closure_cleanup = function() {
    listener_remove(saved_window, "unload", closure_cleanup);
    if (error_timer) window.clearTimeout(error_timer);
    closure_cleanup = setuperrortimer_method = that = error_timer = saved_window = null;
  }
  listener_attach(saved_window, "unload", closure_cleanup);

  this.jwp("setup", [this.playerConfig]);

  this.addEventHandler("onReady", function(e) {
    debug_report("onReady0: " + (that.id  || "content") + " instance " + (that.instance || 0));
    window.clearTimeout(error_timer);
    that.playerMode = version_compare(that.version, '7.0.0') >= 0 ? (that.jwp('getProvider') ? that.jwp('getProvider').name : 'unknown') : that.jwp('getRenderingMode');
    if ((!that.id || !that.id.match(/^(google_|adx_)/)) && that.playerMode === 'html5' && version_compare(that.version, '7.0.0') < 0) {
      track_throttled("html5");
      that.version = '7.8.7';
      that.reload();
      return;
    }
    that.ready = true;
    that.failed = false;
    if (that.readyCallback !== null) {
      that.readyCallback.call(that);
    }
    if (!that.autoPlay && that.frame.style.width === "0px" && that.frame.style.height === "0px" && version_compare(that.version, '7.0.0') < 0) {
      window.setTimeout(function () {that.resize(that.width, that.height);}, 1);
    }
  });
  this.addEventHandler("onPlay", function(e) {
    that.resize(that.width, that.height);
  });
  this.addEventHandler("onAdPlay", function(e) {
    that.resize(that.width, that.height);
  });
  this.addEventHandler("onSetupError", function(e) {
    window.clearTimeout(error_timer);
    if (that.failureCallback !== null) {
      e['player_id'] = that.id || "content";
      that.failureCallback.apply(that, ["setuperror", e]);
    }
    that.readyCallback = null;
    that.failureCallback = null;
  });

  this.addEventHandler("onError", function(e) {
    if (that.failureCallback !== null) {
      e['player_id'] = that.id || "content";
      that.failureCallback.apply(that, ["playerror", e]);
    }
    that.readyCallback = null;
    that.failureCallback = null;
  });

  this.jwp("registerPlugin", ["malamute", "6.0", protocol_get() + "//synacor.autoplay-plugins.static-origin.syn-cdn.com/malamute.swf"]);
  if (this.audioMode === "volume0") {
    this.jwp("setVolume", [this._muteState ? 0 : 100]);
  }
};
FramePlayer.prototype.tearDown = function tearDown() {
  for (var cb_name in this._installedJWPCallbacks) {
    if (this._installedJWPCallbacks[cb_name]) {
      for (var i=0;i<this._installedJWPCallbacks[cb_name].length;i++) {
        this._installedJWPCallbacks[cb_name][i].cleanup(true);
      }
    }
    delete this._installedJWPCallbacks[cb_name];
  }
  this._installedJWPCallbacks = {};

  this.ready = this.failed = false;
  try {
    this.jwp('remove');
  } catch (e) {}
  DisplayFrame.prototype.tearDown.call(this);
};
FramePlayer.prototype.reload = function reload() {
  // Don't call parent
  debug_report("reload: " + (this.id || "content") + " instance " + (this.instance || 0));
  var container = this.frame.parentNode;
  this.tearDown();
  var that = this;
  window.setTimeout(function() {
    that.setUp(container, that.readyCallback, that.failureCallback);
    that = container = null;
  }, 0);
};
FramePlayer.prototype.destroy = function destroy() {
  this.tearDown();
  this.readyCallback = null;
  this.failureCallback = null;
};
FramePlayer.prototype.resize = function resize(width, height) {
  DisplayFrame.prototype.resize.call(this, width, height);
  this.jwp("resize", [width, height]);
};
FramePlayer.prototype.jwp = function jwp(method, args_in) {
  if (!this.loaded) return null;
  if (!args_in) args_in = [];
  var jwp_obj = this.frame.contentWindow.jwplayer("playermaHiXX6A");
  if (!jwp_obj) return null;
  if (arguments.length === 0) return jwp_obj;

  if (method.match(/^on[A-Z]/)) {
    this.addEventHandler(method, args_in[0]);
    return jwp_obj;
  }
  var args = [];
  for (var i=0; i<args_in.length; i++) args.push(clone_into_scope(args_in[i], window, this.frame.contentWindow));
  return jwp_obj[method].apply(jwp_obj, args);
};
FramePlayer.prototype.getPosition = function getHeight() {
  return this.jwp("getPosition");
};
FramePlayer.prototype.getDuration = function getWidth() {
  return this.jwp("getDuration");
};
FramePlayer.prototype.isPaused = function isPaused() {
  var state = this.jwp("getState")
  if (state) state = state.toUpperCase();
  return state === "PAUSED" || state === "IDLE" || state === "COMPLETE";
};
FramePlayer.prototype.pause = function pause(state) {
  // undefined toggles state, true pauses, false plays
  if (state === undefined) {
    this.jwp("pause", [false]);
  } else if (state) {
    this.jwp("pause", [true]);
  } else {
    this.jwp("play", [true]);
  }
};
FramePlayer.prototype.isMuted = function isMuted() {
  return this._muteState;
};
FramePlayer.prototype.mute = function mute(force) {
  if (force || !this.isMuted()) {
    this._muteState = true;
    if (this.jwp) {
      if (this.audioMode === "volume0" || this.playerMode === "html5") {
        if (this.jwp("getVolume") === 0) this.jwp("setVolume", [1]); // JWPlayer bug... must set volume to something else first
        this.jwp("setVolume", [0]);
      }
      this.jwp("setMute", [true]);
    }
  }
};
FramePlayer.prototype.unmute = function unmute(force) {
  if (force || this.isMuted()) {
    this._muteState = false;
    if (this.jwp) {
      this.jwp("setVolume", [100]);
      this.jwp("setMute", [false]);
    }
  }
};
FramePlayer.prototype.setControls = function setControls(val) {
  this.jwp("setControls", [val]);
  this.playerConfig.controls = val;
};
FramePlayer.prototype.addEventHandler = function addEventHandler(method, f, options) {
  if (typeof f !== "function") return;
  var that = this;
  if (!(method in this._installedJWPCallbacks)) {
    var that = this;
    this._installedJWPCallbacks[method] = [];
    var jwp_obj = this.jwp();
    if (!jwp_obj) return;
    if (method in jwp_obj) {
      var stub_method = function(e) { that.fireEventHandler.apply(that, [method, e]) };
      if (version_compare(this.version, "7.0.0") >= 0) {
        jwp_obj.on(method.charAt(2).toLowerCase() + method.slice(3), stub_method);
      } else {
        jwp_obj[method].apply(this, [stub_method]);
      }
    }
  }
  var callbacks = jwp_gencallback(method + (this.id ? ": " + this.id: ""), f);
  var methods = {
    origMethod: f,
    method: callbacks[0],
    options: options || {},
    called: false,
    cleanup: function(all) {
      callbacks[1].call();
      methods.origMethod = methods.method = methods.options = methods.cleanup = callbacks = null;
      if (all) that = method = f = options = null;
    }
  };
  this._installedJWPCallbacks[method].push(methods);
};
FramePlayer.prototype.fireEventHandler = function fireEventHandler(method, e) {
  if (!method in this._installedJWPCallbacks) return;

  for (var i=0;this._installedJWPCallbacks[method] && i<this._installedJWPCallbacks[method].length;i++) {
    if (this._installedJWPCallbacks[method][i] === null) continue;
    if (this._installedJWPCallbacks[method][i].options.fireOnce && this._installedJWPCallbacks[method][i].called) continue;
    this._installedJWPCallbacks[method][i].called = true;
    this._installedJWPCallbacks[method][i].method.apply(this, [e]);
    // Warning... a callback could destroy player which may empty the _installedJWPCallbacks in mid loop
    if (!this._installedJWPCallbacks[method]) break;
    if (this._installedJWPCallbacks[method][i].options.fireOnce) {
      this._installedJWPCallbacks[method][i] = null;
    }
  }
  this._cleanupEventHandlers();
};
FramePlayer.prototype.removeEventHandler = function removeEventHandler(method, f) {
  if (typeof f !== "function" || !method in this._installedJWPCallbacks) return;
  var cb = this._installedJWPCallbacks[method];
  for (var i=0; i<cb.length; i++) {
    if (cb[i] !== null) {
      if (cb[i].origMethod === f) {
        cb[i].cleanup(false);
        cb[i] = null;
        this._cleanupEventHandlers();
      }
    }
  }
};
FramePlayer.prototype.removeEventHandlers = function removeEventHandlers(method_or_options) {
  if (arguments.length === 0) {
    for (var m in this._installedJWPCallbacks) this._installedJWPCallbacks[m] = [];
  } else if (typeof method_or_options === "string" && method_or_options in that._installedJWPCallbacks) {
    for (var i=0;i<that._installedJWPCallbacks[method_or_options].length;i++) {
      that._installedJWPCallbacks[method_or_options][i].cleanup(true);
    }
    that._installedJWPCallbacks[method_or_options] = [];
  } else if (typeof method_or_options === "object") {
    for (var m in this._installedJWPCallbacks) {
      for (var i=0;i<this._installedJWPCallbacks[m].length;i++) {
        if (this._installedJWPCallbacks[m][i] !== null && this._installedJWPCallbacks[m][i].options) {
          var found = true;
          for (var n in method_or_options) {
            if (!n in this._installedJWPCallbacks[m][i].options || this._installedJWPCallbacks[m][i].options[n] !== method_or_options[n]) {
              found = false;
              break;
            }
          }
          if (found) this._installedJWPCallbacks[m][i] = null;
        }
      }
    }
    this._cleanupEventHandlers();
  }
};
FramePlayer.prototype._cleanupEventHandlers = function _cleanupEventHandlers() {
  for (var m in this._installedJWPCallbacks) {
    var new_list = [];
    for (var i=0;i<this._installedJWPCallbacks[m].length;i++) {
      if (this._installedJWPCallbacks[m][i] !== null) new_list.push(this._installedJWPCallbacks[m][i]);
    }
    this._installedJWPCallbacks[m] = new_list;
  }
};

var ContentFramePlayer;
(ContentFramePlayer = function ContentFramePlayer(version, width, height, options, playerConfig) {
  var args = Array.prototype.slice.call(arguments);
  FramePlayer.prototype.constructor.apply(this, args);
  this.currentBitrate = null;
  this.startPosition = null;
  this.startPaused = false;
  this.asset = null;
  this.isHd = false;
}).prototype = new FramePlayer(null, null, null, {}, {});
ContentFramePlayer.prototype.constructor = ContentFramePlayer;
ContentFramePlayer.prototype.frameLoaded = function frameLoaded() {
  this.frame.style.borderBottom = "white solid 10000px";
  FramePlayer.prototype.frameLoaded.call(this);
  this.playerConfig.skin =
    version_compare(this.version, "7.0.0") >= 0 ?
      "beelden" :
      (protocol_get() + "//synacor.autoplay-plugins.static-origin.syn-cdn.com/skins/beelden_high_margin_" + (version_compare(this.version, "6.11") < 0 ? "6.7" : "6.11") + ".xml");
  this.initJWP();

  var that = this;
  this.addEventHandler("onFullscreen", function(e) {
    track_throttled("fullscreen", {"event_state": e.fullscreen ? "true" : "false"})
  });

  this.addEventHandler("onPlay", function(e) {
    that.frame.style.top = "0"; // Move back down
    if (that.startPosition) that.jwp("seek", [that.startPosition]);
    that._muteState ? that.mute(true) : that.unmute(true);
  });

  this.addEventHandler("onSeek", function(e) {
    if (that.startPosition && !that.startPaused) that.startPosition = null; // JWP bug. startPaused is involved because position isn't recorded until player starts playing.
    if (that.startPaused) that.jwp("pause", [true]);
  });

  this.addEventHandler("onPause", function(e) {
    if (this._progressTimeout !== null) {
      window.clearTimeout(this._progressTimeout);
      this._progressTimeout = null;
    }
    that.startPosition = null; // JWP bug. Position isn't recorded until player starts playing. Don't erase starting point until the player plays.
    that.startPaused = false;
  });

  this.addEventHandler("onComplete", function(e) {
    if (this._progressTimeout !== null) {
      window.clearTimeout(this._progressTimeout);
      this._progressTimeout = null;
    }
    that.hide();
  });
};
ContentFramePlayer.prototype.tearDown = function tearDown() {
  if (this._progressTimeout !== null) {
    window.clearTimeout(this._progressTimeout);
    this._progressTimeout = null;
  }
  FramePlayer.prototype.tearDown.call(this);
};
ContentFramePlayer.prototype.play = function play(asset, startPosition, bitrate, autoplay) {
  var that = this;
  this.currentBitrate = bitrate;
  this.startPosition = startPosition;
  this.asset = clone_into_scope(asset, window, window);

  this.resize(this.width, cfg.show_nowplaying && this.asset.aspect ? Math.min(Math.round(this.width / asset.aspect), container_clientHeight()) : container_clientHeight());

  var media_file = mediafile_fetchbitrate(this.asset, this.currentBitrate);
  for (var k in media_file) this.asset[k] = media_file[k];

  this.asset.image = this.asset.image || blank_image_url; //prevent jwplayer 6.8-6.12 bug which requests the current page several times if no image is given

  if (autoplay) {
    this.addEventHandler("onPlaylist", function(e) {
      window.setTimeout(function() {
        that.show();
        that.jwp("play", [true])
      }, 1); // Cannot be called from within callback thread.
    }, {fireOnce: true});
  }
  this.jwp("load", [[this.asset]]);

  if (browser_type.safari) { // handle safari power saver
    if (this._progressTimeout !== null) {
      window.clearTimeout(this._progressTimeout);
      this._progressTimeout = null;
    }
    this._progressTimeout = window.setTimeout(function() {
      if (that.jwp("getState") === null) {
        track_throttled("powersavercontent");
        adbreak_timer_remove();
        adbreak_timer_resetall_if_fired();
      }
    }, 3000);
  }
};
ContentFramePlayer.prototype.setBitrate = function setBitrate(bitrate) {
  if (!this.ready) return;
  if (bitrate === this.currentBitrate) return;
  this.currentBitrate = bitrate;
  var state = this.jwp("getState");
  if (state) state = state.toUpperCase();
  if (state === "IDLE") return;
  if (state === "PAUSED") this.startPaused = true;
  if (!this.startPosition) this.startPosition = this.jwp("getPosition");
  var media_file = mediafile_fetchbitrate(this.asset, this.currentBitrate);
  for (var k in media_file) this.asset[k] = media_file[k];
  var that = this;
  this.addEventHandler("onPlaylist", function(e) {
    window.setTimeout(function() {
      that.show();
      that.jwp("play", [true])
    }, 1); // Cannot be called from within callback thread.
  }, {fireOnce: true});
  this.jwp("load", [[this.asset]]);
};
ContentFramePlayer.prototype.toggleHd = function toggleHd() {
  this.isHd = !this.isHd;
  return this.isHd;
};

var AdFramePlayer;
(AdFramePlayer = function AdFramePlayer(version, width, height, options, playerConfig, client, tag, id, instance) {
  var args = Array.prototype.slice.call(arguments, 0, -3);
  FramePlayer.prototype.constructor.apply(this, args);
  if (id.match(/^(google_|adx_)/) && (is_in_crossdomain_frame || !browser_type.chrome)) this.playerConfig.primary = 'html5';
  this.client = client;
  this.tag = tag;
  this.id = id;
  this.instance = instance;
  this.busy = false;
  this.usingVPAID = false;
  this.maxSecondsLoading = 0;
  this.maxSecondsPlaying = 0;
  this.initted = false;
  this._loadingTimeout = null;
  this._playingTimeout = null;
  this._finishedTimeout = null;
  this._startedAt = null;
  this._cleanupTimeout = null;
  this._hasImpression = false;
  this._throttleWindowStart = null;
  this._throttleWindowCount = 0;
  this._flashObject = null;
  this.adLoadStartTime = null;
  this.adPlayStartTime = null;
  this.adReportedLengthMs = null;
  this.finishedTimerLengthMs = null;
  this.oldCallInternal = null;
  this.vpaidEventHandlersInstalled = null;
  this.attempts = 0;
}).prototype = new FramePlayer(null, null, null, {}, {});
AdFramePlayer.prototype.constructor = AdFramePlayer;
AdFramePlayer.prototype.frameLoaded = function frameLoaded() {
  FramePlayer.prototype.frameLoaded.call(this);
  this.frame.contentWindow.synap_adframe_timeouts = {};
  if (this.audioMode === "malamute") {
    this.playerConfig.plugins.malamute.enterframe = true;
  }
  this.playerConfig.controls = this.version === '6.9' || this.version === '6.10'; // JWP bug with black screen during ad when controls not enabled for ad

  this.playerConfig.advertising = {
    client: this.client,
    schedule: {
      postroll: {
        offset: "post",
        tag: this.getTag()
      }
    }
  };
  this.initJWP();

  var that = this;

  this.addEventHandler("onMute", function(e){jwp_setmute(!user_interacted || e.mute);});

  this.addEventHandler("onAdImpression", function(e) {
    if (that.playerMode === "flash" && that.usingVPAID) return;
    that.impressionEvent(e);
  });
  this.addEventHandler("onVPAIDAdImpression", function(e) {
    that.impressionEvent(e);
  });
  this.addEventHandler("onAdPlay", function(e) {
    master_pause = false;
    state_set("adplay-" + that.id);
    track_throttled("adplay", {"adtag_id": that.id});
    that._muteState ? that.mute(true) : that.unmute(true);
    if (browser_type.safari) { // handle safari power saver
      this._progressTimeout = window.setTimeout(function() {
        if (that.jwp("getState") === null) {
          track_throttled("powersaverad", {"adtag_id": that.id});
          that.clearTimeouts("all");
        }
      }, 3000);
    }
    if (that.playerMode === "html5" && that.playerConfig.advertising.client === "vast") {
      var frames = that.frame.contentWindow.document.getElementsByTagName("iframe");
      for (var i=0;i<frames.length;i++) {
        try {
          if (frames[i].contentWindow.getVPAIDAd && frames[i].contentWindow.getVPAIDAd()) {
            that.usingVPAID = true;
            break;
          }
        } catch (e) {}
      }
    }
  });
  this.addEventHandler("onAdPause", function(e) {
    // Sometimes ads weirdly call this. They also pause when in the background tab on JWP 7.2+.
    if ((!that._hasImpression || !user_interacted) && (version_compare(that.version, "7.2.0") < 0 || jwp_hasfocus())) return; 
    that.clearTimeouts("all");
    master_pause = true;
    state_set("adpause-" + that.id);
    track_throttled("adpause", {"adtag_id": that.id});
  });
  this.addEventHandler("onAdError", function(e) {
    debug_report("onAdError: " + that.id + " instance " + (that.instance || 0));
    that.clearTimeouts("all");
	that._hasImpression = false;
    if (ads_handlestate && ads_handlestate("error", that)) {
      track_throttled("aderror", {"adtag_id": that.id, "message": e.message});
    }
	that.finishAd();
  });
  this.addEventHandler("onAdComplete", function(e) {
    debug_report("onAdComplete: " + that.id + " instance " + (that.instance || 0));
    that.clearTimeouts("all");
    if (!that._hasImpression) {
      track_throttled("adstop", {"adtag_id": that.id, "message": e.message});
    } else {
      that._hasImpression = false;
      if (ads_handlestate && ads_handlestate("complete", that)) {
        track_throttled("adplaytime", {"adtag_id": that.id, "duration_ms": that.adPlayStartTime ? Math.floor(timestamp() - that.adPlayStartTime) : "unknown", "reported_ms": that.adReportedLengthMs ? Math.floor(that.adReportedLengthMs) : "unknown"});
      }
    }
    that.finishAd();
  });

  this.addEventHandler("onReady", function(e) {
    debug_report("onReady1: " + that.id + " instance " + (that.instance || 0));
    if ("flash" === (version_compare(that.version, '7.0.0') >= 0 ? (that.jwp('getProvider') ? that.jwp('getProvider').name : 'unknown') : that.jwp('getRenderingMode'))) {
      that._flashObject = that.frame.contentWindow.document.getElementsByTagName("object")[0];

      if (version_compare(that.version, '7.0.0') < 0 && that.frame.contentWindow.jwplayer && that.frame.contentWindow.jwplayer.vast && that.frame.contentWindow.jwplayer.vast.adplayer) {
        // Old JWP6 always uses only the first media object in the VAST XML. We need to ensure the first is "application/x-shockwave-flash"
        var old_object = that.frame.contentWindow.jwplayer.vast.adplayer;
        that.frame.contentWindow.jwplayer.vast.adplayer = function synadplayer() {
          var args = Array.prototype.slice.call(arguments);
          if (args[0] && args[0].adBuffet) {
            var vast_info = args[0].adBuffet();
            var new_media = [];
            for (var i=0;i<vast_info.length;i++) {
              if (vast_info[i].media && vast_info[i].media.length > 1) {
                vast_info[i].media.sort(function (a,b) {
                  return (a.type && a.type === "application/x-shockwave-flash") ? -1 : (a.type && a.type === "application/javascript") ? 1 : 0;
                });
              }
            }
            args[0].adBuffet = function() { return vast_info; };
          }
          return old_object.prototype.constructor.apply(this, args);
        };
        that.frame.contentWindow.jwplayer.utils.extend(that.frame.contentWindow.jwplayer.vast.adplayer, old_object);
      }
    }
  });

  if (this.client.toLowerCase() === 'vast') {
    if (browser_type.ie || browser_type.edge) return; // TODO: Anti-shim still leaks badly in IE.

    // JWPlayer 6 hacks
    this.oldCallInternal = this.jwp().callInternal;
    this.vpaidEventHandlersInstalled = {};
    var new_call_internal = function new_call_internal() {
      var res = null;
      try {
        var arguments_copy = Array.prototype.slice.call(arguments);
        if (arguments_copy[0]
         && arguments_copy[0] === 'jwAddVPAIDListener'
         && arguments_copy[1]
         && (arguments_copy[1] === 'AdLoaded' || arguments_copy[1] === 'AdStarted')
         && !that.vpaidEventHandlersInstalled[arguments_copy[1]]) {
          that.vpaidEventHandlersInstalled[arguments_copy[1]] = true;
          var orig_event = arguments_copy[1];
          var orig_method = arguments_copy[2];
          that.addEventHandler("onVPAID" + orig_event, function() {
            try {
              if (orig_method.match(/^jwplayer\._\['[A-Za-z0-9_\-']+\]\['_vpaidBridge[0-9]+'\]$/)) {
                var method = eval('window.ad_players["' + that.instance + '"].frame.contentWindow.' + orig_method);
                track_throttled("vpaid" + orig_event.toLowerCase(),  {"adtag_id": that.id});
                method.apply(window, [orig_event]);
              }
            } catch(e) {}
          });
          arguments_copy[2] = 'window.parent.ad_players["' + (0 + that.instance) + '"].fireVPAIDEvent';
        }
        if (arguments_copy[0] &&
            arguments_copy[0] === 'jwCallVPAID' &&
            arguments_copy[1]) {
            if (arguments_copy[1] === 'initAd' || arguments_copy[1] === 'startAd') track_throttled("vpaid" + arguments_copy[1].toLowerCase(), {"adtag_id": that.id});

            // Note, JWPlayer 6 only supports one jwAddVPAIDListener per event. However, AdImpression isn't registered yet, so we can do this.
            if (arguments_copy[1] === 'initAd') that.oldCallInternal.apply(this, ['jwAddVPAIDListener', 'AdImpression', 'window.parent.ad_players["' + (0 + that.instance) + '"].fireVPAIDEvent']);
        }

        res = that.oldCallInternal.apply(this, arguments_copy);

        if (arguments_copy[0] && arguments_copy[0] === 'jwCallVPAID') {
          that.usingVPAID = true;
          if (arguments_copy[1] && arguments_copy[1] === 'stopAd' && that._hasImpression) {
            that._cleanupTimeout = window.setTimeout(function() {
              that.fireEventHandler("onAdComplete", {message: "Forced stop"});
              track_throttled("adforcestop", {"adtag_id": that.id});
            }, 2000); // force cleanup within 2s
          }
        }
      } catch (e) {}
      return res;
    };
    this.jwp().callInternal = new_call_internal;
  }
};
AdFramePlayer.prototype.fireVPAIDEvent = function fireVPAIDEvent(event) {
  this.fireEventHandler("onVPAID" + event);
};
AdFramePlayer.prototype.getTag = function getTag() {
  var size_class = this.width <= 300
                     ? "small"
                     : (this.width >= 480 ? "large" : "medium");

  if (this.id.match(/^adaptv(_|$)/)) {
    size_class = this.width <= 350
                     ? "small"
                     : (this.width >= 500 ? "large" : "medium");
  }

  if (this.id.match(/^spotxchange(_|$)/)) {
    size_class = this.width <= 300
                     ? "small"
                     : (this.width > 600 ? "large" : "medium");
  }

  if (this.id.match(/^tremor(_|$)/)) {
    size_class = this.width <= 400
                     ? "small"
                     : (this.width >= 600 ? "large" : "medium");
  }

  var tag = typeof this.tag === "object"
           ? (this.tag[size_class] ? this.tag[size_class] : this.tag["default"])
           : this.tag;
  if (this.id.match(/^spotxchange_/) && this.playerMode === 'html5' && version_compare(this.version, "7.0.0") >= 0) {
    tag = tag.replace(/VPAID=1/, 'VPAID=js');
  }
  return (tag.match(/^\/\//) ? protocol_get() : "") + tag;
};
AdFramePlayer.prototype.clearTimeouts = function clearTimeouts(type) {
  if ((type === "progress" || type === "all") && this._progressTimeout !== null) {
    window.clearTimeout(this._progressTimeout);
    this._progressTimeout = null;
  }
  if ((type === "cleanup" || type === "all") && this._cleanupTimeout !== null) {
    window.clearTimeout(this._cleanupTimeout);
    this._cleanupTimeout = null;
  }
  if ((type === "loading" || type === "all") && this._loadingTimeout !== null) {
    window.clearTimeout(this._loadingTimeout);
    this._loadingTimeout = null;
  }
  if ((type === "playing" || type === "all") && this._playingTimeout !== null) {
    window.clearTimeout(this._playingTimeout);
    this._playingTimeout = null;
  }
  if ((type === "finished" || type === "all") && this._finishedTimeout !== null) {
    window.clearTimeout(this._finishedTimeout);
    this._finishedTimeout = null;
  }
};
AdFramePlayer.prototype.clearForeignTimeouts = function clearForeignTimeouts() {
  debug_report("clearForeignTimeouts");
  if (!this.frame || !this.frame.contentWindow.synap_adframe_timeouts) return;
  for (var method in this.frame.contentWindow.synap_adframe_timeouts) {
    for (var timeout in this.frame.contentWindow.synap_adframe_timeouts[method]) {
      debug_report("clearing foreign timeout: " + method + " #" + timeout);
      this.frame.contentWindow.synap_adframe_timeouts[method][timeout]['clear' + method].call(this.frame.contentWindow.synap_adframe_timeouts[method][timeout], timeout);
    }
  }
  delete this.frame.contentWindow.synap_adframe_timeouts
};
AdFramePlayer.prototype.startLoadingTimer = function startLoadingTimer() {
  if (!this.maxSecondsLoading || this._loadingTimeout !== null) return;
  var that = this;
  this._startedAt = timestamp();
  this._loadingTimeout = window.setTimeout(function(){
    that.stopAd();
    if (ads_handlestate && ads_handlestate("loadTimeout", that)) {
      track_throttled("adloadtimealarm", {"adtag_id": that.id, "duration_ms": Math.floor(that.maxSecondsLoading * 1000)});
    }
  }, this.maxSecondsLoading * 1000);
};
AdFramePlayer.prototype.startPlayingTimer = function startPlayingTimer() {
  if (!this.maxSecondsLoading || this._playingTimeout !== null) return;
  var that = this;

  this._playingTimeout = window.setTimeout(function(){
    that.stopAd();
    if (ads_handlestate && ads_handlestate("loadTimeout", that)) {
      track_throttled("adstarttimealarm", {"adtag_id": that.id, "duration_ms": Math.floor(that.maxSecondsLoading * 1000)});
    }
  }, (5 + this.maxSecondsLoading) * 1000 - (timestamp() - this._startedAt)); // Add 5s to the remainder of the loading time.
};
AdFramePlayer.prototype.startFinishedTimer = function startFinishedTimer(duration) {
  if (!this.maxSecondsPlaying || this._finishedTimeout !== null) return;
  if (duration <= 0) duration = 15;
  this.finishedTimerLengthMs = Math.ceil((this.maxSecondsPlaying.match && this.maxSecondsPlaying.match(/^r\+\d+$/)) ? (duration < 0 ? 1 : duration) + parseInt(this.maxSecondsPlaying.substr(2), 10) : parseInt(this.maxSecondsPlaying, 10));
  var that = this;
  this._finishedTimeout = window.setTimeout(function(){
    that.stopAd();
    if (ads_handlestate && ads_handlestate("playTimeout", that)) {
      track_throttled("adplaytimealarm", {"adtag_id": that.id, "duration_ms": that.finishedTimerLengthMs || "unknown"})
    }
  }, this.finishedTimerLengthMs * 1000);
};
AdFramePlayer.prototype.tearDown = function tearDown() {
  this.clearTimeouts("all");
  this._flashObject = null;
  this.usingVPAID = this.busy = this.initted = false;
  this.attempts = 0;
  if (this.oldCallInternal) {
    this.jwp().callInternal = this.oldCallInternal;
    this.oldCallInternal = null;
  }
  this.vpaidEventHandlersInstalled = null;
  FramePlayer.prototype.tearDown.call(this);
};
AdFramePlayer.prototype.impressionEvent = function impressionEvent(e) {
  this._hasImpression = true;
  this.clearTimeouts("loading");
  this.startPlayingTimer();
  this.show();
  this.adPlayStartTime = timestamp();
  if (ads_handlestate && ads_handlestate("impression", this)) {
    state_set("impression-" + this.id);
    track_throttled("impression", {"adtag_id": this.id});
    track_throttled("adloadtime", {"adtag_id": this.id, "duration_ms": this.adLoadStartTime ? Math.floor(timestamp() - this.adLoadStartTime) : "unknown"});
  } else {
    track_throttled("lateimpression", {"adtag_id": this.id});
  }
};
AdFramePlayer.prototype.playAd = function playAd(playlistItem, maxSecondsLoading, maxSecondsPlaying) {
  this.attempts++;
  this.usingVPAID = false;
  this.busy = true;
  this.maxSecondsLoading = maxSecondsLoading;
  this.maxSecondsPlaying = maxSecondsPlaying;
  this.adPlayStartTime = this.adReportedLengthMs = null;
  this.adLoadStartTime = timestamp();

  // Tremor throttling ... no more than 4 per minute, per user.
  if (this.id.match(/^tremor(_|$)/)) {
    if (this._throttleWindowStart === null || timestamp() - this._throttleWindowStart > 60000) {
      this._throttleWindowStart = timestamp();
      this._throttleWindowCount = 0;
    }
    this._throttleWindowCount++;
    if (this._throttleWindowCount > 4) {
      track_throttled("throttlead", {"adtag_id": this.id});
      this.fireEventHandler("onAdError", {"message": "throttled"});
      return;
    }
  }

  var newFile = {};
  for (var key in playlistItem) {
    if (key !== "media") newFile[key] = playlistItem[key];
  }
  // Fetch largest bitrate asset for reporting purposes.
  newFile.srcurl = mediafile_fetchbitrate(playlistItem, 10000).sources[0] || this.playerConfig.file;
  newFile.realduration = "" + (playlistItem.duration || 60); // default to 60s if no duration present; must be coerced to string to work
  newFile.playerwidth = "" + container_clientWidth();
  newFile.playerheight = "" + container_clientHeight();
  newFile.file = this.playerConfig.file;
  newFile.type = this.playerConfig.type;
  newFile.image = newFile.image || protocol_get() + "//synacor.autoplay-plugins.static-origin.syn-cdn.com/images/pixel.gif"; //prevent jwplayer 6.8-6.12 bug which requests the current page several times if no image is given

  this.startLoadingTimer();
  var that = this;

  this.addEventHandler("onAdTime", function(e) {
    that.clearTimeouts("playing");
    that.startFinishedTimer(e.duration);
    that.adReportedLengthMs = e.duration * 1000;
    track_throttled("adreportedtime", {"adtag_id": that.id, "duration_ms": that.adReportedLengthMs ? Math.floor(that.adReportedLengthMs) : "unknown"});
  }, {fireOnce: true});
  this.addEventHandler("onPlaylist", function(e) {
    window.setTimeout(function() {that.jwp("play", [true]);}, 1); // Cannot be called from within callback thread.
  }, {fireOnce: true});
  this.jwp("load", [[newFile]]);
  return true;
};

AdFramePlayer.prototype.stopAd = function stopAd() {
  debug_report("stopAd: " + this.id + " instance " + (this.instance || 0));
  this.busy = false;
  var did_stop = false;
  if (this.usingVPAID) {
    if (version_compare(this.version, '7.0.0') < 0) {
      this.jwp().callInternal("jwCallVPAID", "stopAd");
      did_stop = true;
    } else {
      if (this._flashObject && this._flashObject.triggerFlash) {
        this._flashObject.triggerFlash("vast:callVpaid", "stopAd");
        did_stop = true;
      } else {
        var frames = this.frame.contentWindow.document.getElementsByTagName("iframe");
        for (var i=0;i<frames.length;i++) {
          try {
            if (frames[i].contentWindow.getVPAIDAd) {
              frames[i].contentWindow.getVPAIDAd().stopAd();
              did_stop = true;
              break;
            }
          } catch (e) {}
        }
      }
    }
  }
  this.finishAd();
}
AdFramePlayer.prototype.finishAd = function finishAd() {
  debug_report("finishAd: " + this.id + " instance " + (this.instance || 0));
  this.hide();
  this.clearTimeouts("all");
  this.clearForeignTimeouts();
  if ((this.busy && !this.usingVPAID)
    || ((!cfg.player_reload_attempts || (cfg.player_reload_attempts >= 0 && this.attempts >= cfg.player_reload_attempts)) && !(browser_type.chrome && !jwp_hasfocus()))) {
    this.reload();
  } else {
    this.busy = this.usingVPAID = false;
  }
}

function frame_neuter(frame) {
  try {
    var frame_window = frame.contentWindow;
    frame.contentWindow.alert   = function(msg) { if (console && console.info) console.info("window.alert: " + msg); }
    frame.contentWindow.prompt  = function(msg) { if (console && console.info) console.info("window.prompt: " + msg); return null; }
    frame.contentWindow.confirm = function(msg) { if (console && console.info) console.info("window.confirm: " + msg); return false; }
    delete frame.contentWindow.Element.prototype.scrollIntoView;

    timeouts_override(frame.contentWindow, "Timeout");
    timeouts_override(frame.contentWindow, "Interval");

    if (MutationObserver) {
      var observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          if (mutation.addedNodes) {
            for(var i=0;i<mutation.addedNodes.length;i++) {
              if (mutation.addedNodes[i].nodeName.toUpperCase() === 'IFRAME') {
                var new_frame = mutation.addedNodes[i];
                // Fix bad OVV version from advertisers by moving the JS into an actual <script> tag
                // This normally produces a flood a "document.body" is undefined and "ad1 is null"
                // errors in the console otherwise.
                if (new_frame.id.match(/^OVVFrame_(.+)$/) && new_frame.src.match(/^javascript:/)) {
                  var bad_js = decodeURIComponent(new_frame.src.replace(/^javascript:/, ''));
                  new_frame.src = "";
                  var content =
                    '<!DOCTYPE html>' +
                    '<html>' +
                    '  <body>' +
                    '  <script type="text/javascript">' + bad_js + '</scr' + 'ipt>' +
                    '  </body>' +
                    '</html>';
                  new_frame.contentWindow.document.open();
                  new_frame.contentWindow.document.write(content);
                  new_frame.contentWindow.document.close();
                }
                var closure_cleanup = function closure_cleanup() {
                  frame_neuter(new_frame);
                  listener_remove(new_frame, "load", closure_cleanup);
                  closure_cleanup = new_frame = mutations = bad_js = null;
                };
                listener_attach(new_frame, "load", closure_cleanup);
              }
            }
          }
        });
      });
      observer.observe(frame_window.document.body, { childList: true, subTree: true });
      var closure_cleanup = function closure_cleanup() {
        observer.disconnect();
        listener_remove(frame_window, "unload", closure_cleanup);
        closure_cleanup = observer = frame = frame_window = mutations = null;
      };
      listener_attach(frame_window, "unload", closure_cleanup);
    }
    for (var prop in frame_window.console) {
      if (frame_window.console[prop] && typeof frame_window.console[prop] === 'function') {
        var old_method = frame_window.console[prop];
        frame_window.console[prop] = function() {
          if (debug) {
            var args = Array.prototype.slice.call(arguments);
            return old_method.apply(this, args);
          }
        }
      }
    }
  } catch (e) {}
}


function players_create() {
  jwp_resize();
  window.setInterval(jwp_resize, 5000);

  var player_finished = function player_finished(e){
    var player_id = this.id || "content";
    track_throttled("ready", {"player_id": player_id});

    // Fired by Malamute stage clicks from "clickcallback".
    // This fires on almost every click... including inside most interactive ads.
    // This also seems to fire every time onDisplayClick normally fires.
    this.addEventHandler("onStageClick", function(e){
      track_always("click", {"player_id": player_id});
      user_interaction_event();
    });

    // Fired by JWPlayer stage clicks of the actual clip (not an ad). Typically when
    // a click would normally toggle a play/pause state.
    this.addEventHandler("onDisplayClick", function(e){user_interaction_event();});

    if (players_remaining > 0) {
      players_remaining--;
      jwp_init();
    }
  };

  var content_player_finished = function content_player_finished(e) {
    this.addEventHandler("onPlay",   function(e){state_set("playing");});
    this.addEventHandler("onPause",  function(e){state_set("paused");});
    this.addEventHandler("onBuffer", function(e){state_set("buffering");});
    this.addEventHandler("onIdle",   function(e){state_set("idle");});
    player_finished.call(this);
  };

  var setup_error = function setup_error(type, e){
    track_throttled(type, e);
  };

  if (!autoplay && playlist.length < 1) playlist_build();

  content_player = new ContentFramePlayer(
    cfg.jwpversion,
    container_clientWidth(),
    container_clientHeight(),
    {
      audioMode: cfg.audio_mode,
      muted: audiomode_starts_muted[cfg.audio_mode],
      autoPlay: false,
      loop: false
    },
    {
      image: autoplay ? protocol_get() + "//synacor.autoplay-plugins.static-origin.syn-cdn.com/images/pixel.gif" : playlist[0].thumbnail,
      plugins: {
        malamute: {
          clickcallback: 'window.parent.content_player.fireEventHandler'
        }
      }
    }
  );
  content_player.setUp(document.getElementById("playerContainer"), content_player_finished, setup_error);
  players_remaining++;

  var all_tags = {};
  var default_tag_frequency = {};
  var large_tag_frequency = {};
  for (var i=0;i<cfg.ad_tags.length;i++) {
    all_tags[cfg.ad_tags[i].id] = {client: cfg.ad_tags[i].client, url: cfg.ad_tags[i].url};
    default_tag_frequency[cfg.ad_tags[i].id] = default_tag_frequency[cfg.ad_tags[i].id] || 0;
    default_tag_frequency[cfg.ad_tags[i].id]++;
  }
  for (var i=0;i<cfg.large_ad_tags.length;i++) {
    all_tags[cfg.large_ad_tags[i].id] = {client: cfg.large_ad_tags[i].client, url: cfg.large_ad_tags[i].url};
    large_tag_frequency[cfg.large_ad_tags[i].id] = large_tag_frequency[cfg.large_ad_tags[i].id] || 0;
    large_tag_frequency[cfg.large_ad_tags[i].id]++;
  }

  var tag_names = [];
  for (var id in all_tags) {
    var max_frequency = Math.max(default_tag_frequency[id] || 0, large_tag_frequency[id] || 0);
    for (var i=0;i<max_frequency;i++) tag_names.push(id);
  }

  // Sort adaptv first so their player doesn't get made smaller.
  tag_names.sort(function (a,b) {
    return a.match(/^adaptv(_|$)/) ? -1 : b.match(/^adaptv(_|$)/) ? 1 : a < b ? -1 : a > b ? 1 : 0;
  });
  for (var i=0;i<tag_names.length;i++) {
    var tag = tag_names[i];
    ad_players.push(new AdFramePlayer(
      cfg.jwpversion,
      container_clientWidth(),
      container_clientHeight(),
      {
        audioMode: cfg.audio_mode,
        muted: audiomode_starts_muted[cfg.audio_mode],
        autoPlay: false,
        loop: false
      },
      {
        plugins: {
          malamute: {
            clickcallback: 'window.parent.ad_players['+ad_players.length+'].fireEventHandler'
          }
        }
      },
      all_tags[tag].client,
      all_tags[tag].url,
      tag,
      ad_players.length
    ));
    players_remaining++;
    ad_players[ad_players.length - 1].setUp(document.getElementById("playerContainer"), player_finished, setup_error);
  }
  jwp_init();
}

function jwp_init() {
  debug_report("jwp_init");
  if (jwp_inited || vam_jsonp_failsafe) return;
  if (playlist.length < 1) playlist_build();
  if (!content_player || !content_player.ready) {
    return;
  }

  if (jwp_inited) return; // check once more before continuing to be safe
  jwp_inited = true;

  player_mode = content_player.playerMode;

  loadingcover_hide();

  if (autoplay) {
    tracking_fire("start");
    track_throttled("firstcontent");
  }

  if (cfg.show_nowplaying) {
    nowplaying_container_create();
  }

  if (cfg.replace_dcc && !dcc_handler_installed) {
    dcc_install_replacement_handler();
    dcc_handler_installed = true;
  }

  ad_spots_remaining = playlist[current_playlist_item].pre_ads;

  if (autoplay) {
    has_started = true;
    ads_start();
  } else {
    content_player.addEventHandler("onReady", function(e) {
      debug_report("onReady3");
      loadingcover_hide();
      content_player.setControls(true);
      content_player.show();
    }, {fireOnce: true});

    var action, target, action_name, delay_timeout = null;
    if (cfg.autoplay_mode === 'onfocus' || cfg.autoplay_mode === 'inviewport') {
      try {
        target = window.top;
        action_name = cfg.autoplay_mode === 'onfocus' ? 'focus' : 'scroll';
        action = function() {
          if (cfg.autoplay_mode === 'inviewport' && !jwp_isinviewport(0.5)) return;
          track_throttled((cfg.autoplay_mode === 'onfocus' ? 'focus' : 'inviewport') + 'play');
          content_player.jwp("play", [true]);
        };
        listener_attach(target, action_name, action);
      } catch (e) {}
    } else if (!cookie_get("synapm") && cfg.autoplay_mode === 'delayed' && cfg.autoplay_mode_delay && parseInt(cfg.autoplay_mode_delay, 10) > 0) {
      delay_timeout = window.setTimeout(function () {
        content_player.jwp("play", [true]);
      }, parseInt(cfg.autoplay_mode_delay, 10) * 1000);
    }
    content_player.addEventHandler("onComplete", function(e) {
      if (cfg.autoplay_mode === 'onfocus' || cfg.autoplay_mode === 'inviewport') {
        listener_remove(target, action_name, action);
      }
      if (delay_timeout !== null) {
        window.clearTimeout(delay_timeout);
        delay_timeout = null;
      }
      tracking_fire("start");
      track_throttled("firstcontent");
      has_started = true;
      ads_start();
    }, {fireOnce: true});
  }
}

function adbreak_timer_install() {
  if (disable_ads) return;
  var timer = cfg.timed_ad_break_secs;
  if (timer <= 0) return;
  if (cfg.background_ads
      && !user_interacted
      && (
           (!cfg.background_only_viewable && (jwp_hasoldfocus() === false || jwp_isinviewport(0) === false))
           || (cfg.background_only_viewable && jwp_hasoldfocus() === false && jwp_hasfocus() && jwp_isinviewport(0.5))
         )
      ) {
    timer = 1;
    background_ad = true;
  }
  if (adbreak_timer_timeout === null) {
    adbreak_timer_timeout = window.setTimeout(adbreak_fire, timer * 1000);
  }
}

function adbreak_timer_remove() {
  if (adbreak_timer_timeout) {
    window.clearTimeout(adbreak_timer_timeout);
    adbreak_timer_timeout = null;
  }
}

function adbreak_timer_resetall_if_fired() {
  // Handles the condition where the adbreak timer fired, the ads are loading, and the
  // user pauses the content or the content ends and a playlist break happens. In those
  // conditions we need to kill the adplayers so they don't take over.
  if (!ad_playing_mutex && ad_playing_break_type === 'midroll' && adbreak_timer_timeout === null) {
    ads_resetall(null, "adbreak_timer_resetall_if_fired");
    ad_loading_mutex = false;
    ad_playing_break_type = null;
  }
}

function adbreak_fire() {
  debug_report("adbreak_fire");
  adbreak_timer_timeout = null;
  ad_playing_break_type = 'midroll';
  ad_spots_remaining = 100; // Keep attempting ads until one plays.
  ads_start();
}

function ads_handlestate(state, adplayer) {
  debug_report("ads_handlestate: " + state + " - " + adplayer.id  + " instance " + (adplayer.instance || 0));
  switch (state) {
    case "loadTimeout":
    case "error":
      ads_after();
    break;
    case "impression":
      if (ad_playing_mutex) {
        debug_report("stopping ad player: " + adplayer.id + " instance " + (adplayer.instance || 0));
        adplayer.stopAd();
        return false; // discard event
      }
      ad_playing_mutex = true;
      ads_resetall(adplayer, "impression");
      if (cfg.ad_scheduling === "simultaneous") current_ad_chain = [];
      adplayer.show();
      if (ad_playing_break_type === "midroll") {
        content_player.pause(true);
        content_player.hide();
      }
      loadingcover_hide();
      adloadsplash_hide();
      staticad_hide();
      nowplaying_show();
    break;
    case "playTimeout":
    case "complete":
      ad_playing_mutex = false;
      current_ad_chain = [];
      ads_after();
    break;
  };
  return true; // return true when event is not discarded
}

function ads_start() {
  debug_report("ads_start");

  if (ads_start_time && timestamp() - ads_start_time <= min_adslot_time_secs * 1000) {
    debug_report("ads_start: waiting");
    ads_start_timeout = window.setTimeout(function () {ads_start_timeout = null;ads_start()}, (min_adslot_time_secs * 1000) - (timestamp() - ads_start_time));
    return;
  }
  ads_start_time = null;

  // For JWP7
  if (version_compare(ad_players[0].version, "7.0.0") >= 0 && browser_type.chrome && !jwp_hasfocus()) {
    if (focus_wait) return;
    focus_wait = true;
    track_throttled("focuswait", "ads_start");
    var focuswait_method;
    focuswait_method = function () {
      track_throttled("focusgain", "ads_start");
      listener_remove(document, "visibilitychange", focuswait_method);
      ads_start();
    }
    listener_attach(document, "visibilitychange", focuswait_method);
    return;
  }

  adbreak_timer_remove();
  if (master_pause || ads_start_retry_timeout !== null) return;
  if (ad_loading_mutex) {
    debug_report("ads_start: ad_loading_mutex");
    if (!ad_playing_mutex) {
      adloadsplash_show();
      nowplaying_hide();
      staticad_show();
    }
    return;
  }
  var one_ready = false;
  for (var i=0;i<ad_players.length;i++) {
    if (ad_players[i].ready) {
      one_ready = true;
    } else if (ad_players[i].failed) {
      ad_players[i].reload();
    }
  }
  debug_report("ads_start: one_ready - " + (one_ready ? "true" : "false"));

  if (!one_ready) {
    ads_start_retry_timeout = window.setTimeout(function () {ads_start_retry_timeout = null;ads_start();}, 1000);
    return;
  }
  if (disable_ads || ad_spots_remaining < 1) jwp_resumeitem(current_playlist_item);
  if (ad_playing_break_type === null) ad_playing_break_type = 'playlist';
  if (current_ad_chain.length < 1 && ad_spots_remaining > 0) {
    var ad_tags = cfg.ad_tags;
    // NOTE: be aware that not all ad networks start large at 480px, but we have to just pick a size for everyone.
    if (content_player.width >= 480 && cfg.large_ad_tags.length > 0) ad_tags = cfg.large_ad_tags;

    for (var i=0;i<ad_tags.length;i++) {
      current_ad_chain.push(ad_tags[i]);
    }
  }

  track_throttled("adslot");
  ad_loading_mutex = true;
  ads_resetall(null, "ads_start");
  ads_start_time = timestamp();
  if (cfg.ad_scheduling === "sequential") {
    ad_load(current_ad_chain.shift(), skip_chaining);
  } else if (cfg.ad_scheduling === "simultaneous") {
    if (simultaneous_ad_loader_timeout !== null) { // just in case we're called before the last timeline finishes.
      window.clearTimeout(simultaneous_ad_loader_timeout);
      simultaneous_ad_loader_timeout = null;
    }
    ads_simultaneous_loader(current_ad_chain.slice(), 0, 0);
  }
}

function ads_simultaneous_loader(ads, current_tick, total_ticks) {
  debug_report("ads_simultaneous_loader: current_tick - " + current_tick + "; total_ticks: " + total_ticks);
  if (ad_playing_mutex || simultaneous_ad_loader_timeout !== null) return;
  var currently_busy = false;
  var next_tick_with_action = null;
  var final_tick = null;
  for (var i=0;i<ads.length;i++) {
    if (ads[i].b === current_tick) {
      ad_load(ads[i], null);
      currently_busy = true;
    }
    if (ads[i].b > current_tick &&
        (next_tick_with_action === null || ads[i].b < next_tick_with_action)) {
      next_tick_with_action = ads[i].b;
    }
    if (final_tick === null ||
        final_tick < ads[i].b + ads[i].t) {
      final_tick = ads[i].b + ads[i].t;
    }
  }
  if (current_tick === final_tick || final_tick === null || current_ad_chain.length < 1) {
    track_throttled("adtimelineend", {"total_ticks": total_ticks});
    ad_spots_remaining--;
    ads_finish();
    return;
  }
  if (!currently_busy) {
    for (var i=0;i<ad_players.length;i++) {
      if (ad_players[i].busy) {
        currently_busy = true;
        break;
      }
    }
  }
  var next_tick = current_tick + 1;
  if (!currently_busy) {
    if (next_tick_with_action !== null) {
      next_tick = next_tick_with_action;
    } else {
      track_throttled("adtimelineend", {"total_ticks": total_ticks});
      ad_spots_remaining--;
      ads_finish();
      return;
    }
  }
  simultaneous_ad_loader_timeout = window.setTimeout(function () {simultaneous_ad_loader_timeout = null;ads_simultaneous_loader(ads, next_tick, total_ticks + 1);}, 1000);
}

function ad_load(ad, should_skip_chaining) {
  if (!ad || ad_playing_mutex) return;
  if (ad_playing_break_type !== "midroll") {
    adloadsplash_show();
    nowplaying_hide();
    staticad_show();
  }
  var attempt_count = 0;

  var attempt_function = function() {
    attempt_count++;
    var available_players = ads_getplayersbytagid(ad.id);

    if (master_pause) return;
    var state = content_player.jwp("getState");
    if (ad_playing_break_type !== "midroll" && state && state.toUpperCase() === "PLAYING") return; // Threading issue: Sometimes this is called after the content_player starts playing back.
    if (ad_spots_remaining === 0) return; // Fires if the user clicks a playlist item.

    var ad_player = null;
    for (var i=0;i<available_players.length;i++) {
      if (ad_players[available_players[i]].failed) {
        ad_player.reload();
        continue;
      }
      if (ad_players[available_players[i]].ready && !ad_players[available_players[i]].busy) {
        ad_player = ad_players[available_players[i]];
        break;
      }
    }
    if (ad_player === null && attempt_count > 10) { // Gives up to 10 attempts before stopping
      ads_after();
      return;
    } else if (ad_player === null || !ad_player.ready) {
      retry_timeouts.push(window.setTimeout(attempt_function, 1000)); // poll until the ad player is ready
      return;
    }
    // If we're here, we have a player and will attempt playing. Now is when we check if we should play.
    if (!adprovider_canplay(ad)) {
      ads_after();
      return;
    }
    state_set("attempt-" + ad.id);
    track_throttled("attempt", {"adtag_id": ad.id});
    ad_player.playAd(playlist[current_playlist_item], should_skip_chaining ? cfg.firstadloadtimer_maxsecs : ad.t, cfg.adplaytimer_maxsecs);
  };
  window.setTimeout(attempt_function, 1);
  return;
}

function ads_getplayersbytagid(tag) {
  var matches = [];
  for (var i=0;i<ad_players.length;i++) {
    if (ad_players[i].id === tag) matches.push(i);
  }
  return matches;
}

function ads_resetall(keep, caller) {
  debug_report("ads_resetall: " + caller);
  while (retry_timeouts.length) {
    window.clearTimeout(retry_timeouts.pop());
  }
  if (ads_start_timeout !== null) {
    window.clearTimeout(ads_start_timeout);
    ads_start_timeout = null;
  }
  if (ads_start_retry_timeout !== null) {
    window.clearTimeout(ads_start_retry_timeout);
    ads_start_retry_timeout = null;
  }
  if (simultaneous_ad_loader_timeout !== null) {
    window.clearTimeout(simultaneous_ad_loader_timeout);
    simultaneous_ad_loader_timeout = null;
  }
  for (var i=0;i<ad_players.length;i++) {
    if (ad_players[i] === keep) continue;
    if (ad_players[i].busy) {
      ad_players[i].stopAd();
      track_throttled("adreload", {"adtag_id": ad_players[i].id, "caller": caller});
    } else {
      ad_players[i].hide();
    }
  }
}

function ads_after() {
  debug_report("ads_after");

  if (cfg.ad_scheduling === "sequential") {
    skip_chaining = false;
    if (current_ad_chain.length > 0) {
      ad_load(current_ad_chain.shift(), skip_chaining);
      return;
    }
  } else if (cfg.ad_scheduling === "simultaneous" && current_ad_chain.length > 0) {
    current_ad_chain.shift(); // we don't care which one, we only use it to manage the count
    return;
  }
  if (current_ad_chain.length > 0) return;
  ad_spots_remaining--;
  ads_finish();
}

function ads_finish() {
  debug_report("ads_finish");

  ads_resetall(null, "ads_finish");
  background_ad = false;
  ad_loading_mutex = false;
  ad_playing_mutex = false;
  current_ad_chain = [];
  if (ad_playing_break_type === 'midroll') {
    adbreak_timer_install();
    ad_spots_remaining = 0;
    ad_playing_break_type = null;
  } else if (cfg.background_ads
             && !user_interacted
             && ad_spots_remaining < 1
             && (
                  (!cfg.background_only_viewable && (jwp_hasoldfocus() === false || jwp_isinviewport(0) === false))
                  || (cfg.background_only_viewable && jwp_hasoldfocus() === false && jwp_hasfocus() && jwp_isinviewport(0.5))
                )
             ) {
    background_ad = true;
    ad_spots_remaining++;
  }
  if (ad_spots_remaining > 0) {
    ads_start();
    return;
  }
  jwp_resumeitem(current_playlist_item);
}

function adprovider_canplay(provider) {
  var can_play = (!provider['if'] || jwp_hasfocus())  // NOTE: IE8 parse error accessing property named "if" via dot: "provider.if"
              && (!provider['iv'] || jwp_isinviewport(0.5))
              && (!provider['of'] || jwp_hasoldfocus())
              && (!provider['av']  || jwp_isaceviewable(0.5));
  if (can_play || ((!background_ad || cfg.background_run_restricts) && Math.random() * 100 < provider.c)) {
    return true;
  }
  track_throttled("skipad", {"adtag_id": provider.id});
  return false;
}

function content_start(e) {
  master_pause = false;
  adbreak_timer_install();
  content_player.show();
  loadingcover_hide();
  adloadsplash_hide();
  staticad_hide();
  nowplaying_show();
  if (e.oldstate === "PAUSED") {
    nowplaying_setpause(false);
  }
  if (cfg.seen_at_end && playlist[current_playlist_item].id) {
    var cookie = cookie_get("synapms");
    var seen_arr = cookie ? cookie.split(/,/) : [];
    var found = false;
    for (var i=0;i<seen_arr.length;i++) {
      if (playlist[current_playlist_item].id === seen_arr[i]) {
        found = true;
        break;
      }
    }
    if (!found) {
      cookie_set("synapms", (cookie ? cookie + "," : "") + playlist[current_playlist_item].id, 120);
    }
  }
}

function content_pause(e) {
  adbreak_timer_resetall_if_fired();
  adbreak_timer_remove();
  nowplaying_setpause(true);
  master_pause = true;
}

function content_after(e) {
  debug_report("content_after");

  current_playlist_item++;
  ad_spots_remaining = Math.max(0, ad_spots_remaining) + playlist[mod(current_playlist_item, playlist.length)].pre_ads;
  if (ad_loading_mutex && ad_spots_remaining > 0) ad_spots_remaining--; // We're playing midroll, don't double-up ads.
  if (current_playlist_item >= playlist.length) {
    current_playlist_item = 0;
    if (!cfg.loop_mode) {
      loadingcover_hide();
      adloadsplash_hide();
      staticad_hide();
      nowplaying_show();
      content_player.playerConfig.image = playlist[0].thumbnail;
      content_player.reload(); //TODO: Do I need this?
      content_player.setControls(true);
      content_player.show();
      window.setTimeout(function() { // set as a timeout because we're executing in the onComplete handler now and will get cleaned up after this function ends. TODO: handle this better.
        content_player.addEventHandler("onComplete", function(e) {
          ad_playing_break_type = 'playlist';
          ads_start();
        }, {fireOnce: true});
      }, 2000);
      return;
    }
  }
  ads_start();
}

function loadingcover_show() {
  var loading_cover = document.getElementById("loadingCover");
  if (!loading_cover) {
    loading_cover = document.createElement("div");
    loading_cover.id = "loadingCover";
    var loading_text = document.createElement("h1");
    loading_text.appendChild(document.createTextNode("Loading\u2026"));
    loading_cover.appendChild(loading_text);
    document.getElementById("playerContainer").appendChild(loading_cover);
  }
}

function loadingcover_hide() {
  var loading_cover = document.getElementById("loadingCover");
  if (loading_cover) loading_cover.parentNode.removeChild(loading_cover);
}

function nowplaying_container_create() {
  if (document.getElementById("nowPlayingContainer")) return;
  var nowplaying_container = document.createElement("div");
  nowplaying_container.style.width = (container_clientWidth() - 72) + "px";
  nowplaying_container.id = "nowPlayingContainer";
  var background = document.createElement("div");
  background.id = "nowPlayingBackground";
  nowplaying_container.appendChild(background);

  var player_container = document.getElementById("playerContainer");
  player_container.appendChild(nowplaying_container);
}

function nowplaying_show() {
  if (!cfg.show_nowplaying) return;

  nowplaying_hide();

  if (document.getElementById("nowPlayingDiv")) {
    document.getElementById("nowPlayingDiv").parentNode.removeChild(document.getElementById("nowPlayingDiv"));
  }
  if (document.getElementById("upNextDiv")) {
    document.getElementById("upNextDiv").parentNode.removeChild(document.getElementById("upNextDiv"));
  }

  var container = document.getElementById("nowPlayingContainer");

  var nowplaying = document.createElement("div");
  nowplaying.id = "nowPlayingDiv";

  var controls = document.createElement("div");
  controls.id = "nowPlayingControls";

  var is_ad = ad_spots_remaining > 0;

  if (!is_ad) {
    if (cfg.show_navbuttons) {
      var prev = document.createElement("a");
      prev.id = "prevVideo";
      prev.className = "icon iconPrevious";
      prev.onclick = function() {
        skip_ad = true;
        jwp_playitem(current_playlist_item - 1);
        user_interaction_event();
        track_always("back");
      }
      controls.appendChild(prev);

      var counter = document.createElement("span");
      counter.className = "counter";
      counter.appendChild(document.createTextNode((current_playlist_item + 1) + " of " + playlist.length));
      controls.appendChild(counter);

      var next = document.createElement("a");
      next.id = "nextVideo";
      next.className = "icon iconNext";
      next.onclick = function() {
        skip_ad = true;
        jwp_playitem(current_playlist_item + 1);
        user_interaction_event();
        track_always("fwd");
      }
      controls.appendChild(next);
    }
    var pause = document.createElement("a");
    pause.id = "pauseVideo";
    pause.className = "icon icon" + (content_player.isPaused() ? "Play" : "Pause");
    pause.onclick = function() {
      var is_paused = content_player.isPaused();
      pause.className = "icon icon" + (!is_paused ? "Play" : "Pause");
      user_interaction_event();
      content_player.pause(!is_paused);
      track_always("pause", {"event_state": is_paused ? "play" : "pause"});
    };
    controls.appendChild(pause);
  }

  var unmute = document.createElement("a");
  unmute.id = "unmuteVideo";
  unmute.className = "icon icon" + (jwp_ismuted() ? "Mute" : "Unmute");
  unmute.onclick = function() {
    var is_muted = jwp_ismuted();
    unmute.className = "icon icon" + (is_muted ? "Mute" : "Unmute");
    user_interaction_event();
    jwp_setmute(!is_muted);
    track_always("mutebtn", {"event_state": is_muted ? "unmute" : "mute"});
  };
  controls.appendChild(unmute);

  if (!is_ad) {
    if (cfg.dcc_bitrate === "maintain") {
      var hd = document.createElement("a");
      hd.className = "icon iconHD" + (content_player.isHd ? " active" : "");
      hd.onclick = function() {
        content_player.toggleHd();
        content_player.setBitrate(jwp_getidealbitrate());
        hd.className = "icon iconHD" + (content_player.isHd ? " active" : "");
        user_interaction_event();
        track_always("hd", {"event_state": content_player.isHd ? "on" : "off"});
      };
      controls.appendChild(hd);
    }
  }
  nowplaying.appendChild(controls);

  var title = document.createElement("h1");
  title.appendChild(document.createTextNode(is_ad ? (cfg.ad_text ? "ADVERTISEMENT" : ad_playing_break_type === 'midroll' ? "SHORTLY" : "NEXT") : "NOW PLAYING"));
  nowplaying.appendChild(title);

  if (!cfg.ad_text) {
    var asset = document.createElement("span");
    asset.className = "title";
    asset.appendChild(document.createTextNode(playlist[current_playlist_item].title));
    nowplaying.appendChild(asset);
  }

  container.appendChild(nowplaying);

  var upnext = document.createElement("div");
  upnext.id = "upNextDiv";

  var upnexttitle = document.createElement("h1");
  upnexttitle.appendChild(document.createTextNode("NEXT"));
  upnext.appendChild(upnexttitle);

  var next_item = current_playlist_item+1;
  if (next_item >= playlist.length) {
    next_item = cfg.loop_mode ? 0 : null;
  }
  if (next_item !== null) {
    var upnextdesc = document.createElement("span");
    upnextdesc.className = "title";
    upnextdesc.appendChild(document.createTextNode(playlist[next_item].title));
    upnext.appendChild(upnextdesc);
  }

  container.appendChild(upnext);
  nowplaying_resize();
  container.style.visibility = 'visible';
  window.setTimeout(nowplaying_resize, 1); // have to do this again so getBoundingClientRect() calculates properly
}

function nowplaying_hide() {
  if (!cfg.show_nowplaying) return;
  var container = document.getElementById("nowPlayingContainer");
  if (container) container.style.visibility = 'hidden';
}

function nowplaying_resize() {
  if (!cfg.show_nowplaying) return;
  var nowplaying = document.getElementById("nowPlayingContainer");
  var upnext = document.getElementById("upNextDiv");

  var nowplaying_background = document.getElementById("nowPlayingBackground");
  if (nowplaying && nowplaying_background) {
    var window_height = container_clientHeight();
    var window_width = container_clientWidth();
    var new_height = window_height - (ad_spots_remaining > 0 ? container_clientHeight() : content_player.getHeight());
    new_height = Math.max(29, new_height);
    if (new_height > 29) {
      nowplaying.style.width = container_clientWidth() + "px";
      if (!nowplaying.className.match(/(?:^| )expanded(?= |$)/)) nowplaying.className += (nowplaying.className.length ? " " : "") + "expanded";
    } else {
      nowplaying.style.width = container_clientWidth() + "px";
      nowplaying.className = nowplaying.className.replace(/(?:^| )expanded(?= |$)/, '');
    }
    if (window_width / window_height >= 1.22) {
      if (!nowplaying.className.match(/(?:^| )compact(?= |$)/)) nowplaying.className += (nowplaying.className.length ? " " : "") + "compact";
    } else {
      nowplaying.className = nowplaying.className.replace(/(?:^| )compact(?= |$)/, '');
    }

    if (upnext && upnext.getBoundingClientRect && upnext.getBoundingClientRect().bottom > container_clientHeight()) {
      upnext.style.visibility = "hidden";
    } else if (upnext && upnext.getBoundingClientRect && upnext.getBoundingClientRect().bottom) {
      upnext.style.visibility = "visible";
    }

    nowplaying.style.height = nowplaying_background.style.height = new_height + "px";
    nowplaying.style.top = (window_height - new_height) + "px";
  }
}

function nowplaying_setpause(isPaused) {
  if (!cfg.show_nowplaying) return;
  var pause_control = document.getElementById("pauseVideo");
  if (pause_control) pause_control.className = "control icon icon" + (isPaused ? "Play" : "Pause");
}

function staticad_create() {
  debug_report("staticad_create");
  if (!cfg.static_ad_tag) return;
  if (staticad_player !== null) staticad_destroy();
  staticad_player = new StaticAdFrame(container_clientWidth(), container_clientHeight());
  staticad_player.setContent(cfg.static_ad_tag);
  staticad_player.setUp(document.getElementById("playerContainer"));

  var staticAdModal = document.getElementById("staticAdModal");
  if (!staticAdModal && container_clientWidth() > 300 && container_clientHeight() > 250) {
    staticAdModal = document.createElement("div");
    staticAdModal.id = "staticAdModal";
    var staticAdLoading = document.createElement("h1");
    staticAdLoading.appendChild(document.createTextNode("Loading\u2026"));
    staticAdModal.appendChild(staticAdLoading);
    var container = document.getElementById("playerContainer");
    if (container) {
      staticAdModal.style.width = container.style.width;
      staticAdModal.style.height = container.style.height;
    }
    document.body.appendChild(staticAdModal);
  }
  staticad_refresh();
}

function staticad_destroy() {
  debug_report("staticad_destroy");
  if (staticad_refresh_timeout !== null) window.clearTimeout(staticad_refresh_timeout);
  if (staticad_player !== null) {
    staticad_player.tearDown();
    staticad_player = null;
  }
  var staticAdModal = document.getElementById("staticAdModal");
  if (staticAdModal) staticAdModal.parentNode.removeChild(staticAdModal);
}

function staticad_show() {
  debug_report("staticad_show");
  if (!cfg.static_ad_tag) return;
  if (!cfg.static_ad_in_dcc && dcc_mode) return;
  if (!show_static_ad) return;
  if (disable_ads) return;
  if (staticad_player === null) staticad_create();
  staticad_player.show();
  var staticAdModal = document.getElementById("staticAdModal");
  if (staticAdModal) staticAdModal.style.visibility = "visible";
}

function staticad_hide() {
  debug_report("staticad_hide");
  if (staticad_player !== null) {
    staticad_player.hide();
  }
  var staticAdModal = document.getElementById("staticAdModal");
  if (staticAdModal) staticAdModal.style.visibility = "hidden";
}

function staticad_refresh() {
  debug_report("staticad_refresh");
  if (staticad_player === null) return;
  if (staticad_refresh_timeout !== null) window.clearTimeout(staticad_refresh_timeout);
  if ((!cfg.static_ad_visible_secs || staticad_player.getVisibleTime() >= cfg.static_ad_visible_secs * 1000) &&
      (!cfg.static_ad_rotation_secs || staticad_player.getRotationTime() >= cfg.static_ad_rotation_secs * 1000)) {
    staticad_player.reload();
  }
  var next_check = Math.max(1000, (cfg.static_ad_visible_secs || 1) * 1000 - staticad_player.getVisibleTime(), (cfg.static_ad_rotation_secs || 1) * 1000 - staticad_player.getRotationTime());
  staticad_refresh_timeout = window.setTimeout(staticad_refresh, next_check);
}

function adloadsplash_show() {
  if (cfg.adload_splash == "comingup" || cfg.show_comingup) {
    comingup_show();
  } else if (cfg.adload_splash == "assetpreview") {
    assetpreview_show();
  }
}

function adloadsplash_hide() {
  if (cfg.adload_splash == "comingup" || cfg.show_comingup) {
   comingup_hide();
  } else if (cfg.adload_splash == "assetpreview") {
    assetpreview_hide();
  }
}

function comingup_show() {
  debug_report("comingup_show");
  if (document.getElementById("comingUpPlaylist")) return;

  var comingupDiv = document.createElement("div");
  comingupDiv.id = "comingUpPlaylist";

  var title = document.createElement("h1");
  title.appendChild(document.createTextNode("COMING UP"));
  comingupDiv.appendChild(title);

  // How many items to show in the playlist
  var show_comingup_items = 8;
  if (typeof p_item !== "number" || p_item < 0) p_item = 0;

  for (var i=0; i<show_comingup_items; i++) {
    // This is in case we want to show the previous items, increment this variable
    var show_previous = 0;
    var playlist_item = (i + current_playlist_item - show_previous) % playlist.length;

    if ((!cfg.loop_mode || playlist.length < show_comingup_items) && (i + current_playlist_item - show_previous) / playlist.length >= 1) {
      break;
    }

    if (playlist_item < 0) {
      if (cfg.loop_mode && playlist.length >= show_comingup_items) {
        playlist_item %= playlist.length;
      } else {
        continue;
      }
    }

    var asset = document.createElement("h3");
    asset.className = "thumbnails";
    var thumbnail = document.createElement("img");
    thumbnail.src = playlist[playlist_item].thumbnail;
    thumbnail.alt = "";
    thumbnail.className = "comingupThumbnail";
    var thumbnail_playicon = document.createElement("div");
    thumbnail_playicon.className = "comingupThumbnailPlayIcon";
    thumbnail_playicon.appendChild(document.createTextNode("\u27A2"));
    var thumbnail_center = document.createElement("div");
    thumbnail_center.className = "comingupThumbnailCenter";
    thumbnail_center.appendChild(thumbnail);
    thumbnail_center.appendChild(thumbnail_playicon);
    var thumbnail_container = document.createElement("div");
    thumbnail_container.className = "comingupThumbnailContainer";
    thumbnail_container.appendChild(thumbnail_center);
    asset.appendChild(thumbnail_container);

    var asset_title = document.createElement("span");
    asset_title.appendChild(document.createTextNode(playlist[playlist_item].title));
    asset.appendChild(asset_title);
    if (playlist_item === current_playlist_item) {
      asset.className += (asset.className === "" ? "" : " ") + "active";
    }

    var asset_anchor = document.createElement("a");
    asset_anchor.style.cursor = "pointer";
    asset_anchor.onclick = function () {
      var active_element = 0;
      var elements = document.getElementById("comingUpPlaylist").getElementsByTagName("a");
      for (var j=0; j<elements.length; j++) {
        if (elements[j] === this) active_element = j;
      }
      loadingcover_show();
      adloadsplash_hide();
      jwp_playitem(active_element + current_playlist_item);
      user_interaction_event();
      track_always("comingup", {"event_state": active_element});
    };
    asset_anchor.appendChild(asset);
    comingupDiv.appendChild(asset_anchor);
  }

  var gradientDiv = document.createElement("div");
  gradientDiv.id = "comingupGradient";
  comingupDiv.appendChild(gradientDiv);

  var container = document.getElementById("playerContainer");
  container.appendChild(comingupDiv);
}

function comingup_hide() {
  debug_report("comingup_hide");
  var comingupDiv = document.getElementById("comingUpPlaylist");
  if (comingupDiv) comingupDiv.parentNode.removeChild(comingupDiv);
}

function assetpreview_show() {
  debug_report("assetpreview_show");
  if (document.getElementById("assetPreview")) return;

  var assetPreviewDiv = document.createElement("div");
  assetPreviewDiv.id = "assetPreview";
  assetPreviewDiv.style.backgroundImage = "url(" + playlist[current_playlist_item].thumbnail + ")";

  var assetPreviewDimmer = document.createElement("div");
  assetPreviewDimmer.className = "dimmer";

  var assetPreviewText = document.createElement("div");
  assetPreviewText.className = "assetPreviewText";

  var header = document.createElement("h1");
  header.appendChild(document.createTextNode("COMING UP"));
  assetPreviewText.appendChild(header);

  var assetTitle = document.createElement("h2");
  assetTitle.appendChild(document.createTextNode(playlist[current_playlist_item].title));
  assetPreviewText.appendChild(assetTitle);

  var watchNowIcon = document.createElement("span");
  watchNowIcon.className = "watchNowIcon";
  watchNowIcon.appendChild(document.createTextNode("\u27A2"));

  var watchNowAnchor = document.createElement("a");
  watchNowAnchor.style.cursor = "pointer";
  watchNowAnchor.onclick = function () {
    loadingcover_show();
    adloadsplash_hide();
    jwp_playitem(current_playlist_item);
    user_interaction_event();
    track_always("watchnow");
  };

  watchNowAnchor.appendChild(watchNowIcon);
  watchNowAnchor.appendChild(document.createTextNode("Watch Now"));

  var watchNow = document.createElement("h3");
  watchNow.appendChild(watchNowAnchor);

  assetPreviewText.appendChild(watchNow);
  assetPreviewDimmer.appendChild(assetPreviewText);
  assetPreviewDiv.appendChild(assetPreviewDimmer);
  document.getElementById("playerContainer").appendChild(assetPreviewDiv);
}

function assetpreview_hide() {
  debug_report("assetpreview_hide");
  var assetPreviewDiv = document.getElementById("assetPreview");
  if (assetPreviewDiv) assetPreviewDiv.parentNode.removeChild(assetPreviewDiv);
}

function playlist_build() {
  var playlists_remaining_in_tail = 0;
  for (var vamid in cfg.playlists) {

    var seen_obj = {};
    if (cfg.seen_at_end && cookie_get("synapms")) {
      var seen_arr = cookie_get("synapms").split(/,/);
      for (var i=0;i<seen_arr.length;i++) {
        seen_obj[seen_arr[i]] = true;
      }
      var playlist_unseen = [];
      var playlist_seen = [];
      for (var i=0;i<cfg.playlists[vamid].length;i++) {
        if (cfg.playlists[vamid][i].id && seen_obj[cfg.playlists[vamid][i].id]) {
          playlist_seen.push(cfg.playlists[vamid][i]);
        } else {
          playlist_unseen.push(cfg.playlists[vamid][i]);
        }
      }
      if (playlist_unseen.length > 0) playlist_order[cfg.order_mode](playlist_unseen);
      if (playlist_seen.length > 0)   playlist_order[cfg.order_mode](playlist_seen);
      cfg.playlists[vamid] = playlist_unseen;
      for (var i=0;i<playlist_seen.length;i++) {
        cfg.playlists[vamid].push(playlist_seen[i]);
      }
    } else {
      playlist_order[cfg.order_mode](cfg.playlists[vamid]);
    }

    for (var i=cfg.playlists[vamid].length-1; i>=0; i--) {
      for (var j=cfg.playlists[vamid][i].media.length-1; j>=0; j--) {
        if (cfg.restricted_content[vamid] && cfg.restricted_content[vamid][cfg.playlists[vamid][i].id]) continue;
        if (cfg.playlists[vamid][i].media[j].file.match(streamurl_strip_prefix) === null ||
            cfg.playlists[vamid][i].media[j].file.match(streamurl_strip_suffix) === null) {
          // this isn't a recognized url format and we won't be able to make it canonical. remove it from the list.
          cfg.playlists[vamid][i].media.splice(j, 1);
        }

        var canonical_stream_url = cfg.playlists[vamid][i].media[j].file.replace(streamurl_strip_prefix, "").replace(streamurl_strip_suffix, "");
        delete cfg.playlists[vamid][i].media[j].file;

        var stream_url = streamurl_build[cfg.streamsource](canonical_stream_url);
        var backup_stream_url = streamurl_build['edgecast_mp4'](canonical_stream_url);
        cfg.playlists[vamid][i].media[j].sources = [
          {"file": stream_url + (stream_url.match(/\?/) ? "&" : "?") + "origin=" + encodeURIComponent(origin)},
          {"file": backup_stream_url + (backup_stream_url.match(/\?/) ? "&" : "?") + "origin=" + encodeURIComponent(origin)}
        ];
      }
      if (cfg.playlists[vamid][i].media.length < 1) {
        cfg.playlists[vamid].splice(i, 1);
        continue;
      }

      cfg.playlists[vamid][i].vamid = vamid;

      if (vamid in title_build) cfg.playlists[vamid][i].title = title_build[vamid](cfg.playlists[vamid][i].title);

      if (cfg.playlists[vamid][i].image && cfg.playlists[vamid][i].image.match(thumbnailurl_strip_prefix) !== null) {
        var canonical_thumbnail_url = cfg.playlists[vamid][i].image.replace(thumbnailurl_strip_prefix, "");
        var thumbnail_url = thumbnailurl_build[cfg.streamsource](canonical_thumbnail_url);
        cfg.playlists[vamid][i].thumbnail = thumbnail_url;
      }

      if (autoplay) {
        delete cfg.playlists[vamid][i].image;
      }
    }
    if (cfg.playlists[vamid].length > 0 && playlist_spec_in_tail(vamid)) playlists_remaining_in_tail++;
  }

  playlist = [];

  var i=0;
  var remaining_ad_count = 0;
  while ((i<tail_start || playlists_remaining_in_tail > 0) && playlist_spec[i] && cfg.playlists[playlist_spec[i]]) {
    if (cfg.playlists[playlist_spec[i]].length > 0) {
      var asset = cfg.playlists[playlist_spec[i]].shift();
      asset.pre_ads = remaining_ad_count + pre_ads[i];
      playlist.push(asset);
      if (cfg.playlists[playlist_spec[i]].length === 0 && playlist_spec_in_tail(playlist_spec[i])) playlists_remaining_in_tail--;
    }
    remaining_ad_count = 0;
    if (++i >= playlist_spec.length) {
      if (pre_ads[i]) remaining_ad_count += pre_ads[i]; // handle ads at the end of the tail
      if (playlist_spec.length === tail_start) break; // No tail
      i = tail_start; // Yes tail, rewind to tail start
    }
  }
  if (cfg.seen_at_end && seen_obj ) {
    var clean_seen = []
    for (var i=0;i<playlist.length;i++) {
      if (playlist[i].id && seen_obj[playlist[i].id]) {
        clean_seen.push(playlist[i].id);
      }
    }
    if (clean_seen.length > 0) {
      cookie_set("synapms", clean_seen.join(","), 120);
    } else {
      cookie_set("synapms", "deleted", -1);
    }
  }
}

function playlist_spec_in_tail(spec) {
  for (var i=0; i<cfg.tail.length; i++) {
    if (cfg.tail[i] === spec) {
      return true;
    }
  }
  return false;
}

function playlist_reorder(first_item) {
  var new_playlist = [];
  var playlist_length = playlist.length;
  for (var i=0; i<playlist_length; i++) {
    new_playlist.push(playlist[(i+first_item) % playlist_length]);
  }
  playlist = new_playlist;
}

function mediafile_fetchbitrate(playlist_item, desired_bitrate) {
  var medias = playlist_item.media;
  for (var j = 0; j < medias.length; j++) {
    if (medias[j].bitrate < 1) medias[j].bitrate = bitrate_limit_kbps + 1;
  }
  medias.sort(function (a, b) { return a.bitrate - b.bitrate });
  var chosen_media;
  for (var j = 0; j < medias.length; j++) {
    chosen_media = medias[j];
    if (medias[j].bitrate >= desired_bitrate) {
      break;
    }
  }
  return chosen_media;
}

function user_interaction_event() {
  if (!user_interacted) {
    try {
      var test_window = window;
      while (test_window) {
        if (test_window.Pandora && test_window.Pandora.pauseMusic) {
          test_window.Pandora.pauseMusic(true);
          break;
        }
        if (test_window === window.top) break;
        test_window = test_window.parent;
      }
    } catch (e) {}
    user_interacted = true;
    jwp_setmute(false);
    if (!("adfree_interaction" in cfg) || cfg.adfree_interaction) {
      disable_ads = true;
      staticad_destroy();
      adbreak_timer_remove();
      // Kill any ad loading if nothing is yet playing.
      if (!ad_playing_mutex) {
        ads_resetall(null, "user_interaction_event");
        jwp_resumeitem(current_playlist_item);
      }
    }
  }
}

function jwp_location(version) {
  var root = "http" + (protocol_get() === "https:" ? "s://ssl." : "://") + "p.jwpcdn.com/";
  var path = version_compare(version, "7.0.0") >= 0 ? "player/v/" + version : version.replace(/\./, "/");
  return root + path + "/jwplayer.js";
}

function jwp_resumeitem(i) {
  debug_report("jwp_resumeitem: " + i);
  if (!content_player.ready) return jwp_playitem(i);
  if (!content_player.isPaused()) return;
  if (current_playlist_item === loaded_playlist_item && content_player.ready) {
    var dur = content_player.getDuration();
    var pos = content_player.getPosition();
    if (pos > 0 && pos < dur && content_player.isPaused()) {
      content_player.pause(false);
      return;
    }
  }
  jwp_playitem(i);
}

function jwp_playitem(i) {
  debug_report("jwp_playitem: " + i);

  // For JWP7
  if (version_compare(content_player.version, "7.0.0") >= 0 && browser_type.chrome && !jwp_hasfocus()) {
    if (focus_wait) return;
    focus_wait = true;
    track_throttled("focuswait", "jwp_playitem");
    var focuswait_method;
    focuswait_method = function () {
      track_throttled("focusgain", "jwp_playitem");
      listener_remove(document, "visibilitychange", focuswait_method);
      jwp_playitem(i);
    }
    listener_attach(document, "visibilitychange", focuswait_method);
    return;
  }

  i = mod(i, playlist.length);
  ad_spots_remaining = 0;
  current_ad_chain = [];
  adbreak_timer_remove();
  ads_resetall(null, "jwp_playitem");
  ad_playing_mutex = ad_loading_mutex = false;
  ad_playing_break_type = null;

  loaded_playlist_item = current_playlist_item = i;
  var attempt_function = function() {
    if (!content_player.ready) { // poll until player is ready
      window.setTimeout(attempt_function, 1000);
      return;
    }

    content_player.removeEventHandlers({perClip: true});
    content_player.addEventHandler("onPlay",     content_start, {perClip: true});
    content_player.addEventHandler("onPause",    content_pause, {perClip: true});
    content_player.addEventHandler("onComplete", content_after, {perClip: true});
    content_player.play(playlist[i], 0, jwp_getidealbitrate(), true);
    attempt_function = attempt_timeout = null;
  };
  attempt_timeout = window.setTimeout(attempt_function, 1);
}

function jwp_getidealbitrate() {
  if (saved_dcc_bitrate === null) saved_dcc_bitrate = content_player.currentBitrate;
  if (!content_player.isHd && cfg.replace_dcc && dcc_mode && cfg.dcc_bitrate !== "auto") {
    if (cfg.dcc_bitrate === "maintain") {
      return saved_dcc_bitrate;
    }
    return cfg.dcc_bitrate;
  }
  if (!cfg.resize_bitrate) return cfg.minimum_bitrate;

  var bitrate = bitrate_limit_kbps;
  var container_width = (content_player && content_player.width) || container_clientWidth();
  if (container_width <= 300) {
    bitrate = 100;
  } else if (container_width <= 480) {
    bitrate = 150;
  } else if (container_width <= 768) {
    bitrate = 200;
  }
  if (content_player && content_player.isHd) bitrate = Math.max(201, bitrate);
  return Math.max(bitrate, cfg.minimum_bitrate);
}

function jwp_resize() {
  fractionalposition_fix();

  var container = document.getElementById("playerContainer");

  var width = (cfg.fill_window || dcc_mode) ? window_innerWidth(window)  : 300;
  var height = (cfg.fill_window || dcc_mode) ? window_innerHeight(window) : 250;

  if (width == 0 || height == 0) {
    width = Math.max(width, 300);
    height = Math.max(height, 250);
  }
  container.style.width  = width + "px";
  container.style.height = height + "px";

  var staticAdModal = document.getElementById("staticAdModal");
  if (staticAdModal) {
    staticAdModal.style.width = container.style.width;
    staticAdModal.style.height = container.style.height;
  }

  for (var i=0;i<ad_players.length;i++) ad_players[i].resize(width, height);
  if (content_player && playlist[current_playlist_item]) {
    content_player.resize(width, cfg.show_nowplaying && playlist[current_playlist_item].aspect ? Math.min(Math.round(width / playlist[current_playlist_item].aspect), height) : height);
    content_player.setBitrate(jwp_getidealbitrate());
  }
  show_static_ad = !cfg.static_ad_size_match || (width <= 300 && height <= 250);
  if (staticad_player !== null) {
    if (!show_static_ad) {
      staticad_destroy();
    } else {
      staticad_player.resize(width, height);
    }
  }
  nowplaying_resize();
}

function jwp_setmute(is_muting) {
  if (is_muting) {
    content_player.mute(false);
    for (var i=0;i<ad_players.length;i++) {
      ad_players[i].mute(false);
    }
  } else {
    content_player.unmute(false);
    content_player.setControls(true);
    for (var i=0;i<ad_players.length;i++) {
      ad_players[i].unmute(false);
    }
    if (!unmute_logged) {
      unmute_logged = true;
      // if we've never unmuted before, log exactly once
      track_always("unmute"); //always, even with log throttle disabled otherwise
    }
  }
  var unmute_control = document.getElementById("unmuteVideo");
  if (unmute_control) unmute_control.className = "control icon icon" + (is_muting ? "Mute" : "Unmute");

}

function jwp_ismuted() {
  return content_player.isMuted();
}

function jwp_hasfocus() {
  // Page Visibility API
  var pageVisibilityProperty = null;
  if (typeof document.hidden !== "undefined") {
    pageVisibilityProperty = "hidden";
  } else if (typeof document.mozHidden !== "undefined") {
    pageVisibilityProperty = "mozHidden";
  } else if (typeof document.msHidden !== "undefined") {
    pageVisibilityProperty = "msHidden";
  } else if (typeof document.webkitHidden !== "undefined") {
    pageVisibilityProperty = "webkitHidden";
  }
  if (pageVisibilityProperty) return !document[pageVisibilityProperty];
  return jwp_hasoldfocus();
}

function jwp_hasoldfocus() {
  // Page Visibility API not supported
  var has_focus = false;
  try {
    window.top.document;
  } catch(e) {
    return window.document.hasFocus() || null;
  }
  iterate_selfandparents(window, function() {
    if (has_focus) return;
    if (this.document.hasFocus()) has_focus = true;
    for (var i=0;i<this.frames.length;i++) {
      try {
        if (this.frames[i].contentWindow.document.hasFocus()) {
          has_focus = true;
          break;
        }
      } catch(e) {}
    }
  });
  return has_focus;
}

function jwp_isinviewport(req_percent) {
  var frame_in_parent = null;
  var current_window = window;
  var visible_rect = {l: 0, t: 0, r: window.innerWidth || window.documentElement.clientWidth, b: window.innerHeight || window.documentElement.clientHeight};
  var visible_pixel_requirement = visible_rect.r * visible_rect.b * req_percent;

  var r, c;

  while (current_window !== window.top) {
    try {
      frame_in_parent = iframe_findfromwindow(current_window);
      if (frame_in_parent === null) return null;
      r = frame_in_parent.getBoundingClientRect();
      c = {
        w: current_window.parent.innerWidth  || current_window.parent.documentElement.clientWidth,
        h: current_window.parent.innerHeight || current_window.parent.documentElement.clientHeight
      };
    } catch (e) {
      try {
        if (current_window &&
            current_window['$sf'] &&
            current_window['$sf'].ext &&
            current_window['$sf'].ext.inViewPercentage) {
          return current_window['$sf'].ext.inViewPercentage() >= req_percent;
        } else {
          return null;
        }
      } catch (e) {
        return null;
      }
    }
    visible_rect.l = Math.max(Math.min(visible_rect.l + r.left, c.w), 0);
    visible_rect.t = Math.max(Math.min(visible_rect.t + r.top, c.h), 0);
    visible_rect.r = Math.max(Math.min(visible_rect.r + r.left, c.w, r.right), 0);
    visible_rect.b = Math.max(Math.min(visible_rect.b + r.top, c.h, r.bottom), 0);

    var onscreen_pixels = (visible_rect.r-visible_rect.l) * (visible_rect.b-visible_rect.t);
    if (onscreen_pixels < visible_pixel_requirement) return false;

    current_window = current_window.parent;
  }
  return true
}

function jwp_isaceviewable(req_percent) {
  var frame_in_parent = null;
  var current_window = window;
  var visible_rect = {l: 0, t: 0, r: window.innerWidth || window.documentElement.clientWidth, b: window.innerHeight || window.documentElement.clientHeight};
  var visible_pixel_requirement = visible_rect.r * visible_rect.b * req_percent;

  var r, c;

  while (current_window !== window.top) {
    try {
      frame_in_parent = iframe_findfromwindow(current_window);
      if (frame_in_parent === null) return null;
      r = frame_in_parent.getBoundingClientRect();
      c = {
        w: current_window.parent.innerWidth  || current_window.parent.documentElement.clientWidth,
        h: current_window.parent.innerHeight || current_window.parent.documentElement.clientHeight
      };
    } catch (e) {
      try {
        if (current_window &&
            current_window['$sf'] &&
            current_window['$sf'].ext &&
            current_window['$sf'].ext.inViewPercentage) {
          return current_window['$sf'].ext.inViewPercentage() >= req_percent;
        } else {
          return null;
        }
      } catch (e) {
        return null;
      }
    }
    visible_rect.l = Math.max(Math.min(visible_rect.l + r.left, c.w), 0);
    visible_rect.t = Math.max(Math.min(visible_rect.t + r.top, c.h), 0);
    visible_rect.r = Math.max(Math.min(visible_rect.r + r.left, c.w, r.right), 0);
    visible_rect.b = Math.max(Math.min(visible_rect.b + r.top, c.h, r.bottom), 0);

    var onscreen_pixels = (visible_rect.r-visible_rect.l) * (visible_rect.b-visible_rect.t);
    if (onscreen_pixels < visible_pixel_requirement) return false;
    var measurements_off_screen = 0;
    var max_measure_points = 500; // chosen arbitrarily
    var scan_tolerance = Math.max(1, Math.floor(Math.sqrt(onscreen_pixels/max_measure_points)));
    var measure_point = Math.floor(scan_tolerance/2); // measure from middle of square
    var inc_amount = Math.pow(scan_tolerance,2);
    for (var x=visible_rect.l,xm=x+measure_point; xm<visible_rect.r; x+=scan_tolerance,xm=x+measure_point) {
      for (var y=visible_rect.t,ym=y+measure_point; ym<visible_rect.b; y+=scan_tolerance,ym=y+measure_point) {
        if (current_window.parent.document.elementFromPoint(xm,ym) !== frame_in_parent) measurements_off_screen++;
      }
      if (1 - (measurements_off_screen / max_measure_points) < req_percent) return false;
    }
    current_window = current_window.parent;
  }
  return true;
}

function jwp_getcoordinates() {
  var frame_in_parent = null;
  var current_window = window;
  var rect = {l: 0, t: 0, r: window.innerWidth || window.documentElement.clientWidth, b: window.innerHeight || window.documentElement.clientHeight};

  var r, c;

  while (current_window !== current_window.top) {
    try {
      frame_in_parent = iframe_findfromwindow(current_window);
      if (frame_in_parent === null) return null;
      r = frame_in_parent.getBoundingClientRect();
      c = {
        w: current_window.parent.innerWidth  || current_window.parent.documentElement.clientWidth,
        h: current_window.parent.innerHeight || current_window.parent.documentElement.clientHeight
      };
    } catch (e) {
      return null;
    }
    rect.l = Math.max(rect.l + r.left, 0);
    rect.t = Math.max(rect.t + r.top, 0);
    rect.r = Math.max(rect.r + r.left, 0);
    rect.b = Math.max(rect.b + r.top, 0);

    current_window = current_window.parent;
  }
  return rect;
}

function jwp_browserdimensions() {
  try {
    return {"w": window_innerWidth(window.top), "h": window_innerHeight(window.top)};
  } catch (e) {}
  return null;
}

function jwp_gencallback(name, method) {
  var callback = function (e) {
    debug_report(name);
    try {
      method(e);
    } catch (e) {
      console.log("[" + (timestamp()/1000) + "] Error in JWP callback: " + name);
      console.log(e);
    }
  };
  var closure_cleanup = function() {
    closure_cleanup = callback = name = method = null;
  }
  return [callback, closure_cleanup];
}

function jwp_viewable_if_idle() {
  if (cfg.inactive_scroll_secs && parseInt(cfg.inactive_scroll_secs, 10) > 0
   && cfg.inactive_scroll_inview && parseInt(cfg.inactive_scroll_inview, 10) > 0) {
    var req_percent = Math.min(100, parseInt(cfg.inactive_scroll_inview, 10));
    var last_activity = timestamp();
    var was_code_scrolling = false;
    var track_activity = null, orig_scroll = null, current_scroll = null, inactivity_handler_interval = null, moving_timeout = null;
    var inactivity_handler = function () {

      // Check if idle
      if (timestamp() - last_activity < parseInt(cfg.inactive_scroll_secs, 10) * 1000) {
        if (moving_timeout !== null) {
          window.clearTimeout(moving_timeout);
          moving_timeout = null;
        }
        // We got activity, scroll back if we had scrolled.
        if (cfg.inactive_scroll_return && orig_scroll !== null) {
          window.top.scrollTo(orig_scroll.x, orig_scroll.y);
        }
        current_scroll = orig_scroll = null;
        return;
      }

      // We're actively scrolling
      if (current_scroll !== null) return;

      // If we're in viewport this code is irrelevant.
      if (jwp_isinviewport(req_percent / 100)) return;

      try {
        var url = window.top.location.href; // will security exception if x-domain
        var frame_in_parent = null;
        var current_window = window;
        do {
          frame_in_parent = iframe_findfromwindow(current_window);
          current_window = current_window.parent;
        } while (frame_in_parent !== null && current_window !== current_window.top);
        if (frame_in_parent !== null) {

          if (orig_scroll === null) orig_scroll = {"x": window.top.scrollX, "y": window.top.scrollY};
          if (current_scroll === null) current_scroll = {"x": window.top.scrollX, "y": window.top.scrollY};

          var move_till_visible = function () {
            moving_timeout = null;
            var location = frame_in_parent.getBoundingClientRect();

            var scroll_amounts = {
              "x1": location.left,
              "x2": location.right - window_innerWidth(window.top),
              "y1": location.top,
              "y2": location.bottom - window_innerHeight(window.top)
            };


            var scrollX_min = current_scroll.x <= window.top.scrollX ? scroll_amounts.x1 : scroll_amounts.x2,
                scrollY_min = current_scroll.y <= window.top.scrollY ? scroll_amounts.y1 : scroll_amounts.y2;

            var scrollX_inc = (scrollX_min < 0 ? -1 : 1) * Math.min(10, Math.abs(scrollX_min)),
                scrollY_inc = (scrollY_min < 0 ? -1 : 1) * Math.min(10, Math.abs(scrollY_min));

            if (!jwp_isaceviewable(req_percent / 100) && (scrollX_inc !== 0 || scrollY_inc !== 0)) {
              var prev_loc = {"x": window.top.scrollX, "y": window.top.scrollY};
              window.top.scrollBy(
                scrollX_inc,
                scrollY_inc
              );
              // Verify we actually scrolled somewhere before calling again to prevent loop from unscrollable ask.
              if (window.top.scrollX !== prev_loc.x || window.top.scrollY !== prev_loc.y) moving_timeout = window.setTimeout(move_till_visible, 10);
            } else {
              current_scroll = null;
            }
          }
          moving_timeout = window.setTimeout(move_till_visible, 10);  // waiting primarily to ensure DCC header changes.
        }
        track_activity = function() {
          last_activity = timestamp();
          inactivity_handler.call();
        }
        listener_attach(window.top, "mousemove", track_activity);//TODO: must remove on unload and closure-leak-proof
        listener_attach(window.top, "focus", track_activity);
        listener_attach(window.top, "visibilitychange", track_activity);
        listener_attach(window.top, "scroll", function () {
          if (moving_timeout === null) {
            orig_scroll = null;
            track_activity.call();
          }
        });
      } catch (e) {}
    };
    inactivity_handler_interval = window.setInterval(inactivity_handler, 1000);
  }
}

function masthead_height() {
  try {
    // gen4 vs gen2
    var masthead = window.top.document.getElementById("div-gpt-ad-masthead") || window.top.document.getElementById("div-gpt-ad-uppercut");
    return masthead.clientHeight;
  } catch (e) {}
  return null;
}

function clone_into_scope(to_clone, from_scope, dest_scope) {
  if (to_clone === null || typeof to_clone !== "object") return to_clone;
  if (to_clone.constructor === from_scope.String)   return new dest_scope.String(to_clone);
  if (to_clone.constructor === from_scope.Number)   return new dest_scope.Number(to_clone);
  if (to_clone.constructor === from_scope.Boolean)  return new dest_scope.Boolean(to_clone);
  if (to_clone.constructor === from_scope.Date)     return new dest_scope.Date(to_clone);
  if (to_clone.constructor === from_scope.RegExp)   return new dest_scope.RegExp(to_clone);
  if (to_clone.constructor === from_scope.Object) {
    var struct = new dest_scope.Object();
    for (var name in to_clone) struct[name] = clone_into_scope(to_clone[name], from_scope, dest_scope);
    return struct;
  }
  if (to_clone.constructor === from_scope.Array) {
    var arr = new dest_scope.Array();
    for (var i=0; i<to_clone.length; i++) arr[i] = clone_into_scope(to_clone[i], from_scope, dest_scope);
    return arr;
  }
  return to_clone;
}

function state_set(e) {
  debug_report("state_set - " + e);
  state = e;
  state_time = timestamp();
}

function tracking_fire(event) {
  var fired_pixels = {};
  var tags = [cfg.ad_tags, cfg.large_ad_tags];
  for (var j=0;j<tags.length;j++) {
    for (var i=tags[j].length - 1;i>=0;i--) {
      if (tags[j][i].tracking && tags[j][i].tracking[event] && !fired_pixels[tags[j][i].tracking[event]]) {
        track_pixel(tags[j][i].tracking[event]);
        fired_pixels[tags[j][i].tracking[event]] = true;
      }
    }
  }
}

function track_throttled(event,values) {
  if (debug) {
    if (console.group) {
      console.group("[" + (timestamp()/1000) + "] track_throttled - " + event);
      console.dir(values);
      console.groupEnd();
    } else {
      console.log("[" + (timestamp()/1000) + "] track_throttled - " + event);
      console.log(values);
    }
  }
  if (!should_adlog) return;
  track(event, cfg.logthrottle, values);
}

function track_always(event,values) {
  if (debug) {
    if (console.group) {
      console.group("[" + (timestamp()/1000) + "] track_always - " + event);
      console.dir(values);
      console.groupEnd();
    } else {
      console.log("[" + (timestamp()/1000) + "] track_always - " + event);
      console.log(values);
    }
  }
  track(event, 1, values);
}

function track(event,rate,values) {
  if (cfg.logurl === false) return;

  var url = (cfg.logurl || "//"+location.host+"/images/track/track.gif") + "?track=jwp-ad" +
    "&ts="     + encodeURIComponent(timestamp()) +
    "&rate="   + encodeURIComponent(rate) +
    "&event="  + encodeURIComponent(event) +
    "&iid="    + encodeURIComponent(instance_id) +
    "&origin=" + encodeURIComponent(origin) +
    "&size="   + encodeURIComponent(container_clientWidth() + "x" + container_clientHeight());

    if (url.match(/^\/\//)) url = protocol_get() + url;

    var window_dimensions = jwp_browserdimensions();
    if (window_dimensions !== null) url += "&window=" + encodeURIComponent(window_dimensions.w + "x" + window_dimensions.h);

  if (event === "init") {
    url += "&sfv="  + encodeURIComponent(navigator && navigator.plugins && navigator.plugins["Shockwave Flash"] ? navigator.plugins["Shockwave Flash"].version : "unknown");
  }
  if (event.match(/^(?:init|firstcontent|adslot|attempt|skipad|impression|unloadstate|dcc|vpaidinitad|vpaidstartad|vpaidadloaded|vpaidadstarted)$/)) {
    var mh = masthead_height();
    if (mh !== null) url += "&mh=" + encodeURIComponent(mh);
    var coords = jwp_getcoordinates();
    if (coords !== null) url += "&coords=" + encodeURIComponent(coords.l + "x" + coords.t);

    url += "&f="    + encodeURIComponent(jwp_hasfocus() ? "1" : "0");
    url += "&iv="   + encodeURIComponent(jwp_isinviewport(0.5) ? "1" : "0");
    url += "&of="    + encodeURIComponent(jwp_hasoldfocus() ? "1" : "0");
    if (log_aceview) url += "&av="    + encodeURIComponent(jwp_isaceviewable(0.5) ? "1" : "0");
  }
  if (event.match(/^(?:adslot|attempt|impression|aderror|adloadtime|adloadtimealarm|vpaidinitad|vpaidstartad|vpaidadloaded|vpaidadstarted)$/)) {
    url += "&ad_scheduling=" + encodeURIComponent(cfg.ad_scheduling);
    url += "&ba=" + encodeURIComponent(background_ad ? "1" : "0");
  }
  if (event.match(/^(?:firstcontent|adslot|attempt|impression|aderror)$/)) {
    url += "&mode=" + encodeURIComponent(player_mode);
  }
  if (values) {
    for (value in values) {
      url += "&" + encodeURIComponent(value) + "=" + encodeURIComponent(values[value]);
    }
  }
  if ("189453932" !== "%ea" + "id!") {
    url += "&dfp=189453932;56494666172";
  }
  url += "&adunit=" + encodeURIComponent(dfp_adunit);

  track_pixel(url);
}

function track_pixel(url) {
  document.createElement("img").src = url.replace(/__page-url__/, encodeURIComponent(origin))
                                         .replace(/__domain__/, encodeURIComponent(domain))
                                         .replace(/__dfpcid__/, encodeURIComponent('56494666172'.replace(/^[%]ecid!$/, '')))
                                         .replace(/__dfpadunit__/, encodeURIComponent(dfp_adunit))
                                         .replace(/__player-width__/, encodeURIComponent(container_clientWidth()))
                                         .replace(/__player-height__/, encodeURIComponent(container_clientHeight()))
                                         .replace(/__random-number__/, encodeURIComponent(Math.random()));
}

function debug_report(message) {
  if (debug) console.log("[" + (timestamp()/1000) + "] " + message);
  if (debug && debug_stacktrace) {
    try {
      i.dont.exist+=0; //doesn't exist- that's the point
    } catch(e) {
      if (e.stack) {
        var callstack = [];
        var lines = e.stack.split('\n');
        for (var i=0,len=lines.length;i<len;i++) {
          var matches = lines[i].match(/^(.*?)@(.*):(\d+:\d+)$/);
          if (matches) callstack.push({method: matches[1], file: matches[2], location: matches[3]});
        }
        callstack.shift();
        console.log(callstack);
      }
    }
  }
}

function script_load(src, targetWindow) {
  if (!targetWindow) targetWindow = window;
  var new_script = targetWindow.document.createElement('script');
  new_script.src = src;
  new_script.type = 'text/javascript';
  new_script.async = true;
  targetWindow.document.body.appendChild(new_script);
}

function cookie_get(n){
  var m;
  return (
    m = (new RegExp("(?:^|\\;)\\s*" + n.replace(/(\W)/g,"\\$1") + "\\s*\\=\\s*([^\\;]+)")).exec(document.cookie)
  ) ? m[1] : null;
}

function cookie_set(n, v, d) {
  var expires = "";
  if (d) {
    var date = new Date();
    date.setTime(date.getTime()+(d*24*60*60*1000));
    expires = "; expires="+date.toGMTString();
  }
  document.cookie = n+"="+v+expires+"; path=/";
}

function jwp_forceunload() {
  while (unloaders && unloaders.length) {
    try {
      var one = unloaders.splice(0, 1);
      one[0].call(window, {});
    } catch(e) {console.log(e)}
  }
}

function listener_attach(element, event, method) {
  if (element === window && event === "unload") {
    unloaders.push(method);
  }
  if (element.addEventListener) {
    // For all major browsers, except IE 8 and earlier
    element.addEventListener(event, method);
  } else if (document.attachEvent) {
    // For IE 8 and earlier versions
    element.attachEvent("on" + event, method);
  }
}

function listener_remove(element, event, method) {
  if (element === window && event === "unload" && unloaders) {
    for (var i=unloaders.length-1;i>=0;i--) {
      if (unloaders[i] === method) unloaders.splice(i,1);
    }
  }
  if (element.removeEventListener) {
    // For all major browsers, except IE 8 and earlier
    element.removeEventListener(event, method);
  } else if (document.attachEvent) {
    // For IE 8 and earlier versions
    element.detachEvent("on" + event, method);
  }
}

function mod(a,b){ return ((a%b)+b)%b; }
function timestamp() { return (new Date()).getTime(); }

function container_clientWidth() { return (document.getElementById("playerContainer").clientWidth); }
function container_clientHeight() { return (document.getElementById("playerContainer").clientHeight); }

function window_innerWidth(w) { return (w.innerWidth || w.document.documentElement.clientWidth); }
function window_innerHeight(w) { return (w.innerHeight || w.document.documentElement.clientHeight); }

function version_compare(a, b) {
  if (typeof a === "string") a = a.match(/\d+/g);
  if (typeof b === "string") b = b.match(/\d+/g);
  if (!(a.length > 0 && b.length > 0)) return undefined;
  var n_a = parseInt(a.shift(), 10), n_b = parseInt(b.shift(), 10);
  if (n_a !== n_b) return n_a < n_b ? -1 : 1;
  if (a.length > 0 && b.length > 0) return version_compare(a,b);
  if (a.length == 0 && b.length == 0) return 0;
  return a.length == 0 ? -1 : 1;
}

function object_mergedeeply(dest, from) {
  for (var x in from) {
    if (!from.hasOwnProperty(x)) continue;
    if (x in dest && typeof dest[x] === "object" && typeof from[x] === "object") {
      object_mergedeeply(dest[x], from[x]);
    } else {
      dest[x] = from[x];
    }
  }
}

function dcc_install_replacement_handler() {
  var rotations_until_move = null;
  var dcc_type = null;
  var dcc = null;
  var slides = null;
  var slideshow = null;
  var num_slides = 0;
  var viewed_slides = 1;
  var dcc_replace = null;
  var position_handler = null;
  var position_check_interval = null;
  var handlers_installed = false;
  var should_handle = false;
  var zindex = 799;
  var slideshow_methods = {};

  try {
    if (!window.parent || window.parent === window.self || !window.parent.$) return;
  } catch (e) {
    return;
  }

  var $ = window.parent.$;

  dcc_rotation_handler = function () {
    if (dcc_mode) return;
    // replace DCC at 1 rotation minimum, or after 20 slides
    if (++viewed_slides > Math.min(Math.max(num_slides, 20), num_slides * rotations_until_move)) {
      viewed_slides = 1;
      if (!handlers_installed) {
        $(window.parent).resize(position_handler);
        $(window.parent).scroll(position_handler);
        if (position_check_interval === null) position_check_interval = window.parent.setInterval(position_handler, 1000);
      }
      should_handle = true;
      dcc_replace();
    }
  };

  // GEN4 v3 DCC
  if ((($('section.dcc.slick-slider').length && $('section.dcc.slick-slider').slick) ||
       ($('section.stream-carousel.slick-slider').length && $('section.stream-carousel.slick-slider').slick))
      && window.parent.Syn
      && window.parent.Syn.ComponentMgr
      && window.parent.Syn.ComponentMgr.getInstancesByClass
      && (window.parent.Syn.ComponentMgr.getInstancesByClass("Syn.Dcc").length ||
          window.parent.Syn.ComponentMgr.getInstancesByClass("Syn.StreamCarousel").length)) {
    dcc_type = 'gen4-Slick';
    rotations_until_move = cfg.dcc_rotations_gen4;
    dcc = $('section.dcc.slick-slider').length
        ? $('section.dcc.slick-slider')
        : $('section.stream-carousel.slick-slider');
    var dcc_instance = (window.parent.Syn.ComponentMgr.getInstancesByClass("Syn.Dcc").length
                      ? window.parent.Syn.ComponentMgr.getInstancesByClass("Syn.Dcc")
                      : window.parent.Syn.ComponentMgr.getInstancesByClass("Syn.StreamCarousel"))[0];
    var dcc_tabs = $('section.dcc-tabs.slick-slider');
    num_slides = dcc.find('.dcc-slide').length - dcc.find('.dcc-slide.slick-cloned').length;
    var old_height = dcc.outerHeight(); // This DCC has a fixed height
    slideshow_methods = {
      pause: function () {
        dcc_instance.pause();
        dcc.find('button.slick-arrow').hide();
        dcc.find('.counter').hide();
        if (dcc_tabs.length) dcc_tabs.hide();
      },
      play: function () {
        dcc.outerHeight(old_height);
        dcc.find('button.slick-arrow').show();
        dcc.find('.counter').show();
        dcc_instance.unpause();
        if (dcc_tabs.length) dcc_tabs.show();
      },
      add: function () {
        dcc.on('afterChange', dcc_rotation_handler);
      },
      remove: function () {
        dcc.off('afterChange', dcc_rotation_handler);
      }
    };
    zindex = 0;

  // GEN4 v2 DCC
  } else if ($('section.dcc.flickity-enabled').length
             && $('section.dcc.flickity-enabled').data('flickity')
             && window.parent.Syn
             && window.parent.Syn.ComponentMgr
             && window.parent.Syn.ComponentMgr.getInstancesByClass
             && window.parent.Syn.ComponentMgr.getInstancesByClass("Syn.Dcc").length) {
    dcc_type = 'gen4-Flickity';
    rotations_until_move = cfg.dcc_rotations_gen4;
    dcc = $('section.dcc.flickity-enabled');
    var dcc_instance =  window.parent.Syn.ComponentMgr.getInstancesByClass("Syn.Dcc")[0];
    var dcc_tabs = $('section.dcc-tabs.flickity-enabled');
    num_slides = dcc.find('.dcc-slide').length;
    var old_height = dcc.outerHeight(); // This DCC has a fixed height
    slideshow_methods = {
      pause: function () {
        dcc_instance.pause();
        dcc.find('button').hide();
        dcc.find('.counter').hide();
        if (dcc_tabs.length) dcc_tabs.hide();
      },
      play: function () {
        dcc.outerHeight(old_height);
        dcc.find('button').show();
        dcc.find('.counter').show();
        dcc_instance.unpause();
        if (dcc_tabs.length) dcc_tabs.show();
      },
      add: function () {
        dcc.data('flickity').on('cellSelect', dcc_rotation_handler);
      },
      remove: function () {
        dcc.data('flickity').off('cellSelect', dcc_rotation_handler);
      }
    };
    zindex = 999;

  // GEN4 v1 DCC
  } else if ($('section.dcc.carousel.slide').length) {
    dcc_type = 'gen4-Bootstrap';
    rotations_until_move = cfg.dcc_rotations_gen4;
    dcc = $('section.dcc.carousel.slide');
    num_slides = $('section.dcc.carousel.slide .item').length;
    slideshow_methods = {
      pause: function () {
        window.setTimeout(function () { dcc.carousel("pause"); }, 1); // pause cannot be called from same thread as the 'slide.bs.carousel' handler or it gets ignored.
        dcc.find('.carousel-control').hide();
      },
      play: function () {
        dcc.find('.carousel-control').show();
        dcc.carousel("cycle");
      },
      add: function () {
        dcc.on('slide.bs.carousel', dcc_rotation_handler);
      },
      remove: function () {
        dcc.off('slide.bs.carousel', dcc_rotation_handler);
      }
    };
    zindex = 999;

  // GEN2 DCC
  } else if ($('div.dcc.slideshow').length
             && window.parent.Syn
             && window.parent.Syn.ComponentMgr
             && window.parent.Syn.ComponentMgr.getInstanceByUid) {
    dcc_type = 'gen2-Syn.FwSlideshow';
    rotations_until_move = cfg.dcc_rotations_gen2;
    dcc = $('div.dcc.slideshow');
    var dcc_instance = window.parent.Syn.ComponentMgr.getInstanceByUid(dcc.attr('id'));
    num_slides = dcc_instance.num_slides;
    var old_method = dcc_instance.setActiveSlide;
    var old_height = dcc.height(); // This DCC has a fixed height
    var old_margin = {
      'top': dcc.css('margin-top'),
      'bottom': dcc.css('margin-bottom')
    };
    var old_border = {
      'top': dcc.css('border-bottom-top'),
      'bottom': dcc.css('border-bottom-width')
    };
    var rotation_handler_sub = function (activeSlide) {
      dcc_rotation_handler();
      return $.proxy(old_method, this)(activeSlide);
    };
    slideshow_methods = {
      pause: function () {
        dcc_instance.pause.apply(dcc_instance);
        dcc.css('margin-top', '0');
        dcc.css('margin-bottom', '0');
        dcc.css('border-top-width', '0');
        dcc.css('border-bottom-width', '0');
      },
      play: function () {
        dcc.height(old_height);
        dcc.css('margin-top', old_margin.top);
        dcc.css('margin-bottom', old_margin.bottom);
        dcc.css('border-top-width', old_border.top);
        dcc.css('border-bottom-width', old_border.bottom);
        dcc_instance.play.apply(dcc_instance);
      },
      add: function () {
        dcc_instance.setActiveSlide = rotation_handler_sub;
      },
      remove: function () {
        if (dcc_instance.setActiveSlide === rotation_handler_sub) {
          dcc_instance.setActiveSlide = old_method;
        } else {
          rotation_handler_sub = function () {
            return $.proxy(old_method, this)(activeSlide);
          };
        }
      }
    };
    var node = $('#div-gpt-ad-home_mtf');
    while (node.length) {
      if (node.css("overflow") !== "visible") node.css("overflow", "visible");
      try {
        if (node.attr("id").match(/^body_col_\d+$/)) break;
      } catch (e) {
        // Do nothing. This failed because the element didn't have an "id" attr.
      }
      node = node.parent();
    }
    zindex = 1;
  }
  if (slideshow_methods.add) slideshow_methods.add();
  if (cfg.dcc_immediate_inc && !is_inc0) rotations_until_move = 0;

  if (rotations_until_move === null || rotations_until_move < 0) return;

  var mtf = $('#div-gpt-ad-home_mtf');
  var iframe_selector = $('#div-gpt-ad-home_mtf iframe');
  var orig_mtf_width  = mtf.width(),
      orig_mtf_height = mtf.height(),
      orig_iframe_width  = iframe_selector.width(),
      orig_iframe_height = iframe_selector.height();

  var position_handler = function () {
    var dcc_pos = dcc.offset(),
        mtf_pos = mtf.offset();
    var dcc_top    = Math.round(dcc_pos.top),
        dcc_left   = Math.round(dcc_pos.left),
        dcc_width  = Math.round(dcc.outerWidth()),
        dcc_height = Math.round(dcc_type === 'gen2-Syn.FwSlideshow' ? dcc.height() : dcc.outerHeight());
    var mtf_top    = Math.round(mtf_pos.top),
        mtf_left   = Math.round(mtf_pos.left),
        mtf_width  = Math.round(mtf.outerWidth()),
        mtf_height = Math.round(mtf.outerHeight());
    var aspect_height = dcc_type !== 'gen4-Bootstrap' ? Math.round(dcc_width * 9 / 16) : dcc_height;

    if (should_handle && (mtf_top   !== dcc_top   || mtf_left   !== dcc_left ||
                          mtf_width !== dcc_width || mtf_height !== aspect_height ||
                          dcc_height !== aspect_height)) {
      dcc_type === 'gen2-Syn.FwSlideshow' ? dcc.height(aspect_height) : dcc.outerHeight(aspect_height);
      mtf.width(dcc_width);
      mtf.height(aspect_height);
      iframe_selector.width(dcc_width);
      iframe_selector.height(aspect_height);
      mtf.offset({top: dcc_top, left: dcc_left});
      jwp_resize();
    }
  };

  var dcc_remove = function () {
    if (!dcc_mode) return;
    dcc_mode = false;
    if (!cfg.dcc_again_after_close) {
      if (slideshow_methods.remove) slideshow_methods.remove();
    }
    $('#div-gpt-ad-home_mtf-close').remove();
    mtf.css('position', 'static');
    mtf.width(orig_mtf_width);
    mtf.height(orig_mtf_height);
    iframe_selector.width(orig_iframe_width);
    iframe_selector.height(orig_iframe_height);
    mtf.css('zIndex', 'auto');
    mtf.parent().height('auto');
    last_top = last_left = last_width = last_height = null;
    should_handle = false;
    if ($(window.parent).off) {
      handlers_installed = false;
      $(window.parent).off('resize', position_handler);
      $(window.parent).off('scroll', position_handler);
    }
    if (position_check_interval !== null) window.parent.clearInterval(position_check_interval);
    position_check_interval = null;
    jwp_resize();
    slideshow_methods.play();
  }

  var closure_cleanup = function closure_cleanup() {
    dcc_remove();
    listener_remove(window, "unload", closure_cleanup);
    closure_cleanup = dcc_remove = rotations_until_move = dcc_type = dcc = slides = slideshow = num_slides =
    viewed_slides = dcc_replace = position_handler = position_check_interval = handlers_installed = should_handle = slideshow_methods = null;
  }
  listener_attach(window, "unload", closure_cleanup);

  dcc_replace = function () {
    if (!should_handle) return;
    dcc_mode = true;

    slideshow_methods.pause();

    position_handler();
    mtf.css('zIndex', zindex);
    mtf.parent().height(0);

    var btn = document.createElement('a');
    btn.style.position = 'absolute';
    btn.style.fontSize = '1.5em';
    btn.style.top = "0";
    btn.style.right = "0";
    btn.style.margin = '0';
    btn.style.width = '1.6em';
    btn.style.background = 'white';
    btn.style.color = '#666';
    btn.style.fontFamily = 'sans-serif';
    btn.style.cursor = 'pointer';
    btn.style.padding = '2px';
    btn.style.textAlign = 'center';
    btn.style.opacity = 0.7;
    btn.style.textDecoration = "none";
    btn.onclick = function() {
      dcc_remove();
      track_always("dccclose");
    };
    btn.onmouseover = function () {
      btn.style.background = 'gray';
    };
    btn.onmouseout = function () {
      btn.style.background = 'white';
    };
    var close_widget = null;
    if (dcc_type.match(/^gen4-/)) {
      close_widget = document.createElement("span");
      close_widget.className = "ss-icon ss-delete";
    } else {
      close_widget = document.createTextNode('x');
    }
    btn.appendChild(close_widget);
    btn.id = 'div-gpt-ad-home_mtf-close';
    $('#div-gpt-ad-home_mtf').append(btn);
    track_throttled("dcc");

    if (cfg.autoplay_mode === 'inviewport' && !has_started) {
      content_player.jwp("play", [true]);
    }
  };
}

function eventlistener_override(subject_window, subject) {
  var old_add = subject.prototype.addEventListener;
  if (!old_add) return;
  var disable = false; // In case someone else overrides addEventListener after we do such that we cannot re-install the old handler.
  var new_add = function() {
    var args = Array.prototype.slice.call(arguments);
    var res = old_add.apply(this, args);
    if (disable) return res;
    if (!args[0].match(/unload$/i) && typeof args[1] === "function" && args[1].constructor !== subject_window.Function) {
      debug_report("AddEventListener: " + args[0]);
      var that = this;
      var cleanup_method = function() {
        try {
          if (args[1].constructor === this.Function) {
            var actual_window = this;
            var closure_cleanup = function closure_cleanup() {
              debug_report("removing eventListener: " + args[0]);
              listener_remove(that, args[0], args[1]);
              listener_remove(actual_window, "unload", closure_cleanup);
              closure_cleanup = actual_window = that = args = res = null;
            };
            listener_attach(this, "unload", closure_cleanup);
            return true;
          }
        } catch(e) {}
      };
      if (iterate_childframes(subject_window, cleanup_method)) return;
      iterate_selfandparents(subject_window, cleanup_method);
    }
    return res;
  };
  subject.prototype.addEventListener = new_add;
  var subject_inscope = subject;
  var cleanup = function cleanup() {
    debug_report("removing overridden addEventListener handler");
    disable = true;
    if (subject_inscope.prototype.addEventListener === new_add) {
      debug_report("removing overridden addEventListener handler: success");
      subject_inscope.prototype.addEventListener = old_add;
    }
    listener_remove(window, "unload", cleanup);
    cleanup = subject_window = subject = new_add = old_add = subject_inscope = null;
  }
  listener_attach(window, "unload", cleanup);
}

function timeouts_override(subject_window, method) {
  if (subject_window['synap_timeouts_' + method]) return;
  subject_window['synap_timeouts_' + method] = true;
  var old_set = subject_window["set" + method];
  if (!old_set) return;
  var disable = false; // In case someone else overrides our method after we do such that we cannot re-install the old handler.
  var new_set = function() {
    var args = Array.prototype.slice.call(arguments);
    var res = old_set.apply(subject_window, args);
    if (disable) return res;
    if ((typeof args[0] === "function" && args[0].constructor !== subject_window.Function)
      || (typeof args[0] === "string" && args[0].constructor.constructor !== subject_window.Function)
      || subject_window.synap_adframe_timeouts) {
      debug_report("set" + method + " #" + res);
      var that = this;
      var cleanup_method = function() {
        try {
          if ((typeof args[0] === "function" && args[0].constructor === this.Function)
            || (typeof args[0] === "string" && args[0].constructor.constructor === this.Function)) {
            if (this.synap_adframe_timeouts) {
              if (!this.synap_adframe_timeouts[method]) this.synap_adframe_timeouts[method] = {};
              this.synap_adframe_timeouts[method][res] = subject_window;
            } else {
              var actual_window = this;
              var closure_cleanup = function closure_cleanup() {
                debug_report("removing " + method + " #" + res);
                subject_window["clear" + method].call(subject_window, res);
                listener_remove(actual_window, "unload", closure_cleanup);
                closure_cleanup = actual_window = that = args = res = null;
              };
              listener_attach(actual_window, "unload", closure_cleanup);
            }
            return true;
          }
        } catch(e) {}
      };
      if (subject_window.synap_adframe_timeouts) {
        // it's our frame
        cleanup_method.call(subject_window);
      } else {
        // gotta find the frame
        if (iterate_childframes(subject_window, cleanup_method)) return;
        iterate_selfandparents(subject_window, cleanup_method);
      }
    }
    return res;
  };
  subject_window["set" + method] = new_set;
  var saved_autoplay_window = window;
  var unload_handler = function unload_handler() {
    if (disable) return; // somehow this still gets called.
    debug_report("removing overridden set" + method + " handler");
    disable = true;
    if (subject_window["set" + method] === new_set) {
      debug_report("removing overridden set" + method + " handler: success");
      delete subject_window['synap_timeouts_' + method];
      subject_window["set" + method] = old_set;
    }
    listener_remove(saved_autoplay_window, "unload", unload_handler);
    if (subject_window !== saved_autoplay_window) listener_remove(subject_window, "unload", unload_handler);
    unload_handler = subject_window = method = new_set = old_set = saved_autoplay_window = null;
  }
  listener_attach(saved_autoplay_window, "unload", unload_handler);
  if (subject_window !== saved_autoplay_window) listener_attach(subject_window, "unload", unload_handler);
}

function references_clean(subject, source_window) {
  debug_report("references_clean");
  for (var k in subject) {
    try {
      if (subject[k].constructor === source_window.Function || subject[k].constructor.constructor === source_window.Function) {
        debug_report("cleaning reference: " + k);
        subject[k] = null;
      }
    } catch(e) {}
  }
}

function iterate_childframes(current_window, method) {
  try {
    if (current_window && current_window.frames && current_window.frames.length > 0) {
      for (var i=0;i<current_window.frames.length;i++) {
        if (method.call(current_window.frames[i])) return;
        iterate_childframes(current_window.frames[i], method);
      }
    }
  } catch(e) {}
}

function iterate_selfandparents(current, method) {
  do {
    try {
      if (current) {
        if (method.call(current)) return true;
      }
    } catch(e) {}
  } while (current && current.parent && current !== current.parent && (current = current.parent));
}

function iterate_selfandparentnodes(current, method) {
  do {
    try {
      if (current) {
        if (method.call(current)) return true;
      }
    } catch(e) {}
  } while (current && current.parentNode && current !== current.parentNode && (current = current.parentNode));
}

function adtag_updateurls(tags) {
  for (var i=0;i<tags.length;i++) {
    if (typeof tags[i].url === "object") {
      for (var size_class in tags[i].url) {
        tags[i]['url'][size_class] = adtag_replace(tags[i]['url'][size_class]);
      }
    } else {
      tags[i].url = adtag_replace(tags[i].url);
    }
  }
}

function adtag_replace(tag) {
  // Our logic for determining page URL is superior to JWPlayer's "__page-url__"
  // replacement, in that ours works through SafeFrames.
  return tag.replace(/__page-url__/, encodeURIComponent(origin))
            .replace(/__domain__/, encodeURIComponent(domain))
            .replace(/__dfpcid__/, encodeURIComponent('56494666172'.replace(/^[%]ecid!$/, '')))
            .replace(/__dfpadunit__/, encodeURIComponent(dfp_adunit))
            .replace(/__player-width__/, "__item-playerwidth__")
            .replace(/__player-height__/, "__item-playerheight__");
}

function protocol_get() {
  try {
    if (window.location.protocol.match(/^https?:$/)) return window.location.protocol;
  } catch (e) {}
  return origin.match(/^https:/) ? "https:" : "http:";
}

function iframe_findfromwindow(current_window) {
  if (current_window.parent === current_window) return null;
  try {
    var frames = current_window.parent.document.getElementsByTagName("iframe");
    for (var i=0;i<frames.length;i++) {
      if (frames[i].contentWindow === current_window) return frames[i];
    }
  } catch (e) {}
  return null;
}

function fractionalposition_fix() {
  try {
    if (browser_type.chrome) {
      // Chrome needs object to be aligned on whole-numbered pixels. Also can't be located at 0,0 on page.
      var position = jwp_getcoordinates();
      var container = document.getElementById("playerContainer");
      container.style.marginTop = (Math.floor(position.t) !== position.t ? 1 - (position.t - Math.floor(position.t)) : (position.t == 0 ? 1 : 0)) + "px";
      container.style.marginLeft = (Math.floor(position.l) !== position.l ? 1 - (position.l - Math.floor(position.l)) : 0) + "px";
    }
  } catch (e) {}
}

function framestate_fix() {
  try {
    // Ensure we're in a real friendly frame
    if (browser_type.chrome && window.location.protocol !== "http:" && window.location.protocol !== "https:") {
      track_throttled("badframe", {"url": window.location.href});
      var cur_window = window;
      var container;
      while (cur_window.location.protocol !== "http:" && cur_window.location.protocol !== "https:") {
        container = iframe_findfromwindow(cur_window);
        if (container === null) return false;
        cur_window = cur_window.parent;
      }
      if (container !== null && container.width && container.height && (!container.className || container.className !== "apReplacementFrame")) {
        var content = window.document.documentElement.outerHTML;
        cur_window.setTimeout(function () {
          var new_frame = window.document.createElement("iframe");
          new_frame.width = container.width;
          new_frame.height = container.height;
          new_frame.className = "apReplacementFrame"; // prevents recursion
          container.parentNode.insertBefore(new_frame, container);
          new_frame.contentWindow.document.open();
          new_frame.contentWindow.document.write(content);
          new_frame.contentWindow.document.close();
          container.parentNode.removeChild(container);
        }, 1);
        return true;
      } else if (container !== null && container.className && container.className === "apReplacementFrame") {
        track_throttled("unfixedframe", {"url": window.location.href});
      }
    }
  } catch (e) {}
  return false;
}

function adunit_refresh_remove() {
  var current_window = window.parent;
  do {
    var iframe = iframe_findfromwindow(current_window);
    if (iframe === null) return;
    iterate_selfandparentnodes(iframe, function() {
      if (this.id && (this.id.match(/^google_ads_iframe_\//) || this.id.match(/^div-gpt-ad-/))) this.id = "_" + this.id;
      if (this.name && this.name.match(/^google_ads_iframe_\//)) this.name = "_" + this.name;
    });
    if (current_window === window.top) {
      current_window = null;
    } else {
      current_window = current_window.parent;
    }
  } while (current_window !== null);
  return;
}

function node_hasparent(node, parent) {
  if (node === null) return false;
  if (node === parent) return true;
  return node_hasparent(node.parentNode, parent);
}

function gptcompanion_remove(target_window, target_node) {
  if (!target_window.googletag
    || !target_window.googletag.companionAds
    || "function" !== typeof target_window.googletag.companionAds
    || !target_window.googletag.companionAds().ca
    || !target_window.googletag.companionAds().ca.length) return;
  var companions = target_window.googletag.companionAds().ca;
  for (var i=companions.length-1;i>=0;i--) {
    if (companions[i] && companions[i].l && companions[i].l.m) {
      if (node_hasparent(target_node, target_window.document.getElementById(companions[i].l.m))) {
        target_window.googletag.companionAds().ca.splice(i,1);
        debug_report("gptcompanion_remove: removed " + companions[i].l.m);
      }
    }
  }
}

function backgroundad_show() {
  if (is_in_crossdomain_frame) return;
  if (backgroundad_shown) return;
  backgroundad_shown = true;
  var adx_tags = [];
  // Various re-publish-required tag fixes
  var tags = [cfg.ad_tags];
  for (var j=0;j<tags.length;j++) {
    for (var i=tags[j].length - 1;i>=0;i--) {
      if (tags[j][i].id.match(/^google_adex_/)) {
        adx_tags.push(tags[j][i]);
      }
    }
  }
  if (!adx_tags.length > 0) return;
  adx_tags.sort(function (a,b) { return a.id.match(/_backfill$/) ? 1 : b.id.match(/_backfill$/) ? -1 : 0; });
  var cur_window = window;
  var frame = null;
  while (cur_window !== window.top) {
    frame = iframe_findfromwindow(cur_window);
    cur_window = cur_window.parent;
  }
  if (!frame) return;
  var frame_pos = frame.getBoundingClientRect();
  var marker_pos = null;
  var marker = frame;
  do {
    marker_pos = marker.parentNode.getBoundingClientRect();
  } while (frame_pos.top == marker_pos.top && frame_pos.left == marker_pos.left && (marker = marker.parentNode));

  // remove our place from the GPT companion ads slots so IMA doesn't refresh us after out own googima ad attempts.
  gptcompanion_remove(window.top, frame);

  var display_player = function() {
    var container = window.top.document.createElement("div");
    container.id = "synap_c_" + instance_id;
    container.style.position = "absolute";
    container.style.top = marker.offsetTop + "px";
    container.style.left = marker.offsetLeft + "px";
    container.style.height = frame.clientHeight + "px";
    container.style.width = frame.clientWidth + "px";
    var sub_container = window.top.document.createElement("div");
    sub_container.id = "synap_sc_" + instance_id;
    container.appendChild(sub_container);
    marker.parentNode.insertBefore(container, marker);

    var player = window.top.jwplayer(sub_container.id);
    var schedule = {
      pre: {
        offset: "pre",
        tag: (adx_tags[0].url.default.match(/^\/\//) ? protocol_get() : "") + adx_tags[0].url.default
      }
    };
    if (adx_tags[1]) {
      schedule["post"] = {
        offset: "post",
        tag: (adx_tags[1].url.default.match(/^\/\//) ? protocol_get() : "") + adx_tags[1].url.default
      };
    }

    player.setup({
      file: protocol_get() + "//synacor.autoplay-plugins.static-origin.syn-cdn.com/loading.m4v",
      type: "mp4",
      autostart: true,
      mute: true,
      primary: 'html',
      controls: true,
      repeat: false,
      displaytitle: false,
      androidhls: true,
      dash: true,
      width: frame.clientWidth,
      height: frame.clientHeight,
      advertising: {
        client: 'googima',
        schedule: schedule
      }
    });
    var pre_post_marker = "pre";
    var track_time = null;
    player.on('beforePlay', function() {
      pre_post_marker = "pre";
      track_time = timestamp();
      track_throttled("adslot", {"embed": 1 });
    });
    player.on('complete', function() {
      pre_post_marker = "post";
      window.setTimeout(function () {
        if (player) {
          player.play(true);
        }
      }, Math.max(min_adslot_time_secs * 1000 - (track_time - timestamp()), 0));
    });
    player.on('mute', function() {
      player.setMute(true);
    });
    player.on('adImpression', function(e) {
      track_throttled("impression", {"adtag_id": pre_post_marker == "pre" ? adx_tags[0].id : adx_tags[1].id, "embed": 1 });
    });
    player.on('adComplete', function(e) {
      track_throttled("complete", {"adtag_id": pre_post_marker == "pre" ? adx_tags[0].id : adx_tags[1].id, "embed": 1 });
    });
    player.on('adRequest', function(e) {
      track_throttled("attempt", {"adtag_id": pre_post_marker == "pre" ? adx_tags[0].id : adx_tags[1].id, "embed": 1 });
    });
    player.on('adError', function(e) {
      track_throttled("aderror", {"adtag_id": pre_post_marker == "pre" ? adx_tags[0].id : adx_tags[1].id, "embed": 1 });
    });
    player.on('adPlay', function(e) {
      track_throttled("adplay", {"adtag_id": pre_post_marker == "pre" ? adx_tags[0].id : adx_tags[1].id, "embed": 1 });
    });
    var unload_method = function(e){
      if (e && e.type && e.type.toLowerCase() == "visibilitychange" && document.visibilityState == "hidden") return;
      if (player && player.remove) {
        player.remove();
        player = null
      }
      container.parentNode.removeChild(container);
      backgroundad_shown = false;
      track_throttled("backgroundremove");
      listener_remove(window, "unload", unload_method);
      listener_remove(document, "visibilitychange", unload_method);
    };
    listener_attach(window, "unload", unload_method);
    listener_attach(document, "visibilitychange", unload_method);
    track_throttled("backgroundplayer");
  };
  if (!window.top.jwplayer) {
    var version = "7.8.7";
    var script_node = window.top.document.createElement("script");
    script_node.type = "text/javascript";
    script_node.src = jwp_location(version);
    listener_attach(script_node, "load", function(){window.top.jwplayer.key = version_compare(version, "7.0.0") < 0 ? "gTJ/ZYo7V/nNHrmCH2NpVMUsU2PSuQyiqn7Q9w==" : "dzQFPU7qBWptn2Rqf+VO9Vtf5EKYV8Klu/5GZw==";display_player();});
    window.top.document.head.appendChild(script_node);
  } else {
    display_player();
  }
}

function portalcolumn_resizeinstall() {
  if (is_in_crossdomain_frame
    || !window.parent.Syn
    || !window.parent.Syn.ComponentMgr
    || !window.parent.Syn.ComponentMgr.getInstancesByClass) return;

  var units = window.parent.Syn.ComponentMgr.getInstancesByClass("Syn.Ad_Component_Gpt_Unit");
  if (!units) return;
  var frame = iframe_findfromwindow(window);
  if (!frame) return;
  var unit = null;
  for (var i=0;i<units.length;i++) {
    iterate_selfandparentnodes(frame, function() {
      if (this === units[i].el) {
        unit = units[i];
        return true;
      }
    });
    if (unit) break;
  }
  if (!unit) return;

  var sizes = unit.config.tag_configuration.slot;
  // no need to do anything if there is only one slot size
  if (!sizes || !sizes.length || sizes.length < 2) return;
  // order by size
  sizes.sort(function (a,b) {return a[0] < b[0] ? -1 : a[0] > b[0] ? 1 : a[1] < b[1] ? -1 : a[1] > b[1] ? 1 : 0});

  var parent_width = unit.el.clientWidth;
  var resizer = function resizer() {
    if (dcc_mode || parent_width == unit.el.clientWidth) return;
    parent_width = unit.el.clientWidth;
    var target_width, target_height;
    for (var i=0;i<sizes.length;i++) {
      if (sizes[i][0] <= parent_width) {
        target_width = sizes[i][0];
        target_height = sizes[i][1];
      }
      else {
        break;
      }
    }
    frame.width = target_width;
    frame.height = target_height;
    frame.parentNode.parentNode.style.width = frame.style.width = frame.width + "px";
    frame.parentNode.parentNode.style.height = frame.style.height = frame.height + "px";
  };
  listener_attach(window.parent, "resize", resizer);
  var closure_cleanup = function closure_cleanup() {
    listener_remove(window.parent, "resize", resizer);
    listener_remove(window, "unload", closure_cleanup);
    closure_cleanup = resizer = units = frame = unit = sizes = null;
  }
  listener_attach(window, "unload", closure_cleanup);
}

function startup() {
  if (browser_type.ie || browser_type.edge) {
    cfg.background_ads = false;
    if (cfg.timed_ad_break_secs > 0) cfg.timed_ad_break_secs = Math.max(15, cfg.timed_ad_break_secs);
  }

  portalcolumn_resizeinstall();

  // Various re-publish-required tag fixes
  var tags = [cfg.ad_tags, cfg.large_ad_tags];
  for (var j=0;j<tags.length;j++) {
    for (var i=tags[j].length - 1;i>=0;i--) {
      if (tags[j][i].id.match(/^liverail/) || tags[j][i].id.match(/^rockyou_4$/)) {
        tags[j].splice(i,1);
      } else if (tags[j][i].id.match(/^rockyou_5$/)) {
        tags[j][i].id = "springserve_rockyou_flash";
        tags[j][i].url = {"default": "//vid.springserve.com/vast/43117?w=__player-width__&h=__player-height__&cb=__random-number__&mute=1&ap=1&vid=__item-id__&vt=__item-title__&kwds=__item-keywords__&zid=__dfpcid__&sid=__dfpadunit__&url=__page-url__&v_url=__item-srcurl__"};
      } else if (tags[j][i].id.match(/^adaptv(?:_|$)/) && tags[j][i].id !== "adaptv_connection") {
        var has_adaptv_connection = false;
        for (var k=tags[j].length - 1;k>=0;k--) {
          if (tags[j][k] && tags[j][k].id && tags[j][k].id === "adaptv_connection") {
            has_adaptv_connection = true;
            break;
          }
        }
        if (has_adaptv_connection) {
          tags[j].splice(i,1);
        } else {
          tags[j][i].id = "adaptv_connection";
          tags[j][i].url = {
            "default": "//ads.adaptv.advertising.com/a/h/KRnQuKabXOP3L4D82ESvAvWuaz_rlVee?cb=__random-number__&pageUrl=__page-url__&description=__item-description__&duration=__item-realduration__&id=__item-id__&keywords=__item-keywords__&title=__item-title__&url=__item-srcurl__&eov=eov&context=dfpcid%3D__dfpcid__,origin%3D__domain__,dfpadunit%3D__dfpadunit__",
            "large": "//ads.adaptv.advertising.com/a/h/WQSxosV_tvFdMwJES0C+QS1w3wr5T8o5?cb=__random-number__&pageUrl=__page-url__&description=__item-description__&duration=__item-realduration__&id=__item-id__&keywords=__item-keywords__&title=__item-title__&url=__item-srcurl__&eov=eov&context=dfpcid%3D__dfpcid__,origin%3D__domain__,dfpadunit%3D__dfpadunit__",
            "medium": "//ads.adaptv.advertising.com/a/h/upUdtOZYUANuxj6e0CE9wHgMWuW2IHr2?cb=__random-number__&pageUrl=__page-url__&description=__item-description__&duration=__item-realduration__&id=__item-id__&keywords=__item-keywords__&title=__item-title__&url=__item-srcurl__&eov=eov&context=dfpcid%3D__dfpcid__,origin%3D__domain__,dfpadunit%3D__dfpadunit__"
          };
        }
      } else if (tags[j][i].id.match(/^adx_/) && !tags[j][i].id.match(/^adx_(?:tds|toshiba)/)) {
        var is_backfill = tags[j][i].id.match(/_backfill$/);
        tags[j][i].id = "google_adex_syndication" + (is_backfill ? "_backfill" : "");
        tags[j][i].url = {"default": "//pubads.g.doubleclick.net/gampad/ads?sz=640x383&iu=/5284/syn.synacorsyndication/video_adex" + (is_backfill ? "_backfill" : "") + "&ciu_szs=300x250&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=__domain__&description_url=__page-url__&correlator=__timestamp__&cust_params=dfpcid%3D__dfpcid__%26dfpadunit%3D__dfpadunit__"};
      } else if (tags[j][i].id.match(/^google_adex_/)) {
        if (typeof tags[j][i].url === "string") {
          if (!tags[j][i].url.match(/cust_params/)) {
            tags[j][i].url += "&cust_params=dfpcid%3D__dfpcid__%26dfpadunit%3D__dfpadunit__";
          }
          tags[j][i].url.replace(/output=xml_vast2/, "output=xml_vast3");
        } else if (typeof tags[j][i].url === "object") {
          for (var type in tags[j][i].url) {
            if (!tags[j][i].url[type].match(/cust_params/)) {
              tags[j][i].url[type] += "&cust_params=dfpcid%3D__dfpcid__%26dfpadunit%3D__dfpadunit__";
            }
            tags[j][i].url[type].replace(/output=xml_vast2/, "output=xml_vast3");
          }
        }
      } else if (tags[j][i].id.match(/^spotxchange_/)) {
        if ("synacorsyndication" === "" || "177135" === "") {
          tags[j].splice(i,1); // remove spotx if template params exist, but are empty
          continue;
        }
        if (typeof tags[j][i].url === "string") {
          if (!tags[j][i].url.match(/content_id/)) {
            tags[j][i].url += "&content_id=__dfpcid__&custom[cid]=__domain__&custom[dfpadunit]=__dfpadunit__";
          }
        } else if (typeof tags[j][i].url === "object") {
          for (var type in tags[j][i].url) {
            if (!tags[j][i].url[type].match(/content_id/)) {
              tags[j][i].url[type] += "&content_id=__dfpcid__&custom[cid]=__domain__&custom[dfpadunit]=__dfpadunit__";
            }
          }
        }
      }
    }
  }
  // Various re-publish-required tag fixes (pass 2)
  var tags = [cfg.ad_tags, cfg.large_ad_tags];
  for (var j=0;j<tags.length;j++) {
    for (var i=tags[j].length - 1;i>=0;i--) {
      if (typeof tags[j][i].url === "string") {
        tags[j][i].url.replace(/dfpclient/, "dfpadunit");
      } else if (typeof tags[j][i].url === "object") {
        for (var type in tags[j][i].url) {
          tags[j][i].url[type].replace(/dfpclient/, "dfpadunit");
        }
      }
    }
  }

  // remove static ad if template params exist, but are empty
  if ("SynacorSyndication_RON" === "" || "/00/17/17/uat_61717" === "") cfg.static_ad_tag = null;

  if (framestate_fix()) return;

  fractionalposition_fix();

  if (cfg.anti_refresh) adunit_refresh_remove();

  jwp_viewable_if_idle();

  if (blank_image_url.match(thumbnailurl_strip_prefix) !== null) {
    blank_image_url = thumbnailurl_build[cfg.streamsource](blank_image_url.replace(thumbnailurl_strip_prefix, ""));
  }

  iterate_selfandparents(window, function() {
    if (this.Window      && this.Window.prototype.hasOwnProperty("addEventListener"))      eventlistener_override(this, this.Window);
    if (this.Element     && this.Element.prototype.hasOwnProperty("addEventListener"))     eventlistener_override(this, this.Element);
    if (this.Node        && this.Node.prototype.hasOwnProperty("addEventListener"))        eventlistener_override(this, this.Node);
    if (this.EventTarget && this.EventTarget.prototype.hasOwnProperty("addEventListener")) eventlistener_override(this, this.EventTarget);
    timeouts_override(this, "Timeout");
    timeouts_override(this, "Interval");
  });

  for (var i=0; i<cfg.prefix.length; i++) {
    if (cfg.prefix[i] === "a") {
      pread_num++;
    } else {
      tail_start++;
      pre_ads.push(pread_num);
      playlist_spec.push(cfg.prefix[i]);
      pread_num = 0;
    }
  }
  for (var i=0; i<cfg.tail.length; i++) {
    if (cfg.tail[i] === "a") {
      pread_num++;
    } else {
      pre_ads.push(pread_num);
      playlist_spec.push(cfg.tail[i]);
      pread_num = 0;
    }
  }
  if (pread_num) pre_ads.push(pread_num);

  adtag_updateurls(cfg.ad_tags);
  adtag_updateurls(cfg.large_ad_tags);

  for (var i=0;i<cfg.ad_tags.length;i++) {
    if (cfg.log_aceview && cfg.ad_tags[i].av) log_aceview = true;
  }
  for (var i=0;i<cfg.large_ad_tags.length;i++) {
    if (cfg.log_aceview && cfg.large_ad_tags[i].av) log_aceview = true;
  }

  if (cfg.fill_window) document.getElementById("playerContainer").style.height = window_innerHeight(window) + "px";
  loadingcover_show();
  staticad_show();

  var vam_callbacks = [];
  if (cfg.dynamiccontent && protocol_get() !== "https:") { // For now, dynamic content doesn't work on https
    for (var vamid in cfg.vamurls) {
      vam_jsonp_requests_pending++;
      var vam_jsonp_fn_name = "vam_jsonp_recv_"+vamid;
      vam_callbacks.push(vam_jsonp_fn_name);
      window[vam_jsonp_fn_name] = (function(vamid){ return function(data){ vam_jsonp_recv(vamid, data); }; })(vamid);
      var jsonp = document.createElement("script");
      jsonp.src = (cfg.vamurls[vamid].match(/^\/\//) ? protocol_get() : "") + cfg.vamurls[vamid] + (cfg.vamurls[vamid].match(/\?/) ? "&" : "?") + "callback="+vam_jsonp_fn_name;
      var head = document.getElementsByTagName("head")[0];
      head.appendChild(jsonp);
    }
    vam_jsonp_failsafe = setTimeout(function() {
      window.clearTimeout(vam_jsonp_failsafe);
      vam_jsonp_failsafe = null;
      jwp_init();
    }, vam_jsonp_requests_pending * 2000);
  }

  if (false && browser_type.chrome && !jwp_hasfocus()) {// temporarily disabled XXX
    if (focus_wait) return;
    focus_wait = true;
    track_throttled("focuswait", "startup");
    backgroundad_show();
    var focuswait_method;
    focuswait_method = function () {
      track_throttled("focusgain", "startup");
      listener_remove(document, "visibilitychange", focuswait_method);
      players_create();
    }
    listener_attach(document, "visibilitychange", focuswait_method);
    return;
  }

  players_create();
  var closure_cleanup = function () {
    listener_remove(window, "unload", closure_cleanup);
    listener_remove(window, "resize", jwp_resize);
    closure_cleanup = tags = null;
    while (retry_timeouts.length) {
      window.clearTimeout(retry_timeouts.pop());
    }
    if (ads_start_timeout !== null) {
      window.clearTimeout(ads_start_timeout);
      ads_start_timeout = null;
    }
    if (ads_start_retry_timeout !== null) {
      window.clearTimeout(ads_start_retry_timeout);
      ads_start_retry_timeout = null;
    }
    if (simultaneous_ad_loader_timeout !== null) {
      window.clearTimeout(simultaneous_ad_loader_timeout);
      simultaneous_ad_loader_timeout = null;
    }
    if (attempt_timeout !== null) {
      window.clearTimeout(attempt_timeout);
      attempt_timeout = null;
    }
    debug_report("unloading all players");
    content_player.tearDown();
    while (ad_players.length) {
      ad_players.pop().destroy();
    }
    track_throttled("unloadstate", {time_on_page_ms: timestamp() - load_time, state:state, state_duration_ms:Math.floor(timestamp() - state_time)});
    staticad_destroy();

    content_player.destroy();
    content_player = null;
    // break circular reference
    DisplayFrame.prototype.constructor = FramePlayer.prototype.constructor = ContentFramePlayer.prototype.constructor = AdFramePlayer.prototype.constructor = StaticAdFrame.prototype.constructor = null;
    DisplayFrame = FramePlayer = ContentFramePlayer = AdFramePlayer = StaticAdFrame = null;
    while (vam_callbacks.length) {
      window[vam_callbacks.pop()] = null;
    }
  }
  listener_attach(window, "unload", closure_cleanup);
  listener_attach(window, "resize", jwp_resize);
}
if (!blacklisted()) {
  listener_attach(window, "load", startup);
} else if (window.parent && window.parent.$) {
  try {
    window.parent.$('#div-gpt-ad-home_mtf').hide();
  } catch (e) {}
}
</script>



<script src="./osd_listener.js"></script><script type="text/javascript">osdlfm(-1,'','B1LPmHBK_WI-5K4j1-QPto7-IAQAAAAAQATgByAEJwAIC4AIA4AQBoAYf','',3095786269,true,'ud\x3d1\x26la\x3d0\x26',3,'CAASFeRormORGquo-20YVM3TsQYzMDum6A','//pagead2.googlesyndication.com/activeview?avi\x3dB1LPmHBK_WI-5K4j1-QPto7-IAQAAAAAQATgByAEJwAIC4AIA4AQBoAYf\x26cid\x3dCAASFeRormORGquo-20YVM3TsQYzMDum6A');</script><script>if (window.top && window.top.postMessage) {window.top.postMessage('{"googMsgType":"adpnt"}','*');}</script><div class="tyntShIh"></div></body></html>